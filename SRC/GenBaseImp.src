/* Copyright (c) 1985-2012, B-Core (UK) Ltd
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following
conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT 
NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE 
COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES 
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS 
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/
#define dashes_string "----------------------------------------\n"


THEORY GBIPrintX IS

#define GBIphfTac  \
          (((CATL;MAP;WRITE;ARI;FLAT;NEWV;MODR)~;GBIPrintX)~)

#define GBIPrintHeader bcall(GBIphfTac: ph_0)

#define GBIPrintFooter bcall(WRITE: bprintf("\n\nEND\n"))

#define GBIPrintToken_io bcall(GBIphfTac : ph_token )
  ?;?;?;?;

  ?;  /* 1=> \/ required for token_io */

  ?;  /* 1=> token_io printed */

  NAT,SCALAR,STRING,CHAR,BOOL,BITS,SCALAR;  /* token_io params printed */

  ph_bit;

  ph_str;

  ph_basicio;

  BITFlagset &
  bprintf(", Bit_TYPE")
 =>
  ph_bit;

  FSTRINGFlagset &
  bprintf(", String_TYPE")
 =>
  ph_str;

  STRINGFlagset &
  bprintf(", String_TYPE")
 =>
  ph_str;

  bprintf(", basic_io")
 =>
  ph_basicio;

  bprintf(", %_file_dump",a)
 =>
  ph_file_dump(a);



  ph_token_clo_bracket;           /* token_io not required */

  brule(GBIPrintX.6,1) &
  bprintf(")")
 =>
  ph_token_clo_bracket;


/*
  ph_token_io;                    /! already printed !/

  ReadSystemName(a) &
  brule(GBIPrintX.6,0) &
  bmodr(GBIPrintX.6,1) &
  bprintf(",\n\n  %_token_io(",a)
 =>
  ph_token_io;
*/


  bmodr(GBIPrintX.5,1)
 =>
  ph_token_union;

  brule(GBIPrintX.6,0) &
  bmodr(GBIPrintX.6,1) &
  ReadSystemName(a) &
  bprintf(",\n\n  %_token_io(",a) &
  bmodr(GBIPrintX.5,1)
 =>
  ph_token_union;

  brule(GBIPrintX.5,1) &
  bprintf("\/")
 =>
  ph_token_union;



  ph_token_params1(?);

  ReadSystemName(a) &
  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,setrobj)) &
  ph_token_union &
  bprintf("%_STROBJ",a)
 =>
  ph_token_params1(v|strobj(t));

  brule(GBIPrintX.7,T) &
  bsearch(strobj,T,U)                     /* already printed */
 =>
  ph_token_params1(v|strobj(t));

  ReadSystemName(a) &
  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,seqobj)) &
  ph_token_union &
  bprintf("%_SEQOBJ",a) &
  ph_token_params1(v|set(t))
 =>
  ph_token_params1(v|seqobj(t));

  brule(GBIPrintX.7,T) &
  bsearch(seqobj,T,U)  &                   /* already printed */
  ph_token_params1(v|set(t))
 =>
  ph_token_params1(v|seqobj(t));

  ReadSystemName(a) &
  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,setobj)) &
  ph_token_union &
  bprintf("%_SETOBJ",a) &
  ph_token_params1(v|set(t))
 =>
  ph_token_params1(v|setobj(t));

  brule(GBIPrintX.7,T) &
  bsearch(setobj,T,U)  &                   /* already printed */
  ph_token_params1(v|set(t))
 =>
  ph_token_params1(v|setobj(t));

  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,fncobj(t))) &
  ph_token_union &
  bprintf("%_FNCOBJ",t)
 =>
  ph_token_params1(v|fncobj(t));

  brule(GBIPrintX.7,T) &
  bsearch(fncobj(t),T,U)                     /* already printed */
 =>
  ph_token_params1(v|fncobj(t));

  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,SCALAR)) &
  ph_token_union &
  bprintf("%",SCALAR)
 =>
  ph_token_params1(v|fstrobj(t));

  brule(GBIPrintX.7,T) &
  bsearch(SCALAR,T,U)                     /* already printed */
 =>
  ph_token_params1(v|fstrobj(t));

/**** add ID Field type to token_io parameter ****/

  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,p)) &
  ph_token_union &
  bprintf("%",p)
 =>
  ph_base_ids_2(set(p));

  brule(GBIPrintX.7,T) &
  bsearch(p,T,U)                     /* already printed */
 =>
  ph_base_ids_2(set(p));

  ph_base_ids_2(strobj(a));

  ph_base_ids_2(nat(a));

  ph_base_ids_1(t)(v);

  brule(GBConstantsTypeStoX.N,t(S)) &
  bsearch((v|s),S,U) &
  ph_base_ids_2(s)
 =>
  ph_base_ids_1(t)(v);

  ph_base_ids_0(t);

  ReadIDs(K) &
  bsearch(t(v),K,L) &
  ph_base_ids_1(t)(v)
 =>
  ph_base_ids_0(t);

/**************************************************/

  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,t)) &
  ph_token_union &
  bprintf("%",t)  &      
  ph_base_ids_0(t)                  /* entry for base id types */
 =>
  ph_token_params1(v|set(t));

  brule(GBIPrintX.7,T) &
  bsearch(t,T,U)                     /* already printed */
 =>
  ph_token_params1(v|set(t));

  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,SCALAR)) &
  ph_token_union &
  bprintf("%",SCALAR)
 =>
  ph_token_params1(v|nat(t));

  brule(GBIPrintX.7,T) &
  bsearch(SCALAR,T,U)                     /* already printed */
 =>
  ph_token_params1(v|nat(t));

  brule(GBConstantsTypeStoX.N,b(x)) &
  ph_token_params1 bsmap x
 =>
  ph_token_params(b);


  brule(GBIPrintX.7,T) &
  bmodr(GBIPrintX.7,(T,b)) &
  ph_token_union &
  bprintf("%_ABSOBJ",b)
 =>
  ph_token_absobj(b);


  ph_token3(o);           /* print for globals not reqd */

  GBReadRequiredOps(O) &
  bsearch(o,O,P) &
/*
  ph_token_io &
*/
  ph_token_params(GLOBAL ? END)
 =>
  ph_token3(o);

  ReadSystemName(a) &
  ph_token3(bnewv(print_Globals_,a))
 =>
  ph_token1(?);

  ph_token2(b)(o);           /* print for base b not reqd */

  GBReadRequiredOps(O) &
  bsearch(o,O,P) &
/*
  ph_token_io &
*/
  ph_token_absobj(b) &
  ph_token_params(b)
 =>
  ph_token2(b)(o);

  ph_token2(b)(bnewv(print_BaseObj_,b)) &
  ph_token1(B)
 =>
  ph_token1(B,b);


  ph_token_union &
  bprintf("%",SCALAR)
 =>
  ph_check_SCALAR; /* it's never printed - hardwired into GBIPrintX.7 */


  ReadBaseNames(B) &
  bmodr(GBIPrintX.5,0) &
  bmodr(GBIPrintX.6,0) &
  ph_token1(B) &
  ph_check_SCALAR &
  ph_token_clo_bracket
 =>
  ph_token;



  bprintf("IMPLEMENTATION   %I\n\nREFINES          %\n\nSEES\n\n  %Ctx, Scalar_TYPE, Bool_TYPE, String_TYPE",a) &
  ph_bit &
  /* ph_str & */
  ph_basicio &
  ph_file_dump(a) &
  bprintf("\n\nIMPORTS\n\n")
 =>
  ph_2(a);

  CtxMchNotRequired &
  bprintf("IMPLEMENTATION   %I\n\nREFINES          %\n\nSEES\n\n  Scalar_TYPE, Bool_TYPE, String_TYPE",a) &
  ph_bit &
  /* ph_str & */
  ph_basicio &
  ph_file_dump(a) &
  bprintf("\n\nIMPORTS\n\n")
 =>
  ph_2(a);

  InformCantConnect(f) &
  PFZ
 =>
  ph_1(f)(a);

  bconnect(f) &
  ph_2(a)
 =>
  ph_1(f)(a);

  ReadSystemName(a) &
  ph_1(bcatl("CFG/",a,"I.imp"))(a)
 =>
  ph_0

END

&

THEORY GBIPrintFncObjX IS

#define GBIpfncoTac ((WRITE;MAP;FLAT;ARI;MODR)~;GBIPrintFncObjX)~

#define GBIPrintFncObj bcall(GBIpfncoTac: prt_fnc_obj_0)


  ?;

  ?;  /* printed param list */

  ?;  /* 1=> \/ required */


  bmodr(GBIPrintFncObjX.3,1)
 =>
  check_union;

  brule(GBIPrintFncObjX.3,1) &
  bprintf("\/")
 =>
  check_union;

  brule(GBIPrintFncObjX.1,X) &
  bmodr(GBIPrintFncObjX.1,(X,x))
 =>
  update_fnc_obj_VALUE_sto(x);

  brule(GBIPrintFncObjX.1,X) &
  bsearch(x,X,Y)
 =>
  update_fnc_obj_VALUE_sto(x);

  bprintf(" , %",N)
 =>
  prt_fnc_obj_maxfld2(b)(?)(N);

  prt_fnc_obj_maxfld2(b)(T)(N+1)
 =>
  prt_fnc_obj_maxfld2(b)(T;t)(N);

  brule(GBConstantsTypeStoX.I,b(X)) &
  bsearch((t|fstrobj(B)),X,Y) &
  prt_fnc_obj_maxfld2(b)(T)(N)
 =>
  prt_fnc_obj_maxfld2(b)(T;t)(N);

  prt_fnc_obj_maxfld2(b)(T)(N)
 =>
  prt_fnc_obj_maxfld1(b)(T)(N)(?);

  prt_fnc_obj_maxfld1(b)(T)(N)(X)
 =>
  prt_fnc_obj_maxfld1(b)(T)(N)(X,x);

  prt_fnc_obj_maxfld1(b)(T)(N+1+(M/4))(X)
 =>
  prt_fnc_obj_maxfld1(b)(T)(N)(X,FSTRING[M]);

  brule(GBFSTROBJTypeStoX.I,b(X)) &
  prt_fnc_obj_maxfld1(b)(T)(N)(X)
 =>
  prt_fnc_obj_maxfld(b)(T)(N);


  check_union &
  bprintf("%",t) &
  update_fnc_obj_VALUE_sto(t)
 =>
  prt_fnc_obj_VALUE_1(b,set(t));

  ReadSystemName(a) &
  check_union &
  bprintf("SCALAR") &
  update_fnc_obj_VALUE_sto(SCALAR)
 =>
  prt_fnc_obj_VALUE_1(b,nat(t));

  check_union &
  bprintf("SCALAR") &
  update_fnc_obj_VALUE_sto(SCALAR)
 =>
  prt_fnc_obj_VALUE_1(b,fstrobj(t));

  ReadSystemName(a) &
  check_union &
  bprintf("%_STROBJ",a) &
  update_fnc_obj_VALUE_sto(a:STROBJ)
 =>
  prt_fnc_obj_VALUE_1(b,strobj(t));

  ReadSystemName(a) &
  check_union &
  bprintf("%_SEQOBJ",a) &
  update_fnc_obj_VALUE_sto(a:SEQOBJ)
 =>
  prt_fnc_obj_VALUE_1(b,seqobj(t));

  ReadSystemName(a) &
  check_union &
  bprintf("%_SETOBJ",a) &
  update_fnc_obj_VALUE_sto(a:SETOBJ)
 =>
  prt_fnc_obj_VALUE_1(b,setobj(t));

  check_union &
  bprintf("%_FNCOBJ",t) &
  update_fnc_obj_VALUE_sto(t:FNCOBJ)
 =>
  prt_fnc_obj_VALUE_1(b,fncobj(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;t)) &          /* not already printed */
  prt_fnc_obj_VALUE_1(b,set(t)) &
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(t)
 =>
  prt_fnc_obj_VALUE_0(b,set(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(t,T,U) &                          /* already printed */
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(t)
 =>
  prt_fnc_obj_VALUE_0(b,set(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;SCALAR)) &     /* not already printed */
  prt_fnc_obj_VALUE_1(b,nat(t)) &
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(t)
 =>
  prt_fnc_obj_VALUE_0(b,nat(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(SCALAR,T,U) &                     /* already printed */
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(t)
 =>
  prt_fnc_obj_VALUE_0(b,nat(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;SCALAR)) &    /* not already printed */
  prt_fnc_obj_VALUE_1(b,fstrobj(t)) &
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:SCALAR)
 =>
  prt_fnc_obj_VALUE_0(b,fstrobj(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(SCALAR,T,U) &                    /* already printed */
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:SCALAR)
 =>
  prt_fnc_obj_VALUE_0(b,fstrobj(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;strobj)) &    /* not already printed */
  prt_fnc_obj_VALUE_1(b,strobj(t)) &
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:STROBJ)
 =>
  prt_fnc_obj_VALUE_0(b,strobj(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(strobj,T,U) &                    /* already printed */
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:STROBJ)
 =>
  prt_fnc_obj_VALUE_0(b,strobj(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;seqobj)) &    /* not already printed */
  prt_fnc_obj_VALUE_1(b,seqobj(t)) &
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:SEQOBJ)
 =>
  prt_fnc_obj_VALUE_0(b,seqobj(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(seqobj,T,U) &                    /* already printed */
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:SEQOBJ)
 =>
  prt_fnc_obj_VALUE_0(b,seqobj(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;setobj)) &    /* not already printed */
  prt_fnc_obj_VALUE_1(b,setobj(t)) &
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:SETOBJ)
 =>
  prt_fnc_obj_VALUE_0(b,setobj(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(setobj,T,U) &                    /* already printed */
  ReadSystemName(a) &
  update_fnc_obj_VALUE_sto(a:SETOBJ)
 =>
  prt_fnc_obj_VALUE_0(b,setobj(t));


  brule(GBIPrintFncObjX.2,T) &
  bmodr(GBIPrintFncObjX.2,(T;fncobj(t))) & /* not already printed */
  prt_fnc_obj_VALUE_1(b,fncobj(t)) &
  update_fnc_obj_VALUE_sto(t:FNCOBJ)
 =>
  prt_fnc_obj_VALUE_0(b,fncobj(t));

  brule(GBIPrintFncObjX.2,T) &
  bsearch(fncobj(t),T,U) &                 /* already printed */
  update_fnc_obj_VALUE_sto(t:FNCOBJ)
 =>
  prt_fnc_obj_VALUE_0(b,fncobj(t));

  prt_fnc_obj_VALUE_0(b,?);



  brule(GBTypeStoX.I,b(t)) &
  brule(GBConstantsStoX.J,(1|b(u))) &
  brule(GBConstantsStoX.K,(0|b(v))) &
  bprintf("  %_ffnc_ctx,  %_ffnc_obj(",b,b) &
  bmodr(GBIPrintFncObjX.2,?) &
  bmodr(GBIPrintFncObjX.3,?) &
  prt_fnc_obj_VALUE_0(b) bsmap t &
  prt_fnc_obj_maxfld(b)(bflat(?;u;v))(0) &
  bprintf(" , max_%)",b)
 =>
  prt_fnc_obj_2(b);

  brule(GBTypeStoX.I,b(t)) &
  brule(GBConstantsStoX.J,(1|b(?))) &
  brule(GBConstantsStoX.K,(0|b(v))) &
  bprintf("  %_ffnc_ctx,  %_ffnc_obj(",b,b) &  
  bmodr(GBIPrintFncObjX.2,?) &
  bmodr(GBIPrintFncObjX.3,?) &
  prt_fnc_obj_VALUE_0(b) bsmap t &
  prt_fnc_obj_maxfld(b)(bflat(?;v))(0) &
  bprintf(" , max_%)",b)
 =>
  prt_fnc_obj_2(b);

  brule(GBTypeStoX.I,b(t)) &
  brule(GBConstantsStoX.J,(1|b(u))) &
  brule(GBConstantsStoX.K,(0|b(?))) &
  bprintf("  %_ffnc_ctx,  %_ffnc_obj(",b,b) &  
  bmodr(GBIPrintFncObjX.2,?) &
  bmodr(GBIPrintFncObjX.3,?) &
  prt_fnc_obj_VALUE_0(b) bsmap t &
  prt_fnc_obj_maxfld(b)(bflat(?;u))(0) &
  bprintf(" , max_%)",b)
 =>
  prt_fnc_obj_2(b);



  brule(GBTypeStoX.I,(GLOBAL ? END)(t)) &
  brule(GBConstantsStoX.J,(1|(GLOBAL ? END)(u))) &
  brule(GBConstantsStoX.K,(0|(GLOBAL ? END)(?))) &
  ReadSystemName(a) &
  bprintf("  %_Vffnc(",a) &
  bmodr(GBIPrintFncObjX.2,?) &
  bmodr(GBIPrintFncObjX.3,?) &
  prt_fnc_obj_VALUE_0(GLOBAL ? END) bsmap t &
  prt_fnc_obj_maxfld(GLOBAL ? END)(bflat(?;u))(0) &
  bprintf(")")
 =>
  pfo_Vfnc_obj_2(GLOBAL ? END);


  prt_fnc_obj_2(b) &
  bprintf(",\n\n")
 =>
  prt_fnc_obj_1(b,m,n);

  prt_fnc_obj_2(b)
 =>
  prt_fnc_obj_1(b,n,n);

  pfo_Vfnc_obj_2(GLOBAL ? END) &
  bprintf(",\n\n")
 =>
  prt_fnc_obj_1(GLOBAL ? END,m,n);

  pfo_Vfnc_obj_2(GLOBAL ? END)
 =>
  prt_fnc_obj_1(GLOBAL ? END,n,n);

  prt_fnc_obj_1(?,m,n);

  ReadBaseNames(x) &
  prt_fnc_obj_1 bnmap x
 =>
  prt_fnc_obj_0

END

&

THEORY GBIPrintSetObjX IS

#define GBIpsetoTac ((ARI;WRITE;MAP;MODR)~;GBIPrintSetObjX)~

#define GBIPrintSetObj bcall(GBIpsetoTac: prt_set_obj_0)

  ?;?;

  brule(GBIPrintSetObjX.1,V) &
  brule(GBIPrintSetObjX.2,W) &
  bmodr(GBIPrintSetObjX.1,(V,N(b))) &
  bmodr(GBIPrintSetObjX.2,(W,M(b)))
 =>
  prt_set_obj_maxobj_3(b)(N)(M)(?);

  prt_set_obj_maxobj_3(b)(N+1)(M+Y)(S)
 =>
  prt_set_obj_maxobj_3(b)(N)(M)(S,SET[X][Y]);


  bprintf("+%*max_%",N,b)
 =>
  prt_set_obj_maxobj_2(N(b));

  brule(GBIPrintSetObjX.1,?) &
  bmodr(GBIPrintSetObjX.1,1) &
  bprintf(" , %*max_%",N,b)
 =>
  prt_set_obj_maxobj_2(N(b));

  bprintf("+max_%",b)
 =>
  prt_set_obj_maxobj_2(1(b));
  brule(GBIPrintSetObjX.1,?) &
  bmodr(GBIPrintSetObjX.1,1) &
  bprintf(" , max_%",b)
 =>
  prt_set_obj_maxobj_2(1(b));

  bprintf("+%",N)
 =>
  prt_set_obj_maxobj_2(N(GLOBAL ? END));

  brule(GBIPrintSetObjX.1,?) &
  bmodr(GBIPrintSetObjX.1,1) &
  bprintf(" , %",N)
 =>
  prt_set_obj_maxobj_2(N(GLOBAL ? END));

  prt_set_obj_maxobj_2(0(b));

  prt_set_obj_maxobj_2(?);

  ReadSystemName(a) &
  brule(GBIPrintSetObjX.1,X) &
  brule(GBIPrintSetObjX.2,Y) &
  bmodr(GBIPrintSetObjX.1,?) &
  bmodr(GBIPrintSetObjX.2,?) &
  prt_set_obj_maxobj_2 bsmap (X) &
  bmodr(GBIPrintSetObjX.1,?) &
  bmodr(GBIPrintSetObjX.2,?) &
  prt_set_obj_maxobj_2 bsmap (Y) &
  bprintf(")")
 =>
  prt_set_obj_maxobj_1(N);

  brule(GBIPrintSetObjX.1,?)
 =>
  prt_set_obj_maxobj_1(N);

  brule(GBSETOBJTypeStoX.N,b(S)) &
  prt_set_obj_maxobj_3(b)(0)(0)(S) &
  prt_set_obj_maxobj_1(N+1)
 =>
  prt_set_obj_maxobj_1(N);

  brule(GBSETOBJTypeStoX.N,b(?)) &
  prt_set_obj_maxobj_1(N+1)
 =>
  prt_set_obj_maxobj_1(N);



  brule(GBIPrintSetObjX.1,V) &
  bmodr(GBIPrintSetObjX.1,(V,S))
 =>
  prt_set_obj_VALUE_3(b,SET[S][N]);

  brule(GBIPrintSetObjX.1,V) &
  bsearch(S,V,W)
 =>
  prt_set_obj_VALUE_3(b,SET[S][N]);

  ReadBaseNames(B) &
  bsearch(S,B,C) &
  prt_set_obj_VALUE_3(b,SET[fncobj(S)][N])
 =>
  prt_set_obj_VALUE_3(b,SET[S][N]);

  prt_set_obj_VALUE_3(b,?);

  prt_set_obj_VALUE_2(V) &
  bprintf("\/%",v)
 =>
  prt_set_obj_VALUE_2(V,v);

  prt_set_obj_VALUE_2(V) &
  bprintf("\/%",SCALAR)
 =>
  prt_set_obj_VALUE_2(V,NAT);

  prt_set_obj_VALUE_2(V) &
  bprintf("\/%_FNCOBJ",v)
 =>
  prt_set_obj_VALUE_2(V,fncobj(v));

  bprintf("%",v)
 =>
  prt_set_obj_VALUE_2(?,v);

  bprintf("%",SCALAR)
 =>
  prt_set_obj_VALUE_2(?,NAT);

  bprintf("%_FNCOBJ",v)
 =>
  prt_set_obj_VALUE_2(?,fncobj(v));

  ReadSystemName(a) &
  brule(GBIPrintSetObjX.1,X) &
  bprintf(",\n\n  %_set_ctx, %_set_obj(",a,a) &
  prt_set_obj_VALUE_2(X)
 =>
  prt_set_obj_VALUE_1(N);

  brule(GBIPrintSetObjX.1,?)
 =>
  prt_set_obj_VALUE_1(N);

  brule(GBSETOBJTypeStoX.N,b(S)) &
  prt_set_obj_VALUE_3(b) bsmap S &
  prt_set_obj_VALUE_1(N+1)
 =>
  prt_set_obj_VALUE_1(N);

  brule(GBSETOBJTypeStoX.N,b(?)) &
  prt_set_obj_VALUE_1(N+1)
 =>
  prt_set_obj_VALUE_1(N);

  bmodr(GBIPrintSetObjX.1,?) &
  prt_set_obj_VALUE_1(1) &
  bmodr(GBIPrintSetObjX.1,?) &
  bmodr(GBIPrintSetObjX.2,?) &
  prt_set_obj_maxobj_1(1)
 =>
  prt_set_obj_0

END

&

THEORY GBIPrintSeqObjX IS

#define GBIpseqoTac ((ARI~;WRITE;MAP;MODR)~;GBIPrintSeqObjX)~

#define GBIPrintSeqObj bcall(GBIpseqoTac: prt_seq_obj_0)

  ?;?;0;



  brule(GBIPrintSeqObjX.3,N) &
  bprintf("+%)",N)
 =>
  prt_seq_obj_maxobj_4;

  brule(GBIPrintSeqObjX.3,0) &
  bprintf(")")
 =>
  prt_seq_obj_maxobj_4;

  brule(GBIPrintSeqObjX.1,_)
 =>
  prt_seq_obj_maxobj_4;

  brule(GBIPrintSeqObjX.1,?)
 =>
  prt_seq_obj_maxobj_4;

  brule(GBIPrintSeqObjX.1,V) &
  brule(GBIPrintSeqObjX.2,W) &
  bmodr(GBIPrintSeqObjX.1,(V,N(b))) &
  bmodr(GBIPrintSeqObjX.2,(W,M(b)))
 =>
  prt_seq_obj_maxobj_3(b)(N)(M)(?);

  brule(GBIPrintSeqObjX.1,V) &
  brule(GBIPrintSeqObjX.2,W) &
  bmodr(GBIPrintSeqObjX.1,(V,(1+N)(GLOBAL ? END))) & /* one extra */
  bmodr(GBIPrintSeqObjX.2,(W,M(GLOBAL ? END)))
 =>
  prt_seq_obj_maxobj_3(GLOBAL ? END)(N)(M)(?);

  prt_seq_obj_maxobj_3(b)(N+1)(M+Y)(S)
 =>
  prt_seq_obj_maxobj_3(b)(N)(M)(S,SEQ[X][Y]);


  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+N) &
  bprintf("+%*(max_%+5)",N,b)
 =>
  prt_seq_obj_maxobj_2(N(b));

  brule(GBIPrintSeqObjX.1,?) &
  bmodr(GBIPrintSeqObjX.1,1) &
  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+N) &
  bprintf(" , %*(max_%+5)",N,b)
 =>
  prt_seq_obj_maxobj_2(N(b));

  brule(GBIPrintSeqObjX.1,_) &
  bmodr(GBIPrintSeqObjX.1,1) &
  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+N) &
  bprintf("+5 , %*(max_%+5)",N,b)
 =>
  prt_seq_obj_maxobj_2(N(b));

  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+1) &
  bprintf("+max_%+5",b)
 =>
  prt_seq_obj_maxobj_2(1(b));

  brule(GBIPrintSeqObjX.1,?) &
  bmodr(GBIPrintSeqObjX.1,1) &
  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+1) &
  bprintf(" , max_%+5",b)
 =>
  prt_seq_obj_maxobj_2(1(b));

  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+N) &
  bprintf("+%+5",N)
 =>
  prt_seq_obj_maxobj_2(N(GLOBAL ? END));

  brule(GBIPrintSeqObjX.1,?) &
  bmodr(GBIPrintSeqObjX.1,1) &
  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+N) &
  bprintf(" , %+5",N)
 =>
  prt_seq_obj_maxobj_2(N(GLOBAL ? END));

  brule(GBIPrintSeqObjX.1,_) &
  bmodr(GBIPrintSeqObjX.1,1) &
  brule(GBIPrintSeqObjX.3,M) &
  bmodr(GBIPrintSeqObjX.3,M+N) &
  bprintf("+5 , %",N)
 =>
  prt_seq_obj_maxobj_2(N(GLOBAL ? END));

  prt_seq_obj_maxobj_2(0(b));

  prt_seq_obj_maxobj_2(?);

  ReadSystemName(a) &
  brule(GBIPrintSeqObjX.1,X) &
  brule(GBIPrintSeqObjX.2,Y) &
  bmodr(GBIPrintSeqObjX.1,?) &
  bmodr(GBIPrintSeqObjX.2,?) &
  prt_seq_obj_maxobj_2 bsmap (X) &
  bmodr(GBIPrintSeqObjX.1,_) &
  bmodr(GBIPrintSeqObjX.2,?) &
  bmodr(GBIPrintSeqObjX.3,0) &
  prt_seq_obj_maxobj_2 bsmap (Y)
 =>
  prt_seq_obj_maxobj_1(N);

  brule(GBSEQOBJTypeStoX.N,b(S)) &
  prt_seq_obj_maxobj_3(b)(0)(0)(S) &
  prt_seq_obj_maxobj_1(N+1)
 =>
  prt_seq_obj_maxobj_1(N);

  brule(GBSEQOBJTypeStoX.N,b(?)) &
  prt_seq_obj_maxobj_1(N+1)
 =>
  prt_seq_obj_maxobj_1(N);



  brule(GBIPrintSeqObjX.1,V) &
  bmodr(GBIPrintSeqObjX.1,(V,S))
 =>
  prt_seq_obj_VALUE_3(b,SEQ[S][N]);

  brule(GBIPrintSeqObjX.1,V) &
  bsearch(S,V,W)
 =>
  prt_seq_obj_VALUE_3(b,SEQ[S][N]);

  ReadBaseNames(B) &
  bsearch(S,B,C) &
  prt_seq_obj_VALUE_3(b,SEQ[fncobj(S)][N])
 =>
  prt_seq_obj_VALUE_3(b,SEQ[S][N]);

  prt_seq_obj_VALUE_3(b,?);

  prt_seq_obj_VALUE_2(V) &
  bprintf("\/%",v)
 =>
  prt_seq_obj_VALUE_2(V,v);

  prt_seq_obj_VALUE_2(V) &
  bprintf("\/%",SCALAR)
 =>
  prt_seq_obj_VALUE_2(V,NAT);

  prt_seq_obj_VALUE_2(V) &
  bprintf("\/%_FNCOBJ",v)
 =>
  prt_seq_obj_VALUE_2(V,fncobj(v));

  bprintf("%",v)
 =>
  prt_seq_obj_VALUE_2(?,v);

  bprintf("%",SCALAR)
 =>
  prt_seq_obj_VALUE_2(?,NAT);

  bprintf("%_FNCOBJ",v)
 =>
  prt_seq_obj_VALUE_2(?,fncobj(v));

  ReadSystemName(a) &
  brule(GBIPrintSeqObjX.1,X) &
  bprintf(",\n\n  %_seq_ctx, %_seq_obj(",a,a) &
  prt_seq_obj_VALUE_2(X)
 =>
  prt_seq_obj_VALUE_1(N);

  brule(GBIPrintSeqObjX.1,?)
 =>
  prt_seq_obj_VALUE_1(N);

  brule(GBSEQOBJTypeStoX.N,b(S)) &
  prt_seq_obj_VALUE_3(b) bsmap S &
  prt_seq_obj_VALUE_1(N+1)
 =>
  prt_seq_obj_VALUE_1(N);

  brule(GBSEQOBJTypeStoX.N,b(?)) &
  prt_seq_obj_VALUE_1(N+1)
 =>
  prt_seq_obj_VALUE_1(N);

  bmodr(GBIPrintSeqObjX.1,?) &
  prt_seq_obj_VALUE_1(1) &
  bmodr(GBIPrintSeqObjX.1,?) &
  bmodr(GBIPrintSeqObjX.2,?) &
  bmodr(GBIPrintSeqObjX.3,0) &
  prt_seq_obj_maxobj_1(1) &
  prt_seq_obj_maxobj_4
 =>
  prt_seq_obj_0

END

&

THEORY GBIPrintStrObjX IS

#define GBIpstroTac ((WRITE;MAP;ARI;MODR)~;GBIPrintStrObjX)~

#define GBIPrintStrObj bcall(GBIpstroTac: prt_str_obj_0)

  ?;?;

  prt_str_obj_maxmem(?);

  bprintf("+%*(max_%+%)",N,s,M)
 =>
  prt_str_obj_maxmem(s(M)(N));

  bprintf("+%+%",N,M)
 =>
  prt_str_obj_maxmem((GLOBAL ? END)(M)(N));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("%*(max_%+%)",N,s,M)
 =>
  prt_str_obj_maxmem(s(M)(N));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("%+%",N,M)
 =>
  prt_str_obj_maxmem((GLOBAL ? END)(M)(N));

  bprintf("+max_%+%",s,M)
 =>
  prt_str_obj_maxmem(s(M)(1));

  bprintf("+%+1",M)
 =>
  prt_str_obj_maxmem((GLOBAL ? END)(M)(1));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("max_%+%",s,M)
 =>
  prt_str_obj_maxmem(s(M)(1));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("%+1,M")
 =>
  prt_str_obj_maxmem((GLOBAL ? END)(M)(1));

  prt_str_obj_maxmem(s(M)(0));





  prt_str_obj_maxobj(?);

  bprintf("+%*max_%",M,s)
 =>
  prt_str_obj_maxobj(s(M)(N));

  bprintf("+%",M)
 =>
  prt_str_obj_maxobj((GLOBAL ? END)(M)(N));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("%*max_%",M,s)
 =>
  prt_str_obj_maxobj(s(M)(N));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("%",M)
 =>
  prt_str_obj_maxobj((GLOBAL ? END)(M)(N));

  bprintf("+max_%",s)
 =>
  prt_str_obj_maxobj(s(1)(N));

  bprintf("+1")
 =>
  prt_str_obj_maxobj((GLOBAL ? END)(1)(N));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("max_%",s)
 =>
  prt_str_obj_maxobj(s(1)(N));

  brule(GBIPrintStrObjX.2,?) &
  bmodr(GBIPrintStrObjX.2,1) &
  bprintf("1")
 =>
  prt_str_obj_maxobj((GLOBAL ? END)(1)(N));

  prt_str_obj_maxobj(s(0)(N));


  ReadSystemName(a) &
  brule(GBIPrintStrObjX.1,S) &
  bprintf(",\n\n  %_str_ctx, %_str_obj(",a,a) &
  bmodr(GBIPrintStrObjX.2,?) &
  prt_str_obj_maxobj bsmap S &
  bprintf("+5 , ") &
  bmodr(GBIPrintStrObjX.2,?) &
  prt_str_obj_maxmem bsmap S &
  bprintf(")")
 =>
  prt_str_obj_100;

  brule(GBIPrintStrObjX.1,S) &
  bmodr(GBIPrintStrObjX.1,(S,b(M)(N)))
 =>
  prt_str_obj_2(M)(N)(b(?));

  prt_str_obj_2(M+1)(N+n)(b(s))
 =>
  prt_str_obj_2(M)(N)(b(s,STRING[n]));

  prt_str_obj_1(N);

  brule(GBSTROBJTypeStoX.N,b(s)) &
  prt_str_obj_2(0)(0)(b(s)) &
  prt_str_obj_1(N+1)
 =>
  prt_str_obj_1(N);

  prt_str_obj_0;

  STRINGFlagset &
  bmodr(GBIPrintStrObjX.1,?) &
  prt_str_obj_1(1) &
  prt_str_obj_100
 =>
  prt_str_obj_0

END

&

THEORY GBIPrintConstantsX IS

#define GBIpcTac ((ARI~;MODR;WRITE;MAP)~;GBIPrintConstantsX)~

#define GBIPrintConstants bcall(GBIpcTac: pc_0)

  ?;

  bprintf(",\n  %_idx",c)
 =>
  pc_2(b,c,m,n);

  brule(GBConstantsTypeStoX.I,b(X)) &
  bsearch((c|fstrobj(B)),X,Y) &
  bprintf(",\n  %_idx,%_len",c,c)
 =>
  pc_2(b,c,m,n);

  bprintf(",\n\n  %_idx",c)
 =>
  pc_2(b,c,1,n);

  brule(GBConstantsTypeStoX.I,b(X)) &
  bsearch((c|fstrobj(B)),X,Y) &
  bprintf(",\n\n  %_idx,%_len",c,c)
 =>
  pc_2(b,c,1,n);

  brule(GBIPrintConstantsX.1,?) &
  bmodr(GBIPrintConstantsX.1,1) &
  bprintf("\n\n  %_idx",c)
 =>
  pc_2(b,c,m,n);

  brule(GBIPrintConstantsX.1,?) &
  bmodr(GBIPrintConstantsX.1,1) &
  brule(GBConstantsTypeStoX.I,b(X)) &
  bsearch((c|fstrobj(B)),X,Y) &
  bprintf("\n\n  %_idx,%_len",c,c)
 =>
  pc_2(b,c,m,n);

  pc_1(N);

  brule(GBConstantsStoX.N,(n|b(c))) &
  pc_2(b) bnmap c &
  pc_1(N+1)
 =>
  pc_1(N);

  brule(GBConstantsStoX.N,(n|b(?))) &
  pc_1(N+1)
 =>
  pc_1(N);

  bprintf("\n\nCONSTANTS") &
  pc_1(1) &
  bprintf("\n")
 =>
  pc_0

END

&

THEORY GBIPrintPropertiesX IS

#define GBIppTac ((ARI~;MODR;WRITE;FLAT;MAP)~;GBIPrintPropertiesX)~

#define GBIPrintProperties bcall(GBIppTac: pp_0)

  ?;?;?;?;?;

#define GBIIndexLengthStore GBIPrintPropertiesX.5


  bprintf(" & \n")
 =>
  pr_amp;

  brule(GBIPrintPropertiesX.4,1) &
  bmodr(GBIPrintPropertiesX.4,0) &
  bprintf(" & \n\n")
 =>
  pr_amp;

  brule(GBIPrintPropertiesX.4,?) &
  bmodr(GBIPrintPropertiesX.4,0) &
  bprintf("\n")
 =>
  pr_amp;


  pr_amp &
  brule(GBIIndexLengthStore,S) &
  bsearch((c:m:n),S,T) &
  brule(GBIPrintPropertiesX.3,N) &
  bmodr(GBIPrintPropertiesX.3,(N+n)) &
  bprintf("  %_idx = %",c,N)
 =>
  pp_10(c);

  pr_amp &
  brule(GBIIndexLengthStore,S) &
  bsearch(fstrobj(c:m:n),S,T) &
  brule(GBIPrintPropertiesX.3,N) &
  bmodr(GBIPrintPropertiesX.3,(N+n)) &
  bprintf("  %_idx = %",c,N) &
  bprintf(" &\n  %_len = %",c,n)
 =>
  pp_10(c);



  brule(GBIIndexLengthStore,S) &
  bmodr(GBIIndexLengthStore,(S,(c:m:n)))
 =>
  pp_3(c)(m)(n);

  brule(GBIIndexLengthStore,S) &
  bmodr(GBIIndexLengthStore,(S,fstrobj(c:m:n)))
 =>
  pp_3_fstrobj(c)(m)(n);

  pp_2(W)(Z)(?);

  pp_3(c)(1)(1) &
  pp_2(W)(Z)(C)
 =>
  pp_2(W)(Z;z)(C;c);

  pp_3_fstrobj(c)(n)(((n/4)+1)) &
  pp_2(W)(Z)(C)
 =>
  pp_2(W,FSTRING[n])(Z;(c|fstrobj(B)))(C;c);

  pp_1(M)(N);

  brule(GBConstantsStoX.M,(X|b(c))) &
  brule(GBConstantsStoX.N,(Y|b(d))) &
  brule(GBFSTROBJTypeStoX.I,b(W)) &
  brule(GBConstantsTypeStoX.J,b(Z)) &
  pp_2(W)(Z)(bflat(?;c;d)) &
  bmodr(GBIPrintPropertiesX.3,1) &
  pp_10 bsmap (bflat(c;d)) &
  bmodr(GBIPrintPropertiesX.4,1) &
  pp_1(M+2)(N+2)
 =>
  pp_1(M)(N);

  brule(GBConstantsStoX.M,(X|b(?))) &
  brule(GBConstantsStoX.N,(Y|b(d))) &
  brule(GBFSTROBJTypeStoX.I,b(W)) &
  brule(GBConstantsTypeStoX.J,b(Z)) &
  pp_2(W)(Z)(bflat(?;d)) &
  bmodr(GBIPrintPropertiesX.3,1) &
  pp_10 bsmap d &
  bmodr(GBIPrintPropertiesX.4,1) &
  pp_1(M+2)(N+2)
 =>
  pp_1(M)(N);

  brule(GBConstantsStoX.M,(X|b(c))) &
  brule(GBConstantsStoX.N,(Y|b(?))) &
  brule(GBFSTROBJTypeStoX.I,b(W)) &
  brule(GBConstantsTypeStoX.J,b(Z)) &
  pp_2(W)(Z)(bflat(?;c)) &
  bmodr(GBIPrintPropertiesX.3,1) &
  pp_10 bsmap c &
  bmodr(GBIPrintPropertiesX.4,1) &
  pp_1(M+2)(N+2)
 =>
  pp_1(M)(N);



/*
  bprintf("POW(NAT*%)\/",t)
*/
  bprintf("seq(%)\/",t)
 =>
  pp_seq_3(t,m,n);

  bprintf("seq(%)\/",SCALAR)
 =>
  pp_seq_3(NAT,m,n);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
/*
  bprintf("POW(NAT*%_ABSOBJ)\/",t)
*/
  bprintf("seq(%_ABSOBJ)\/",t)
 =>
  pp_seq_3(t,m,n);

  ReadSystemName(a) &
/*
  bprintf("POW(NAT*%) = %_SEQOBJ &",t,a)
*/
  bprintf("seq(%) = %_SEQOBJ &",t,a)
 =>
  pp_seq_3(t,n,n);

  ReadSystemName(a) &
  bprintf("seq(%) = %_SEQOBJ &",SCALAR,a)
 =>
  pp_seq_3(NAT,n,n);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  ReadSystemName(a) &
/*
  bprintf("POW(NAT*%_ABSOBJ) = %_SEQOBJ &",t,a)
*/
  bprintf("seq(%_ABSOBJ) = %_SEQOBJ &",t,a)
 =>
  pp_seq_3(t,n,n);

/*
  bprintf("\n  POW(NAT*%)\/",t)
*/
  bprintf("\n  seq(%)\/",t)
 =>
  pp_seq_3(t,1,n);

  bprintf("\n  seq(SCALAR)\/",t)
 =>
  pp_seq_3(NAT,1,n);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
/*
  bprintf("\n  POW(NAT*%_ABSOBJ)\/",t)
*/
  bprintf("\n  seq(%_ABSOBJ)\/",t)
 =>
  pp_seq_3(t,1,n);

  ReadSystemName(a) &
/*
  bprintf("\n  POW(NAT*%) = %_SEQOBJ &",t,a)
*/
  bprintf("\n  seq(%) = %_SEQOBJ &",t,a)
 =>
  pp_seq_3(t,1,1);

  ReadSystemName(a) &
  bprintf("\n  seq(%) = %_SEQOBJ &",SCALAR,a)
 =>
  pp_seq_3(NAT,1,1);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  ReadSystemName(a) &
/*
  bprintf("\n  POW(NAT*%_ABSOBJ) = %_SEQOBJ &",t,a)
*/
  bprintf("\n  seq(%_ABSOBJ) = %_SEQOBJ &",t,a)
 =>
  pp_seq_3(t,1,1);

  brule(GBIPrintPropertiesX.2,T) &
  bsearch(?,T,U) &
  pp_seq_3 bnmap U
 =>
  pp_seq_2;

  brule(GBIPrintPropertiesX.2,?)
 =>
  pp_seq_2;

  pp_seq_1(x);

  brule(GBIPrintPropertiesX.2,T) &
  bmodr(GBIPrintPropertiesX.2,(T,t))
 =>
  pp_seq_1(SEQ[t][n]);

  brule(GBIPrintPropertiesX.2,T) &
  bsearch(t,T,U)
 =>
  pp_seq_1(SEQ[t][n]);

  pp_seq_2
 =>
  pp_seq_0(n);

  brule(GBSEQOBJTypeStoX.n,b(T)) &
  pp_seq_1 bsmap T &
  pp_seq_0(n+1)
 =>
  pp_seq_0(n);

  brule(GBSEQOBJTypeStoX.n,b(?)) &
  pp_seq_0(n+1)
 =>
  pp_seq_0(n);




  pp_str_0;

/*
  STRINGFlagset &
  ReadSystemName(a) &
  bprintf("\n  POW(NAT*NAT) = %_STROBJ &",a)
 =>
  pp_str_0;
*/



  bprintf("POW(%)\/",t)
 =>
  pp_set_3(t,m,n);

  bprintf("POW(%)\/",SCALAR)
 =>
  pp_set_3(NAT,m,n);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  bprintf("POW(%_ABSOBJ)\/",t)
 =>
  pp_set_3(t,m,n);

  ReadSystemName(a) &
  bprintf("POW(%) = %_SETOBJ &",t,a)
 =>
  pp_set_3(t,n,n);

  ReadSystemName(a) &
  bprintf("POW(%) = %_SETOBJ &",SCALAR,a)
 =>
  pp_set_3(NAT,n,n);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  ReadSystemName(a) &
  bprintf("POW(%_ABSOBJ) = %_SETOBJ &",t,a)
 =>
  pp_set_3(t,n,n);

  bprintf("\n  POW(%)\/",t)
 =>
  pp_set_3(t,1,n);

  bprintf("\n  POW(%)\/",SCALAR)
 =>
  pp_set_3(NAT,1,n);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  bprintf("\n  POW(%_ABSOBJ)\/",t)
 =>
  pp_set_3(t,1,n);

  ReadSystemName(a) &
  bprintf("\n  POW(%) = %_SETOBJ &",t,a)
 =>
  pp_set_3(t,1,1);

  ReadSystemName(a) &
  bprintf("\n  POW(%) = %_SETOBJ &",SCALAR,a)
 =>
  pp_set_3(NAT,1,1);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  ReadSystemName(a) &
  bprintf("\n  POW(%_ABSOBJ) = %_SETOBJ &",t,a)
 =>
  pp_set_3(t,1,1);

  brule(GBIPrintPropertiesX.2,T) &
  bsearch(?,T,U) &
  pp_set_3 bnmap U
 =>
  pp_set_2;

  brule(GBIPrintPropertiesX.2,?)
 =>
  pp_set_2;

  pp_set_1(x);

  brule(GBIPrintPropertiesX.2,T) &
  bmodr(GBIPrintPropertiesX.2,(T,t))
 =>
  pp_set_1(SET[t][n]);

  brule(GBIPrintPropertiesX.2,T) &
  bsearch(t,T,U)
 =>
  pp_set_1(SET[t][n]);

  pp_set_2
 =>
  pp_set_0(n);

  brule(GBSETOBJTypeStoX.n,b(T)) &
  pp_set_1 bsmap T &
  pp_set_0(n+1)
 =>
  pp_set_0(n);

  brule(GBSETOBJTypeStoX.n,b(?)) &
  pp_set_0(n+1)
 =>
  pp_set_0(n);


  bprintf("  %_ABSOBJ = %_FNCOBJ &\n",b)
 =>
  pp_base(b);

  pp_base(GLOBAL ? END);

  pp_base(?);


  ReadBaseNames(S) &
  bmodr(GBIPrintPropertiesX.1,?) &
  bprintf("\nPROPERTIES\n\n") &
  pp_base bsmap S &
  bmodr(GBIPrintPropertiesX.2,?) &
  pp_seq_0(1) &
  bmodr(GBIPrintPropertiesX.2,?) &
  pp_set_0(1) &
  pp_str_0 &
  bprintf("\n") &
  pp_1(1)(2) &
  bprintf("\n")
 =>
  pp_0

END

&

THEORY GBIPrintInvariantX IS

#define GBIpinvTac ((MAP;ARI;MODR;WRITE)~;GBIPrintInvariantX)~

#define GBIPrintInvariant bcall(GBIpinvTac: prt_inv_0)

  ?;

  bprintf(" &\n")
 =>
  chk_amp_nl;

  brule(GBIPrintInvariantX.1,?) &
  bmodr(GBIPrintInvariantX.1,1) &
  bprintf("\n")
 =>
  chk_amp_nl;

  bprintf(" &")
 =>
  chk_amp;

  brule(GBIPrintInvariantX.1,?) &
  bmodr(GBIPrintInvariantX.1,1)
 =>
  chk_amp;


  ReadSystemName(a) &                        /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|set(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|set(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|set(x)));



  ReadSystemName(a) &                        /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|nat(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|nat(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|nat(x)));



  ReadSystemName(a) &                        /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|fncobj(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|fncobj(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => %(tok) = %_fncstruct(tok)(%_idx))",c,c,b,c)
 =>
  prt_inv_3(b,(c|fncobj(x)));



  ReadSystemName(a) &                        /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %_fncstruct(tok)(%_idx): dom(%_setstruct)\n    )) &",c,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_setstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|setobj(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => (\n    %_fncstruct(tok)(%_idx): dom(%_setstruct)\n    )) &",b,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_setstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|setobj(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => (\n    %_fncstruct(tok)(%_idx): dom(%_setstruct)\n    )) &",b,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_setstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|setobj(x)));



  ReadSystemName(a) &                        /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %_fncstruct(tok)(%_idx): dom(%_seqstruct)\n    )) &",c,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_seqstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|seqobj(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => (\n    %_fncstruct(tok)(%_idx): dom(%_seqstruct)\n    )) &",b,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_seqstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|seqobj(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => (\n    %_fncstruct(tok)(%_idx): dom(%_seqstruct)\n    )) &",b,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_seqstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|seqobj(x)));



  ReadSystemName(a) &                         /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = (\n    %_UnPack((%_idx..%_idx+%_len<|%_fncstruct(tok)))\n    )\n   ))",c,c,b,c,c,c,b)
 =>
  prt_inv_3(b,(c|fstrobj(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = (\n    %_UnPack((%_idx..%_idx+%_len<|%_fncstruct(tok)))\n    )\n    ))",c,c,b,c,c,c,b)
 =>
  prt_inv_3(b,(c|fstrobj(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = (\n    %_UnPack((%_idx..%_idx+%_len<|%_fncstruct(tok)))\n    )\n    ))",c,c,b,c,c,c,b)
 =>
  prt_inv_3(b,(c|fstrobj(x)));



  ReadSystemName(a) &                         /* opt */
  chk_amp_nl &
  bprintf("\n  dom(%) = {tok|tok:dom(%_fncstruct) & %_idx:dom(%_fncstruct(tok))} &",c,b,c,b) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %_fncstruct(tok)(%_idx): dom(%_strstruct)\n    )) &",c,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_strstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|strobj(x)));

  brule(GBConstantsStoX.I,(1|b(c))) &        /* mand */
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => (\n    %_fncstruct(tok)(%_idx): dom(%_strstruct)\n    )) &",b,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_strstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|strobj(x)));

  brule(GBConstantsStoX.I,(1|b(C))) &        /* mand */
  bsearch(c,C,D) &
  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => %_idx:dom(%_fncstruct(tok))) &",b,c,b) &
  bprintf("\n  !tok.(tok:dom(%_fncstruct) => (\n    %_fncstruct(tok)(%_idx): dom(%_strstruct)\n    )) &",b,b,c,a) &
  bprintf("\n  !tok.(tok:dom(%) => (\n    %(tok) = %_strstruct(%_fncstruct(tok)(%_idx)))\n    )",c,c,a,b,c)
 =>
  prt_inv_3(b,(c|strobj(x)));




  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_Vfnc(%_idx)",c,a,c)
 =>
  prt_inv_3((GLOBAL ? END),(c|set(t)));

  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_Vfnc(%_idx)",c,a,c)
 =>
  prt_inv_3((GLOBAL ? END),(c|nat(x)));

  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_Vfnc(%_idx)",c,a,c)
 =>
  prt_inv_3((GLOBAL ? END),(c|fncobj(t)));

  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_setstruct(%_Vfnc(%_idx))",c,a,a,c)
 =>
  prt_inv_3((GLOBAL ? END),(c|setobj(x)));

  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_seqstruct(%_Vfnc(%_idx))",c,a,a,c)
 =>
  prt_inv_3((GLOBAL ? END),(c|seqobj(x)));

  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_UnPack((%_idx..%_idx+%_len<|%_Vfnc))",c,a,c,c,c,a)
 =>
  prt_inv_3((GLOBAL ? END),(c|fstrobj(x)));

  ReadSystemName(a) &
  chk_amp_nl &
  bprintf("\n  % = %_strstruct(%_Vfnc(%_idx))",c,a,a,c)
 =>
  prt_inv_3((GLOBAL ? END),(c|strobj(x)));



  prt_inv_3(b,?);

  prt_inv_3(b) bsmap C
 =>
  prt_inv_2(b(C));



  prt_inv_1(N);

  brule(GBConstantsTypeStoX.N,b(X)) &
  prt_inv_2(b(X)) &
  prt_inv_1(N+1)
 =>
  prt_inv_1(N);

  chk_amp &
  bprintf("\n\n  % = %_fnctok &\n  locate_% = %_locate",b,b,b,b)
 =>
  prt_inv_locate(b);

  prt_inv_locate(GLOBAL ? END);

  prt_inv_locate(?);

  ReadBaseNames(B) &
  bprintf("\nINVARIANT") &
  bmodr(GBIPrintInvariantX.1,?) &
  prt_inv_locate bsmap B &
  prt_inv_1(1)
 =>
  prt_inv_0

END

&

THEORY GBIPrintInitialisationX IS

#define GBIpinitTac ((MAP;MODR;WRITE)~;GBIPrintInitialisationX)~

#define GBIPrintInitialisation bcall(GBIpinitTac: init_0)

  ?;

  bprintf(a)
 =>
  _bprintf(a);

  _bprintf(";\n")
 =>
  init_sc;

  brule(GBIPrintInitialisationX.1,?) &
  bmodr(GBIPrintInitialisationX.1,1) &
  _bprintf("\n")
 =>
  init_sc;

  init_1(x);



  ReadSystemName(a) &
  init_sc &
  _bprintf("    %_OVR_LIT_FFNC(%_idx,%_len,\"\")",a,v,v)
 =>
  init_1(v|fstrobj(T));



  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %,%<--%_CRE_STR_OBJ;\n",x,S,a) &
  _bprintf("      %_STO_FNC(%_idx,%)\n    END",a,v,S)
 =>
  init_3(v|strobj(T))(x);
  
  ReadSystemName(a) &
  GBReadFreshVar(x) &
  GBEmptyAccumulatedVariables &
  GBPrintStrTok(b) &
  _bprintf(" IN\n") &
  init_3(v|strobj(T))(x)
 =>
  init_2(v|strobj(T));

  init_sc &
  _bprintf("    VAR ") &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  init_2(v|strobj(T))
 =>
  init_1(v|strobj(T));

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %,%<--%_CRE_SEQ_OBJ;\n",x,S,a) &
  _bprintf("      %_STO_FNC(%_idx,%)\n    END",a,v,S)
 =>
  init_3(v|seqobj(T))(x);
  
  ReadSystemName(a) &
  GBReadFreshVar(x) &
  GBEmptyAccumulatedVariables &
  GBPrintSeqTok(b) &
  _bprintf(" IN\n") &
  init_3(v|seqobj(T))(x)
 =>
  init_2(v|seqobj(T));

  init_sc &
  _bprintf("    VAR ") &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  init_2(v|seqobj(T))
 =>
  init_1(v|seqobj(T));

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %,%<--%_CRE_SET_OBJ;\n",x,S,a) &
  _bprintf("      %_STO_FNC(%_idx,%)\n    END",a,v,S)
 =>
  init_3(v|setobj(T))(x);
  
  ReadSystemName(a) &
  GBReadFreshVar(x) &
  GBEmptyAccumulatedVariables &
  GBPrintSetTok(b) &
  _bprintf(" IN\n") &
  init_3(v|setobj(T))(x)
 =>
  init_2(v|setobj(T));

  init_sc  &
  _bprintf("    VAR ") &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  init_2(v|setobj(T))
 =>
  init_1(v|setobj(T));

  init_sc  &
  ReadSystemName(a) &
  _bprintf("    %_STO_FNC(%_idx,0)",a,v)
 =>
  init_1(v|nat(T));

  init_0;

  brule(GBConstantsTypeStoX.N,((GLOBAL ? END)(X))) &
  _bprintf("\n\nINITIALISATION\n\n  BEGIN") &
  init_1 bsmap X &
  _bprintf("\n  END")
 =>
  init_0;

  NAT==SCALAR

END

&

THEORY GBIPrintSetObjOpsX IS

#define GBIpsetopTac ((MAP;MODR;WRITE)~;GBIPrintSetObjOpsX)~

#define GBIPrintSetObjOps(a,b,c) \
	bcall(GBIpsetopTac: setobj_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  incl
***/

  ReadSystemName(a) &
  GBReadTok(H) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,F,c) &
  _bprintf("      %<--%_INCL_SET_OBJ(%,%)\n    END",x,a,G,H)
 =>
  incl_setobj_5(b)(c)(t)(x)(F)(G);

  ReadSystemName(a) &
  GBReadTok(H) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",H,a,c) &
  _bprintf("      %<--%_INCL_SET_OBJ(%,%)\n    END",x,a,G,H)
 =>
  incl_setobj_5(GLOBAL ? END)(c)(t)(x)(F)(G);

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("    VAR ") &
  GBPrintSetTok(a) &
  _bprintf(" IN\n") &
  incl_setobj_5(b)(c)(t)(x)(F)(G)
 =>
  incl_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf(") =\n") &
  incl_setobj_4(b)(c)(t)(x)(F)
 =>
  incl_setobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  incl_setobj_3(b)(c)(t)(x)
 =>
  incl_setobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  incl_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  incl_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- incl_%(",c) &
  incl_setobj_2(b)(c)(t)
 =>
  incl_setobj_1(b)(c)(t);

  incl_setobj_1(b)(c)(t)
 =>
  incl_setobj_0(b)(c)(t);

/***
  eql
***/

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_INCL_SET_OBJ(%_0,%);\n",y,a,S,S) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_INCL_SET_OBJ(%,%_0)\n      END;\n",y,y,a,S,S) &
  _bprintf("      %:=%\n    END",x,y)
 =>
  eql_setobj_5(b)(c)(t)(x)(F)(S);

  GBReadTok(S) &
  GBPrintFreshVar(bb) &
  _bprintf(",%_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  eql_setobj_5(b)(c)(t)(x)(F)(S)
 =>
  eql_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  GBPrintFreshVar(bb) &
  _bprintf(",%_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  eql_setobj_5(GLOBAL ? END)(c)(t)(x)(F)(S)
 =>
  eql_setobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf(") =\n    VAR ") &
  eql_setobj_4(b)(c)(t)(x)(F)
 =>
  eql_setobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  eql_setobj_3(b)(c)(t)(x)
 =>
  eql_setobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  eql_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  eql_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%(",c) &
  eql_setobj_2(b)(c)(t)
 =>
  eql_setobj_1(b)(c)(t);

  eql_setobj_1(b)(c)(t)
 =>
  eql_setobj_0(b)(c)(t);

/***
  mod
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n      %<--%_CPY_SET_OBJ(%,%_0)\n    END",S,S,b,F,c,x,a,S,S)
 =>
  mod_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n      %<--%_CPY_SET_OBJ(%,%_0)\n    END",S,S,a,c,x,a,S,S)
 =>
  mod_setobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  mod_setobj_4(b)(c)(t)(x)(F)
 =>
  mod_setobj_3(b)(c)(t)(x);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  mod_setobj_4(GLOBAL ? END)(c)(t)(x)(F)
 =>
  mod_setobj_3(GLOBAL ? END)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  mod_setobj_3(b)(c)(t)(x)
 =>
  mod_setobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- mod_%(",c) &
  mod_setobj_2(b)(c)(t)
 =>
  mod_setobj_1(b)(c)(t);

  GBReadFreshVar(x) &
  mod_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  mod_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- mod_%(",c) &
  mod_setobj_2(GLOBAL ? END)(c)(t)
 =>
  mod_setobj_1(GLOBAL ? END)(c)(t);

  mod_setobj_1(b)(c)(t)
 =>
  mod_setobj_0(b)(c)(t);

/***
  diff
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  _bprintf("      %_DIFF_SET_OBJ(%_0,%)\n    END",a,S,S)
 =>
  diff_setobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  _bprintf("      %_DIFF_SET_OBJ(%_0,%)\n    END",a,S,S)
 =>
  diff_setobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf(") =\n    VAR ") &
  diff_setobj_4(b)(c)(t)(F)
 =>
  diff_setobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(",") &
  diff_setobj_3(b)(c)(t)
 =>
  diff_setobj_2(b)(c)(t);

  diff_setobj_3(GLOBAL ? END)(c)(t)
 =>
  diff_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  diff_%(",c) &
  diff_setobj_2(b)(c)(t)
 =>
  diff_setobj_1(b)(c)(t);

  diff_setobj_1(b)(c)(t)
 =>
  diff_setobj_0(b)(c)(t);

/***
  inter
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  _bprintf("      %_INTER_SET_OBJ(%_0,%)\n    END",a,S,S)
 =>
  inter_setobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  _bprintf("      %_INTER_SET_OBJ(%_0,%)\n    END",a,S,S)
 =>
  inter_setobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf(") =\n    VAR ") &
  inter_setobj_4(b)(c)(t)(F)
 =>
  inter_setobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(",") &
  inter_setobj_3(b)(c)(t)
 =>
  inter_setobj_2(b)(c)(t);

  inter_setobj_3(GLOBAL ? END)(c)(t)
 =>
  inter_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  inter_%(",c) &
  inter_setobj_2(b)(c)(t)
 =>
  inter_setobj_1(b)(c)(t);

  inter_setobj_1(b)(c)(t)
 =>
  inter_setobj_0(b)(c)(t);

/***
  union
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  _bprintf("      %<--%_UNION_SET_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  union_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  _bprintf("      %<--%_UNION_SET_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  union_setobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf(") =\n    VAR ") &
  union_setobj_4(b)(c)(t)(x)(F)
 =>
  union_setobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  union_setobj_3(b)(c)(t)(x)
 =>
  union_setobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  union_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  union_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- union_%(",c) &
  union_setobj_2(b)(c)(t)
 =>
  union_setobj_1(b)(c)(t);

  union_setobj_1(b)(c)(t)
 =>
  union_setobj_0(b)(c)(t);

/***
  member
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_MBR_SET_OBJ(%,%)\n    END",x,a,S,M)
 =>
  member_setobj_5(b)(c)(t)(x)(F)(M);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_MBR_SET_OBJ(%,%)\n    END",x,a,S,M)
 =>
  member_setobj_5(GLOBAL ? END)(c)(t)(x)(F)(M);

  ReadSystemName(a) &
  GBReadTok(M) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  member_setobj_5(b)(c)(t)(x)(F)(M)
 =>
  member_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadFreshVar(M) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  member_setobj_5(b)(c)(setobj(NAT))(x)(F)(M)
 =>
  member_setobj_4(b)(c)(setobj(NAT))(x)(F);

  GBReadTok(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n    VAR ") &
  member_setobj_4(b)(c)(setobj(t))(x)(F)
 =>
  member_setobj_3(b)(c)(setobj(t))(x);

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    VAR ") &
  member_setobj_4(b)(c)(setobj(NAT))(x)(F)
 =>
  member_setobj_3(b)(c)(setobj(NAT))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  member_setobj_3(b)(c)(t)(x)
 =>
  member_setobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  member_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  member_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- member_%(",c) &
  member_setobj_2(b)(c)(t)
 =>
  member_setobj_1(b)(c)(t);

  member_setobj_1(b)(c)(t)
 =>
  member_setobj_0(b)(c)(t);


/***
  search
***/
 
  setDEFSFlag &
  Read_invarReqd(I) &
  Modify_invarReqd((I,e)) &
/***
HERE(("setDEFSFlag":1:(I,e)))&
***/
  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,B,c) &
  _bprintf("      %<--%_CRD_SET_OBJ(%);\n",l,a,H) &
  _bprintf("        WHILE %/=0 & %=FALSE DO\n",l,f) &
  _bprintf("          %<--%_VAL_SET_OBJ(%,%);\n",G,a,H,l) &
  _bprintf("          check_%(%,%,%);\n",e,G,S,f) &
  _bprintf("          %:=%-1\n",l,l) &
  _bprintf("        VARIANT %\n",l) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: BOOL & %: 0..card(%) &\n",f,l,c) &
  _bprintf("          invar_%(%,%(%),%,%)\n        END;\n",e,f,c,B,G,S) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G) 
 =>
  search_obj_9(b)(c)(s(e))(x)(F)(B)(S)(l)(G)(f);

  setDEFSFlag &
  Read_invarReqd(I) &       /* added Sept 1999 */
  Modify_invarReqd((I,e)) & /* added Sept 1999 */
/***
HERE(("setDEFSFlag":2:(I,e)))&
***/
  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",H,a,c) &
  _bprintf("      %<--%_CRD_SET_OBJ(%);\n",l,a,H) &
  _bprintf("        WHILE %/=0 & %=FALSE DO\n",l,f) &
  _bprintf("          %<--%_VAL_SET_OBJ(%,%);\n",G,a,H,l) &
  _bprintf("          check_%(%,%,%);\n",e,G,S,f) &
  _bprintf("          %:=%-1\n",l,l) &
  _bprintf("        VARIANT %\n",l) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: BOOL & %: 0..card(%) &\n",f,l,c) &
  _bprintf("          invar_%(%,%,%,%)\n        END;\n",e,f,c,G,S) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G) 
 =>
  search_obj_9(GLOBAL ? END)(c)(s(e))(x)(F)(B)(S)(l)(G)(f);


  ReadSystemName(a) &
  GBReadFreshVar(f) &
  _bprintf(",") &
  GBPrintSetTok(a) &
  _bprintf(" IN\n") &
  search_obj_9(b)(c)(s(e))(x)(F)(B)(S)(l)(G)(f)
 =>
  search_obj_8(b)(c)(s(e))(x)(F)(B)(S)(l)(G);


  GBReadTok(G) &
  _bprintf(",") &
  GBPrintFreshVar(found) &
  search_obj_8(b)(c)(t)(x)(F)(B)(S)(l)(G)
 =>
  search_obj_7(b)(c)(t)(x)(F)(B)(S)(l);

  GBReadFreshVar(l) &
  _bprintf(",") &
  GBPrintFncTok(e) &
  search_obj_7(b)(c)(s(e))(x)(F)(B)(S)(l)
 =>
  search_obj_6(b)(c)(s(e))(x)(F)(B)(S);


  GBReadFreshVar(S) &
  GBPrintFreshVar(loc) &
  search_obj_6(b)(c)(t)(x)(F)(B)(S)
 =>
  search_obj_5(b)(c)(t)(x)(F)(B);

  GBReadTok(B) &
  GBPrintFreshVar(cc) &
  _bprintf(") =\n    VAR ") &
  search_obj_5(b)(c)(t)(x)(F)(B)
 =>
  search_obj_4(b)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  search_obj_4(b)(c)(t)(x)(F)
 =>
  search_obj_3(b)(c)(t)(x);

  GBReadTok(F) &
  search_obj_4(GLOBAL ? END)(c)(t)(x)(F)
 =>
  search_obj_3(GLOBAL ? END)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(e) &
  _bprintf(" <-- search_%(",c) &
  search_obj_3(b)(c)(s(e))(x)
 =>
  search_obj_2(b)(c)(s(e));  

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  search_obj_2(b)(c)(t)
 =>
  search_obj_1(b)(c)(t);

  search_obj_0(b)(c)(t);


  ReadBaseNames(B) &
  bsearch(e,B,C) &
  search_obj_1(b)(c)(setobj(e))
 =>
  search_obj_0(b)(c)(setobj(e));


/***
  del
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_RMV_SET_OBJ(%,%)\n    END",a,S,M)
 =>
  del_setobj_5(b)(c)(t)(F)(M);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_RMV_SET_OBJ(%,%)\n    END",a,S,M)
 =>
  del_setobj_5(GLOBAL ? END)(c)(t)(F)(M);

  ReadSystemName(a) &
  GBReadTok(M) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  del_setobj_5(b)(c)(t)(F)(M)
 =>
  del_setobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadFreshVar(M) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  del_setobj_5(b)(c)(setobj(NAT))(F)(M)
 =>
  del_setobj_4(b)(c)(setobj(NAT))(F);

  GBReadTok(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n    VAR ") &
  del_setobj_4(b)(c)(setobj(t))(F)
 =>
  del_setobj_3(b)(c)(setobj(t));

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    VAR ") &
  del_setobj_4(b)(c)(setobj(NAT))(F)
 =>
  del_setobj_3(b)(c)(setobj(NAT));

  GBPrintFncTok(b) &
  _bprintf(",") &
  del_setobj_3(b)(c)(t)
 =>
  del_setobj_2(b)(c)(t);

  del_setobj_3(GLOBAL ? END)(c)(t)
 =>
  del_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  del_%(",c) &
  del_setobj_2(b)(c)(t)
 =>
  del_setobj_1(b)(c)(t);

  del_setobj_1(b)(c)(t)
 =>
  del_setobj_0(b)(c)(t);

/***
  add
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_ENT_SET_OBJ(%,%)\n    END",x,a,S,M)
 =>
  add_setobj_5(b)(c)(t)(x)(F)(M);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_ENT_SET_OBJ(%,%)\n    END",x,a,S,M)
 =>
  add_setobj_5(GLOBAL ? END)(c)(t)(x)(F)(M);

  ReadSystemName(a) &
  GBReadTok(M) &
  GBPrintSetTok(a) &
  add_setobj_5(b)(c)(t)(x)(F)(M)
 =>
  add_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadFreshVar(M) &
  GBPrintSetTok(a) &
  add_setobj_5(b)(c)(setobj(NAT))(x)(F)(M)
 =>
  add_setobj_4(b)(c)(setobj(NAT))(x)(F);

  GBReadTok(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n    VAR ") &
  add_setobj_4(b)(c)(setobj(t))(x)(F)
 =>
  add_setobj_3(b)(c)(setobj(t))(x);

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    VAR ") &
  add_setobj_4(b)(c)(setobj(NAT))(x)(F)
 =>
  add_setobj_3(b)(c)(setobj(NAT))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  add_setobj_3(b)(c)(t)(x)
 =>
  add_setobj_2(b)(c)(t);


  GBReadFreshVar(x) &
  add_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  add_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- add_%(",c) &
  add_setobj_2(b)(c)(t)
 =>
  add_setobj_1(b)(c)(t);

  add_setobj_1(b)(c)(t)
 =>
  add_setobj_0(b)(c)(t);

/***
  clear
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_CLR_SET_OBJ(%)\n    END",a,S)
 =>
  clear_setobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_CLR_SET_OBJ(%)\n    END",a,S)
 =>
  clear_setobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  clear_setobj_4(b)(c)(t)(F)
 =>
  clear_setobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  clear_setobj_3(b)(c)(t)
 =>
  clear_setobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  clear_setobj_3(GLOBAL ? END)(c)(t)
 =>
  clear_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("clear_%(",c) &
  clear_setobj_2(b)(c)(t)
 =>
  clear_setobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("clear_%",c) &
  clear_setobj_2(GLOBAL ? END)(c)(t)
 =>
  clear_setobj_1(GLOBAL ? END)(c)(t);

  clear_setobj_1(b)(c)(t)
 =>
  clear_setobj_0(b)(c)(t);

/***
  card
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_CRD_SET_OBJ(%)\n    END",x,a,S)
 =>
  card_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_CRD_SET_OBJ(%)\n    END",x,a,S)
 =>
  card_setobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  card_setobj_4(b)(c)(t)(x)(F)
 =>
  card_setobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  card_setobj_3(b)(c)(t)(x)
 =>
  card_setobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" =\n    VAR ") &
  card_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  card_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nbr) &
  _bprintf(" <-- card_%(",c) &
  card_setobj_2(b)(c)(t)
 =>
  card_setobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nbr) &
  _bprintf(" <-- card_%",c) &
  card_setobj_2(GLOBAL ? END)(c)(t)
 =>
  card_setobj_1(GLOBAL ? END)(c)(t);

  card_setobj_1(b)(c)(t)
 =>
  card_setobj_0(b)(c)(t);

/***
  val
***/

  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  val_setobj_3(b)(c)(t);

  _bprintf("%_idx)",c)
 =>
  val_setobj_3(GLOBAL ? END)(c)(t);

  GBReadTok(S) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_VAL_FNC_OBJ(",S,b) &
  val_setobj_3(b)(c)(t)
 =>
  val_setobj_2(b)(c)(t);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" =\n    %<--%_VAL_FNC(",S,a) &
  val_setobj_3(GLOBAL ? END)(c)(t)
 =>
  val_setobj_2(GLOBAL ? END)(c)(t);

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintSetTok(a) &
  _bprintf(" <-- val_%(",c) &
  val_setobj_2(b)(c)(t)
 =>
  val_setobj_1(b)(c)(t);

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintSetTok(a) &
  _bprintf(" <-- val_%",c) &
  val_setobj_2(GLOBAL ? END)(c)(t)
 =>
  val_setobj_1(GLOBAL ? END)(c)(t);

  val_setobj_1(b)(c)(t)
 =>
  val_setobj_0(b)(c)(t);




/***
  valOrd
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_VAL_SET_OBJ(%,%)\n    END",M,a,S,x)
 =>
  valOrd_setobj_5(b)(c)(t)(M)(F)(x);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_VAL_SET_OBJ(%,%)\n    END",M,a,S,x)
 =>
  valOrd_setobj_5(GLOBAL ? END)(c)(t)(M)(F)(x);

  ReadSystemName(a) &
  GBReadFreshVar(x) &
  GBPrintSetTok(a) &
  valOrd_setobj_5(b)(c)(t)(M)(F)(x)
 =>
  valOrd_setobj_4(b)(c)(t)(M)(F);

  GBReadTok(F) &
  GBPrintFreshVar(ii) &
  _bprintf(") =\n    VAR ") &
  valOrd_setobj_4(b)(c)(t)(M)(F)
 =>
  valOrd_setobj_3(b)(c)(t)(M);

  GBReadTok(M) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  valOrd_setobj_3(b)(c)(t)(M)
 =>
  valOrd_setobj_2(b)(c)(t);

  GBReadTok(M) &
  valOrd_setobj_3(GLOBAL ? END)(c)(t)(M)
 =>
  valOrd_setobj_2(GLOBAL ? END)(c)(t);

  GBReadFreshVar(M) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  valOrd_setobj_3(b)(c)(setobj(NAT))(M)
 =>
  valOrd_setobj_2(b)(c)(setobj(NAT));

  GBReadFreshVar(M) &
  valOrd_setobj_3(GLOBAL ? END)(c)(setobj(NAT))(M)
 =>
  valOrd_setobj_2(GLOBAL ? END)(c)(setobj(NAT));

  GBOpSC &
  _bprintf("  ") &
  GBPrintMbr(t) &
  _bprintf(" <-- valOrd_%(",c) &
  valOrd_setobj_2(b)(c)(setobj(t))
 =>
  valOrd_setobj_1(b)(c)(setobj(t));

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nat) &
  _bprintf(" <-- valOrd_%(",c) &
  valOrd_setobj_2(b)(c)(setobj(NAT))
 =>
  valOrd_setobj_1(b)(c)(setobj(NAT));

  valOrd_setobj_1(b)(c)(t)
 =>
  valOrd_setobj_0(b)(c)(t);

/***
  write
***/

  _bprintf("      %_OUTPUT_SET_OBJ(%,%)\n    END",a,t,S)
 =>
  write_setobj_5(a)(t)(S);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  _bprintf("      %_OUTPUT_SET_OBJ(%_ABSOBJ,%)\n    END",a,t,S)
 =>
  write_setobj_5(a)(t)(S);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  write_setobj_5(a)(t)(S)
 =>
  write_setobj_4(b)(c)(setobj(t))(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  write_setobj_5(a)(t)(S)
 =>
  write_setobj_4(GLOBAL ? END)(c)(setobj(t))(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf("% IN\n") &
  write_setobj_4(b)(c)(t)(F)
 =>
  write_setobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  write_setobj_3(b)(c)(t)
 =>
  write_setobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  write_setobj_3(GLOBAL ? END)(c)(t)
 =>
  write_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("write_%(",c) &
  write_setobj_2(b)(c)(t)
 =>
  write_setobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("write_%",c) &
  write_setobj_2(GLOBAL ? END)(c)(t)
 =>
  write_setobj_1(GLOBAL ? END)(c)(t);

  write_setobj_1(b)(c)(t)
 =>
  write_setobj_0(b)(c)(t);

/***
  read
***/

  _bprintf("      %<--%_INPUT_SET_OBJ(%,%,%)\n    END",x,a,t,S,y)
 =>
  read_setobj_6(x)(a)(t)(S)(y);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  _bprintf("      %<--%_INPUT_SET_OBJ(%_ABSOBJ,%,%)\n    END",x,a,t,S,y)
 =>
  read_setobj_6(x)(a)(t)(S)(y);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--GET_PROMPT_NAT(\"Number of element to be read: \");\n",y) &
  read_setobj_6(x)(a)(t)(S)(y) 
 =>
  read_setobj_5(b)(c)(setobj(t))(x)(y)(F);

  ReadSystemName(a) &
  GBReadTok(S) & 
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--GET_PROMPT_NAT(\"Number of element to be read: \");\n",y) &
  read_setobj_6(x)(a)(t)(S)(y)
 =>
  read_setobj_5(GLOBAL ? END)(c)(setobj(t))(x)(y)(F);

  GBReadFreshVar(y) &
  read_setobj_5(b)(c)(t)(x)(y)(F)
 =>
  read_setobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSetTok(a) &
  _bprintf(",") &
  GBPrintFreshVar(ll) &
  _bprintf(" IN\n") &  
  read_setobj_4(b)(c)(t)(x)(F)
 =>
  read_setobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  read_setobj_3(b)(c)(t)(x)
 =>
  read_setobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" =\n    VAR ") &
  read_setobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  read_setobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- read_%(",c) &
  read_setobj_2(b)(c)(t)
 =>
  read_setobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- read_%",c) &
  read_setobj_2(GLOBAL ? END)(c)(t)
 =>
  read_setobj_1(GLOBAL ? END)(c)(t);

  read_setobj_1(b)(c)(t)
 =>
  read_setobj_0(b)(c)(t);



  GBIsNotRequiredOp
 =>
  f(b)(c)(t);


  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(val_,c) &
  val_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(card_,c) &
  card_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(clear_,c) &
  clear_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(add_,c) &
  add_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(del_,c) &
  del_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(member_,c) &
  member_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(search_,c) &  /*search*/
  search_obj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(union_,c) &
  union_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(inter_,c) &
  inter_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(diff_,c) &
  diff_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(mod_,c) &
  mod_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(incl_,c) &
  incl_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(valOrd_,c) &
  valOrd_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(read_,c) &
  read_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(write_,c) &
  write_setobj_0(b)(c)(t)
 =>
  setobj_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintOptSetObjOpsX IS

#define GBIposetopTac ((MAP;MODR;WRITE)~;GBIPrintOptSetObjOpsX)~

#define GBIPrintOptSetObjOps(a,b,c) \
	bcall(GBIposetopTac: opt_setobj_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  def
***/
  
  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  def_setobj_3(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" <-- def_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") = \n    %<--%_DEF_FNC_OBJ(",x,b) &
  def_setobj_3(b)(c)(t)
 =>
  def_setobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  def_setobj_2(b)(c)(t)
 =>
  def_setobj_1(b)(c)(t);

  def_setobj_1(b)(c)(t)
 =>
  def_setobj_0(b)(c)(t);

/***
  rem
***/
  
  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",G,b,F,c) &
  _bprintf("      %_KIL_SET_OBJ(%);\n",a,G) &
  _bprintf("      %_RMV_FNC_OBJ(%,%_idx)\n    END",b,F,c)
 =>
  rem_setobj_3(b)(c)(t)(F);

  GBReadTok(F) &
  GBPrintSetTok(b) &
  _bprintf(" IN\n") &
  rem_setobj_3(b)(c)(t)(F)
 =>
  rem_setobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  rem_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") = \n    VAR ") &
  rem_setobj_2(b)(c)(t)
 =>
  rem_setobj_1(b)(c)(t);

  rem_setobj_1(b)(c)(t)
 =>
  rem_setobj_0(b)(c)(t);

/***
  cre
***/
  
  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%<--%_CRE_STR_OBJ;\n",S,a) &
  _bprintf("      IF %=TRUE THEN\n        %_STO_FNC_OBJ(%,%_idx,%)\n      END;\n",x,b,F,c,S) &
  _bprintf("      %:=%\n    END",y,x)
 =>
  cre_setobj_4(b)(c)(strobj(t))(y)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%<--%_CRE_SEQ_OBJ;\n",S,a) &
  _bprintf("      IF %=TRUE THEN\n        %_STO_FNC_OBJ(%,%_idx,%)\n      END;\n",x,b,F,c,S) &
  _bprintf("      %:=%\n    END",y,x)
 =>
  cre_setobj_4(b)(c)(seqobj(t))(y)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("%<--%_CRE_SET_OBJ;\n",S,a) &
  _bprintf("      IF %=TRUE THEN\n        %_STO_FNC_OBJ(%,%_idx,%)\n      END;\n",x,b,F,c,S) &
  _bprintf("      %:=%\n    END",y,x)
 =>
  cre_setobj_4(b)(c)(setobj(t))(y)(x)(F);

  GBReadFreshVar(x) &
  GBReadTok(F) &
  _bprintf("%) =\n    VAR ",F) &
  _bprintf("%,",x) &
  GBPrintFStrTok(b) &
  _bprintf(" IN\n      %,",x) &
  cre_setobj_4(b)(c)(fstrobj(t))(y)(x)(F)
 =>
  cre_setobj_3(b)(c)(fstrobj(t))(y);

  GBReadFreshVar(x) &
  GBReadTok(F) &
  _bprintf("%) =\n    VAR ",F) &
  _bprintf("%,",x) &
  GBPrintStrTok(b) &
  _bprintf(" IN\n      %,",x) &
  cre_setobj_4(b)(c)(strobj(t))(y)(x)(F)
 =>
  cre_setobj_3(b)(c)(strobj(t))(y);

  GBReadFreshVar(x) &
  GBReadTok(F) &
  _bprintf("%) =\n    VAR ",F) &
  _bprintf("%,",x) &
  GBPrintSeqTok(b) &
  _bprintf(" IN\n      %,",x) &
  cre_setobj_4(b)(c)(seqobj(t))(y)(x)(F)
 =>
  cre_setobj_3(b)(c)(seqobj(t))(y);

  GBReadFreshVar(x) &
  GBReadTok(F) &
  _bprintf("%) =\n    VAR ",F) &
  _bprintf("%,",x) &
  GBPrintSetTok(b) &
  _bprintf(" IN\n      %,",x) &
  cre_setobj_4(b)(c)(setobj(t))(y)(x)(F)
 =>
  cre_setobj_3(b)(c)(setobj(t))(y);

  GBReadFreshVar(x) &
  _bprintf(" <-- cre_%(",c) &
  GBGetFncTok(b) &
  GBGetFreshVar(rep) &
  cre_setobj_3(b)(c)(t)(x)
 =>
  cre_setobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  cre_setobj_2(b)(c)(t)
 =>
  cre_setobj_1(b)(c)(t);

  cre_setobj_1(b)(c)(t)
 =>
  cre_setobj_0(b)(c)(t);


  GBIsNotRequiredOp
 =>
  f(b)(c)(t);

  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(cre_,c) &
  cre_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(rem_,c) &
  rem_setobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(def_,c) &
  def_setobj_0(b)(c)(t)
 =>
  opt_setobj_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintSeqObjOpsX IS

#define GBIpseqopTac ((MAP;MODR;WRITE)~;GBIPrintSeqObjOpsX)~

#define GBIPrintSeqObjOps(a,b,c) \
	bcall(GBIpseqopTac: seqobj_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  within
***/

  ReadSystemName(a) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,F,c) &
  _bprintf("      %,%<--%_MBR_SEQ_OBJ(%,%)\n    END",x,y,a,H,G)
 =>
  within_seqobj_7(b)(c)(t)(x)(y)(F)(G)(H);

  ReadSystemName(a) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",H,a,c) &
  _bprintf("      %,%<--%_MBR_SEQ_OBJ(%,%)\n    END",x,y,a,H,G)
 =>
  within_seqobj_7(GLOBAL ? END)(c)(t)(x)(y)(F)(G)(H);

  GBReadTok(H) &
  _bprintf(" IN\n") &
  within_seqobj_7(b)(c)(t)(x)(y)(F)(G)(H)
 =>
  within_seqobj_6(b)(c)(t)(x)(y)(F)(G);

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("    VAR ") &
  GBPrintSeqTok(a) &
  within_seqobj_6(b)(c)(t)(x)(y)(F)(G)
 =>
  within_seqobj_5(b)(c)(t)(x)(y)(F);

  ReadSystemName(a) &
  GBReadFreshVar(G) &
  _bprintf("    VAR ") &
  GBPrintSeqTok(a) &
  within_seqobj_6(b)(c)(seqobj(NAT))(x)(y)(F)(G)
 =>
  within_seqobj_5(b)(c)(seqobj(NAT))(x)(y)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n") &
  within_seqobj_5(b)(c)(seqobj(t))(x)(y)(F)
 =>
  within_seqobj_4(b)(c)(seqobj(t))(x)(y);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n") &
  within_seqobj_5(b)(c)(seqobj(NAT))(x)(y)(F)
 =>
  within_seqobj_4(b)(c)(seqobj(NAT))(x)(y);

  GBReadFreshVar(y) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  within_seqobj_4(b)(c)(t)(x)(y)
 =>
  within_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(y) &
  within_seqobj_4(GLOBAL ? END)(c)(t)(x)(y)
 =>
  within_seqobj_3(GLOBAL ? END)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFreshVar(ii) &
  _bprintf(" <-- within_%(",c) &
  within_seqobj_3(b)(c)(t)(x)
 =>
  within_seqobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  within_seqobj_2(b)(c)(t)
 =>
  within_seqobj_1(b)(c)(t);

  within_seqobj_1(b)(c)(t)
 =>
  within_seqobj_0(b)(c)(t);

/***
  search
***/

  setDEFSFlag &
  Read_invarReqd(I) &
  Modify_invarReqd((I,e)) &
/***
HERE(("setDEFSFlag":3:(I,e)))&
***/
  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,B,c) &
  _bprintf("      %<--%_LEN_SEQ_OBJ(%);\n",l,a,H) &
  _bprintf("        WHILE %/=0 & %=FALSE DO\n",l,f) &
  _bprintf("          %<--%_VAL_SEQ_OBJ(%,%);\n",G,a,H,l) &
  _bprintf("          check_%(%,%,%);\n",e,G,S,f) &
  _bprintf("          %:=%-1\n",l,l) &
  _bprintf("        VARIANT %\n",l) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: BOOL & %: 0..card(%) &\n",f,l,c) &
  _bprintf("          invar_%(%,ran(%(%)),%,%)\n        END;\n",e,f,c,B,G,S) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G) 
 =>
  search_obj_9(b)(c)(seqobj(e))(x)(F)(B)(S)(l)(G)(f);

  setDEFSFlag &
  Read_invarReqd(I) &       /* added Sept 1999 */
  Modify_invarReqd((I,e)) & /* added Sept 1999 */
/***
HERE(("setDEFSFlag":4:(I,e)))&
***/
  Read_invarReqd(I) &
  Modify_invarReqd((I,e)) &
  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",H,a,c) &
  _bprintf("      %<--%_LEN_SEQ_OBJ(%);\n",l,a,H) &
  _bprintf("        WHILE %/=0 & %=FALSE DO\n",l,f) &
  _bprintf("          %<--%_VAL_SEQ_OBJ(%,%);\n",G,a,H,l) &
  _bprintf("          check_%(%,%,%);\n",e,G,S,f) &
  _bprintf("          %:=%-1\n",l,l) &
  _bprintf("        VARIANT %\n",l) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: BOOL & %: 0..card(%) &\n",f,l,c) &
  _bprintf("          invar_%(%,ran(%),%,%)\n        END;\n",e,f,c,G,S) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G) 
 =>
  search_obj_9(GLOBAL ? END)(c)(seqobj(e))(x)(F)(B)(S)(l)(G)(f);

  ReadSystemName(a) &
  GBReadFreshVar(f) &
  _bprintf(",") &
  GBPrintSeqTok(a) &
  _bprintf(" IN\n") &
  search_obj_9(b)(c)(s(e))(x)(F)(B)(S)(l)(G)(f)
 =>
  search_obj_8(b)(c)(s(e))(x)(F)(B)(S)(l)(G);

  GBReadTok(G) &
  _bprintf(",") &
  GBPrintFreshVar(found) &
  search_obj_8(b)(c)(t)(x)(F)(B)(S)(l)(G)
 =>
  search_obj_7(b)(c)(t)(x)(F)(B)(S)(l);
  GBReadFreshVar(l) &
  _bprintf(",") &
  GBPrintFncTok(e) &
  search_obj_7(b)(c)(s(e))(x)(F)(B)(S)(l)
 =>
  search_obj_6(b)(c)(s(e))(x)(F)(B)(S);


  GBReadFreshVar(S) &
  GBPrintFreshVar(loc) &
  search_obj_6(b)(c)(t)(x)(F)(B)(S)
 =>
  search_obj_5(b)(c)(t)(x)(F)(B);

  GBReadTok(B) &
  GBPrintFreshVar(cc) &
  _bprintf(") =\n    VAR ") &
  search_obj_5(b)(c)(t)(x)(F)(B)
 =>
  search_obj_4(b)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  search_obj_4(b)(c)(t)(x)(F)
 =>
  search_obj_3(b)(c)(t)(x);

  GBReadTok(F) &
  search_obj_4(GLOBAL ? END)(c)(t)(x)(F)
 =>
  search_obj_3(GLOBAL ? END)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(e) &
  _bprintf(" <-- search_%(",c) &
  search_obj_3(b)(c)(s(e))(x)
 =>
  search_obj_2(b)(c)(s(e));  

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  search_obj_2(b)(c)(t)
 =>
  search_obj_1(b)(c)(t);

  search_obj_0(b)(c)(t);

  ReadBaseNames(B) &
  bsearch(e,B,C) &
  search_obj_1(b)(c)(seqobj(e))
 =>
  search_obj_0(b)(c)(seqobj(e));



/***
  eql
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  _bprintf("      %<--%_EQL_SEQ_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  eql_seqobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  _bprintf("      %<--%_EQL_SEQ_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  eql_seqobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  eql_seqobj_4(b)(c)(t)(x)(F)
 =>
  eql_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  eql_seqobj_3(b)(c)(t)(x)
 =>
  eql_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  eql_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  eql_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%(",c) &
  eql_seqobj_2(b)(c)(t)
 =>
  eql_seqobj_1(b)(c)(t);

  eql_seqobj_1(b)(c)(t)
 =>
  eql_seqobj_0(b)(c)(t);

/***
  conc
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  _bprintf("      %<--%_APP_SEQ_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  conc_seqobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  _bprintf("      %<--%_APP_SEQ_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  conc_seqobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  conc_seqobj_4(b)(c)(t)(x)(F)
 =>
  conc_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  conc_seqobj_3(b)(c)(t)(x)
 =>
  conc_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  conc_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  conc_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- conc_%(",c) &
  conc_seqobj_2(b)(c)(t)
 =>
  conc_seqobj_1(b)(c)(t);

  conc_seqobj_1(b)(c)(t)
 =>
  conc_seqobj_0(b)(c)(t);

/***
  mod
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n      %<--%_CPY_SEQ_OBJ(%,%_0)\n    END",S,S,b,F,c,x,a,S,S)
 =>
  mod_seqobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n      %<--%_CPY_SEQ_OBJ(%,%_0)\n    END",S,S,a,c,x,a,S,S)
 =>
  mod_seqobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  mod_seqobj_4(b)(c)(t)(x)(F)
 =>
  mod_seqobj_3(b)(c)(t)(x);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  mod_seqobj_4(GLOBAL ? END)(c)(t)(x)(F)
 =>
  mod_seqobj_3(GLOBAL ? END)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  mod_seqobj_3(b)(c)(t)(x)
 =>
  mod_seqobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- mod_%(",c) &
  mod_seqobj_2(b)(c)(t)
 =>
  mod_seqobj_1(b)(c)(t);

  GBReadFreshVar(x) &
  mod_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  mod_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- mod_%(",c) &
  mod_seqobj_2(GLOBAL ? END)(c)(t)
 =>
  mod_seqobj_1(GLOBAL ? END)(c)(t);

  mod_seqobj_1(b)(c)(t)
 =>
  mod_seqobj_0(b)(c)(t);

/***
  push
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_PSH_SEQ_OBJ(%,%)\n    END",x,a,S,K)
 =>
  push_seqobj_5(b)(c)(t)(x)(F)(K);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_PSH_SEQ_OBJ(%,%)\n    END",x,a,S,K)
 =>
  push_seqobj_5(GLOBAL ? END)(c)(t)(x)(F)(K);

  ReadSystemName(a) &
  GBReadTok(K) &
  GBPrintSeqTok(a) &
  push_seqobj_5(b)(c)(t)(x)(F)(K)
 =>
  push_seqobj_4(b)(c)(t)(x)(F);

  GBReadFreshVar(K) &
  GBPrintSeqTok(a) &
  push_seqobj_5(b)(c)(seqobj(NAT))(x)(F)(K)
 =>
  push_seqobj_4(b)(c)(seqobj(NAT))(x)(F);

  GBReadFreshVar(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n    VAR ") &
  push_seqobj_4(b)(c)(seqobj(t))(x)(F)
 =>
  push_seqobj_3(b)(c)(seqobj(t))(x);

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    VAR ") &
  push_seqobj_4(b)(c)(seqobj(NAT))(x)(F)
 =>
  push_seqobj_3(b)(c)(seqobj(NAT))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  push_seqobj_3(b)(c)(t)(x)
 =>
  push_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  push_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  push_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- push_%(",c) &
  push_seqobj_2(b)(c)(t)
 =>
  push_seqobj_1(b)(c)(t);

  push_seqobj_1(b)(c)(t)
 =>
  push_seqobj_0(b)(c)(t);

/***
  pop
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_POP_SEQ_OBJ(%)\n    END",a,S)
 =>
  pop_seqobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_POP_SEQ_OBJ(%)\n    END",a,S)
 =>
  pop_seqobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  _bprintf("% IN\n") &
  pop_seqobj_4(b)(c)(t)(F)
 =>
  pop_seqobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  pop_seqobj_3(b)(c)(t)
 =>
  pop_seqobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  pop_seqobj_3(GLOBAL ? END)(c)(t)
 =>
  pop_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  pop_%(",c) &
  pop_seqobj_2(b)(c)(t)
 =>
  pop_seqobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  pop_%",c) &
  pop_seqobj_2(GLOBAL ? END)(c)(t)
 =>
  pop_seqobj_1(GLOBAL ? END)(c)(t);

  pop_seqobj_1(b)(c)(t)
 =>
  pop_seqobj_0(b)(c)(t);

/***
  modIth
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_STO_SEQ_OBJ(%,%,%)\n    END",a,S,y,K)
 =>
  modIth_seqobj_7(b)(c)(t)(F)(y)(K);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_STO_SEQ_OBJ(%,%,%)\n    END",a,S,y,K)
 =>
  modIth_seqobj_7(GLOBAL ? END)(c)(t)(F)(y)(K);

  ReadSystemName(a) &
  GBPrintSeqTok(a) &
  modIth_seqobj_7(b)(c)(t)(F)(y)(K)
 =>
  modIth_seqobj_6(b)(c)(t)(F)(y)(K);

  GBReadTok(K) &
  modIth_seqobj_6(b)(c)(t)(F)(y)(K)
 =>
  modIth_seqobj_5(b)(c)(t)(F)(y);

  GBReadFreshVar(K) &
  modIth_seqobj_6(b)(c)(seqobj(NAT))(F)(y)(K)
 =>
  modIth_seqobj_5(b)(c)(seqobj(NAT))(F)(y);

  GBReadFreshVar(y) &
  GBPrintMbr(t) &
  _bprintf(") =\n    VAR ") &
  modIth_seqobj_5(b)(c)(seqobj(t))(F)(y)
 =>
  modIth_seqobj_4(b)(c)(seqobj(t))(F);

  GBReadFreshVar(y) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    VAR ") &
  modIth_seqobj_5(b)(c)(seqobj(NAT))(F)(y)
 =>
  modIth_seqobj_4(b)(c)(seqobj(NAT))(F);

  GBReadTok(F) &
  GBPrintFreshVar(ii) &
  _bprintf(",") &
  modIth_seqobj_4(b)(c)(t)(F)
 =>
  modIth_seqobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(",") &
  modIth_seqobj_3(b)(c)(t)
 =>
  modIth_seqobj_2(b)(c)(t);

  modIth_seqobj_3(GLOBAL ? END)(c)(t)
 =>
  modIth_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("modIth_%(",c) &
  modIth_seqobj_2(b)(c)(t)
 =>
  modIth_seqobj_1(b)(c)(t);

  modIth_seqobj_1(b)(c)(t)
 =>
  modIth_seqobj_0(b)(c)(t);

/***
  delIth
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(",%_0 IN\n",S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %,%_0<--%_CRE_SEQ_OBJ;\n",z,S,a) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_CPY_SEQ_OBJ(%,%_0)\n      END;\n",z,z,a,S,S) &
  _bprintf("      IF %=TRUE THEN\n        %_CUT_SEQ_OBJ(%_0,%);\n",z,a,S,y)
&
  _bprintf("        %_KEP_SEQ_OBJ(%,%-1);\n",a,S,y) &
  _bprintf("        %<--%_APP_SEQ_OBJ(%,%_0)\n      END;\n",z,a,S,S) &
  _bprintf("      %_KIL_SEQ_OBJ(%_0);\n",a,S) &
  _bprintf("      %:=%\n    END",x,z)
 =>
  delIth_seqobj_6(b)(c)(t)(x)(F)(y)(z);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(",%_0 IN\n",S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %,%_0<--%_CRE_SEQ_OBJ;\n",z,S,a) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_CPY_SEQ_OBJ(%,%_0)\n      END;\n",z,z,a,S,S) &
  _bprintf("      IF %=TRUE THEN\n        %_CUT_SEQ_OBJ(%_0,%);\n",z,a,S,y)
&
  _bprintf("        %_KEP_SEQ_OBJ(%,%-1);\n",a,S,y) &
  _bprintf("        %<--%_APP_SEQ_OBJ(%,%_0)\n      END;\n",z,a,S,S) &
  _bprintf("      %_KIL_SEQ_OBJ(%_0);\n",a,S) &
  _bprintf("      %:=%\n    END",x,z)
 =>
  delIth_seqobj_6(GLOBAL ? END)(c)(t)(x)(F)(y)(z);

  ReadSystemName(a) &
  GBReadFreshVar(z) &
  GBPrintSeqTok(a) &
  delIth_seqobj_6(b)(c)(t)(x)(F)(y)(z)
 =>
  delIth_seqobj_5(b)(c)(t)(x)(F)(y);

  GBReadFreshVar(y) &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  delIth_seqobj_5(b)(c)(t)(x)(F)(y)
 =>
  delIth_seqobj_4(b)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFreshVar(ii) &
  _bprintf(") =\n    VAR ") &
  delIth_seqobj_4(b)(c)(t)(x)(F)
 =>
  delIth_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  delIth_seqobj_3(b)(c)(t)(x)
 =>
  delIth_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  delIth_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  delIth_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- delIth_%(",c) &
  delIth_seqobj_2(b)(c)(t)
 =>
  delIth_seqobj_1(b)(c)(t);

  delIth_seqobj_1(b)(c)(t)
 =>
  delIth_seqobj_0(b)(c)(t);

/***
  insIth
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(",%_0 IN\n",S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %,%_0<--%_CRE_SEQ_OBJ;\n",z,S,a) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_CPY_SEQ_OBJ(%,%_0)\n      END;\n",z,z,a,S,S) &
  _bprintf("      IF %=TRUE THEN\n        %_CUT_SEQ_OBJ(%_0,%-1);\n",z,a,S,y
) &
  _bprintf("        %_KEP_SEQ_OBJ(%,%-1);\n",a,S,y) &
  _bprintf("        %<--%_PSH_SEQ_OBJ(%,%)\n      END;\n",z,a,S,K) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_APP_SEQ_OBJ(%,%_0)\n      END;\n",z,z,a,S,S) &
  _bprintf("      %_KIL_SEQ_OBJ(%_0);\n",a,S) &
  _bprintf("      %:=%\n    END",x,z)
 =>
  insIth_seqobj_7(b)(c)(t)(x)(F)(y)(K)(z);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(",%_0 IN\n",S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %,%_0<--%_CRE_SEQ_OBJ;\n",z,S,a) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_CPY_SEQ_OBJ(%,%_0)\n      END;\n",z,z,a,S,S) &
  _bprintf("      IF %=TRUE THEN\n        %_CUT_SEQ_OBJ(%_0,%-1);\n",z,a,S,y
) &
  _bprintf("        %_KEP_SEQ_OBJ(%,%-1);\n",a,S,y) &
  _bprintf("        %<--%_PSH_SEQ_OBJ(%,%)\n      END;\n",z,a,S,K) &
  _bprintf("      IF %=TRUE THEN\n        %<--%_APP_SEQ_OBJ(%,%_0)\n      END;\n",z,z,a,S,S) &
  _bprintf("      %_KIL_SEQ_OBJ(%_0);\n",a,S) &
  _bprintf("      %:=%\n    END",x,z)
 =>
  insIth_seqobj_7(GLOBAL ? END)(c)(t)(x)(F)(y)(K)(z);

  ReadSystemName(a) &
  GBReadFreshVar(z) &
  GBPrintSeqTok(a) &
  insIth_seqobj_7(b)(c)(t)(x)(F)(y)(K)(z)
 =>
  insIth_seqobj_6(b)(c)(t)(x)(F)(y)(K);

  GBReadTok(K) &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  insIth_seqobj_6(b)(c)(t)(x)(F)(y)(K)
 =>
  insIth_seqobj_5(b)(c)(t)(x)(F)(y);

  GBReadFreshVar(K) &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  insIth_seqobj_6(b)(c)(seqobj(NAT))(x)(F)(y)(K)
 =>
  insIth_seqobj_5(b)(c)(seqobj(NAT))(x)(F)(y);

  GBReadFreshVar(y) &
  GBPrintMbr(t) &
  _bprintf(") =\n    VAR ") &
  insIth_seqobj_5(b)(c)(seqobj(t))(x)(F)(y)
 =>
  insIth_seqobj_4(b)(c)(seqobj(t))(x)(F);

  GBReadFreshVar(y) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    VAR ") &
  insIth_seqobj_5(b)(c)(seqobj(NAT))(x)(F)(y)
 =>
  insIth_seqobj_4(b)(c)(seqobj(NAT))(x)(F);

  GBReadTok(F) &
  GBPrintFreshVar(ii) &
  _bprintf(",") &
  insIth_seqobj_4(b)(c)(t)(x)(F)
 =>
  insIth_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  insIth_seqobj_3(b)(c)(t)(x)
 =>
  insIth_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  insIth_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  insIth_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- insIth_%(",c) &
  insIth_seqobj_2(b)(c)(t)
 =>
  insIth_seqobj_1(b)(c)(t);

  insIth_seqobj_1(b)(c)(t)
 =>
  insIth_seqobj_0(b)(c)(t);

/***
  valIth
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_VAL_SEQ_OBJ(%,%)\n    END",M,a,S,x)
 =>
  valIth_seqobj_5(b)(c)(t)(M)(F)(x);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_VAL_SEQ_OBJ(%,%)\n    END",M,a,S,x)
 =>
  valIth_seqobj_5(GLOBAL ? END)(c)(t)(M)(F)(x);

  ReadSystemName(a) &
  GBReadFreshVar(x) &
  GBPrintSeqTok(a) &
  valIth_seqobj_5(b)(c)(t)(M)(F)(x)
 =>
  valIth_seqobj_4(b)(c)(t)(M)(F);

  GBReadTok(F) &
  GBPrintFreshVar(ii) &
  _bprintf(") =\n    VAR ") &
  valIth_seqobj_4(b)(c)(t)(M)(F)
 =>
  valIth_seqobj_3(b)(c)(t)(M);

  GBReadTok(M) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  valIth_seqobj_3(b)(c)(t)(M)
 =>
  valIth_seqobj_2(b)(c)(t);

  GBReadTok(M) &
  valIth_seqobj_3(GLOBAL ? END)(c)(t)(M)
 =>
  valIth_seqobj_2(GLOBAL ? END)(c)(t);

  GBReadFreshVar(M) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  valIth_seqobj_3(b)(c)(seqobj(NAT))(M)
 =>
  valIth_seqobj_2(b)(c)(seqobj(NAT));

  GBReadFreshVar(M) &
  valIth_seqobj_3(GLOBAL ? END)(c)(seqobj(NAT))(M)
 =>
  valIth_seqobj_2(GLOBAL ? END)(c)(seqobj(NAT));

  GBOpSC &
  _bprintf("  ") &
  GBPrintMbr(t) &
  _bprintf(" <-- valIth_%(",c) &
  valIth_seqobj_2(b)(c)(seqobj(t))
 =>
  valIth_seqobj_1(b)(c)(seqobj(t));

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nat) &
  _bprintf(" <-- valIth_%(",c) &
  valIth_seqobj_2(b)(c)(seqobj(NAT))
 =>
  valIth_seqobj_1(b)(c)(seqobj(NAT));

  valIth_seqobj_1(b)(c)(t)
 =>
  valIth_seqobj_0(b)(c)(t);

/***
  last
***/

  ReadSystemName(a) &
  GBReadFreshVar(x) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_LEN_SEQ_OBJ(%);\n",x,a,S) &
  _bprintf("      %<--%_VAL_SEQ_OBJ(%,%)\n    END",M,a,S,x)
 =>
  last_seqobj_5(b)(c)(t)(M)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(x) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_LEN_SEQ_OBJ(%);\n",x,a,S) &
  _bprintf("      %<--%_VAL_SEQ_OBJ(%,%)\n    END",M,a,S,x)
 =>
  last_seqobj_5(GLOBAL ? END)(c)(t)(M)(F)(S);

  GBReadTok(S) &
  GBPrintFreshVar(len) &
  last_seqobj_5(b)(c)(t)(M)(F)(S)
 =>
  last_seqobj_4(b)(c)(t)(M)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  _bprintf(",") &
  last_seqobj_4(b)(c)(t)(M)(F)
 =>
  last_seqobj_3(b)(c)(t)(M);

  GBReadTok(M) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  last_seqobj_3(b)(c)(t)(M)
 =>
  last_seqobj_2(b)(c)(t);

  GBReadTok(M) &
  _bprintf(" =\n    VAR ") &
  last_seqobj_3(GLOBAL ? END)(c)(t)(M)
 =>
  last_seqobj_2(GLOBAL ? END)(c)(t);

  GBReadFreshVar(M) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  last_seqobj_3(b)(c)(seqobj(NAT))(M)
 =>
  last_seqobj_2(b)(c)(seqobj(NAT));

  GBReadFreshVar(M) &
  _bprintf(" =\n    VAR ") &
  last_seqobj_3(GLOBAL ? END)(c)(seqobj(NAT))(M)
 =>
  last_seqobj_2(GLOBAL ? END)(c)(seqobj(NAT));

  GBOpSC &
  _bprintf("  ") &
  GBPrintMbr(t) &
  _bprintf(" <-- last_%(",c) &
  last_seqobj_2(b)(c)(seqobj(t))
 =>
  last_seqobj_1(b)(c)(seqobj(t));

  GBOpSC &
  _bprintf("  ") &
  GBPrintMbr(t) &
  _bprintf(" <-- last_%",c) &
  last_seqobj_2(GLOBAL ? END)(c)(seqobj(t))
 =>
  last_seqobj_1(GLOBAL ? END)(c)(seqobj(t));

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nat) &
  _bprintf(" <-- last_%(",c) &
  last_seqobj_2(b)(c)(seqobj(NAT))
 =>
  last_seqobj_1(b)(c)(seqobj(NAT));

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nat) &
  _bprintf(" <-- last_%",c) &
  last_seqobj_2(GLOBAL ? END)(c)(seqobj(NAT))
 =>
  last_seqobj_1(GLOBAL ? END)(c)(seqobj(NAT));

  last_seqobj_1(b)(c)(t)
 =>
  last_seqobj_0(b)(c)(t);

/***
  clear
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_CLR_SEQ_OBJ(%)\n    END",a,S)
 =>
  clear_seqobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_CLR_SEQ_OBJ(%)\n    END",a,S)
 =>
  clear_seqobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  _bprintf("% IN\n") &
  clear_seqobj_4(b)(c)(t)(F)
 =>
  clear_seqobj_3(b)(c)(t);

  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  clear_seqobj_3(b)(c)(t)
 =>
  clear_seqobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  clear_seqobj_3(GLOBAL ? END)(c)(t)
 =>
  clear_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("clear_%",c) &
  clear_seqobj_2(b)(c)(t)
 =>
  clear_seqobj_1(b)(c)(t);

  clear_seqobj_1(b)(c)(t)
 =>
  clear_seqobj_0(b)(c)(t);

/***
  length
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_LEN_SEQ_OBJ(%)\n    END",x,a,S)
 =>
  length_seqobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_LEN_SEQ_OBJ(%)\n    END",x,a,S)
 =>
  length_seqobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  _bprintf("% IN\n") &
  length_seqobj_4(b)(c)(t)(x)(F)
 =>
  length_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  length_seqobj_3(b)(c)(t)(x)
 =>
  length_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" =\n    VAR ") &
  length_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  length_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nbr) &
  _bprintf(" <-- length_%",c) &
  length_seqobj_2(b)(c)(t)
 =>
  length_seqobj_1(b)(c)(t);

  length_seqobj_1(b)(c)(t)
 =>
  length_seqobj_0(b)(c)(t);

/***
  val
***/

  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  val_seqobj_3(b)(c)(t);

  GBReadTok(F) &
  _bprintf("%_idx)",c)
 =>
  val_seqobj_3(GLOBAL ? END)(c)(t);

  GBReadTok(S) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_VAL_FNC_OBJ(",S,b) &
  val_seqobj_3(b)(c)(t)
 =>
  val_seqobj_2(b)(c)(t);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" =\n    %<--%_VAL_FNC(",S,a) &
  val_seqobj_3(GLOBAL ? END)(c)(t)
 =>
  val_seqobj_2(GLOBAL ? END)(c)(t);

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintSeqTok(a) &
  _bprintf(" <-- val_%",c) &
  val_seqobj_2(b)(c)(t)
 =>
  val_seqobj_1(b)(c)(t);

  val_seqobj_1(b)(c)(t)
 =>
  val_seqobj_0(b)(c)(t);


/***
  write
***/

  _bprintf("      %_OUTPUT_SEQ_OBJ(%,%)\n    END",a,t,S)
 =>
  write_seqobj_5(a)(t)(S);

  ReadBaseNames(B) &
  bsearch(t,B,C) &
  _bprintf("      %_OUTPUT_SEQ_OBJ(%_ABSOBJ,%)\n    END",a,t,S)
 =>
  write_seqobj_5(a)(t)(S);
 
  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  write_seqobj_5(a)(t)(S)
 =>
  write_seqobj_4(b)(c)(seqobj(t))(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  write_seqobj_5(a)(t)(S)
 =>
  write_seqobj_4(GLOBAL ? END)(c)(seqobj(t))(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  _bprintf("% IN\n") &
  write_seqobj_4(b)(c)(t)(F)
 =>
  write_seqobj_3(b)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  write_seqobj_3(b)(c)(t)
 =>
  write_seqobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  write_seqobj_3(GLOBAL ? END)(c)(t)
 =>
  write_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("write_%(",c) &
  write_seqobj_2(b)(c)(t)
 =>
  write_seqobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("write_%",c) &
  write_seqobj_2(GLOBAL ? END)(c)(t)
 =>
  write_seqobj_1(GLOBAL ? END)(c)(t);

  write_seqobj_1(b)(c)(t)
 =>
  write_seqobj_0(b)(c)(t);

/***
  read
***/

  _bprintf("      %<--%_INPUT_SEQ_OBJ(%,%,%)\n    END",x,a,t,S,y) 
 =>
  read_seqobj_6(x)(a)(t)(S)(y);

  ReadBaseNames(B) &
  bsearch(t,(B),C) &
  _bprintf("      %<--%_INPUT_SEQ_OBJ(%_ABSOBJ,%,%)\n    END",x,a,t,S,y) 
 =>
  read_seqobj_6(x)(a)(t)(S)(y);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--GET_PROMPT_NAT(\"Number of element to be read: \");\n",y) &
  read_seqobj_6(x)(a)(t)(S)(y)
 =>
  read_seqobj_5(b)(c)(seqobj(t))(x)(y)(F);

  ReadSystemName(a) &
  GBReadTok(S) & 
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--GET_PROMPT_NAT(\"Number of element to be read: \");\n",y) &
  read_seqobj_6(x)(a)(t)(S)(y)
 =>
  read_seqobj_5(GLOBAL ? END)(c)(seqobj(t))(x)(y)(F);

  GBReadFreshVar(y) &
  read_seqobj_5(b)(c)(t)(x)(y)(F)
 =>
  read_seqobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintSeqTok(a) &
  _bprintf(",") &
  GBPrintFreshVar(ll) &
  _bprintf(" IN\n") &  
  read_seqobj_4(b)(c)(t)(x)(F)
 =>
  read_seqobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  read_seqobj_3(b)(c)(t)(x)
 =>
  read_seqobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" =\n    VAR ") &
  read_seqobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  read_seqobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- read_%(",c) &
  read_seqobj_2(b)(c)(t)
 =>
  read_seqobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- read_%",c) &
  read_seqobj_2(GLOBAL ? END)(c)(t)
 =>
  read_seqobj_1(GLOBAL ? END)(c)(t);

  read_seqobj_1(b)(c)(t)
 =>
  read_seqobj_0(b)(c)(t);


  GBIsNotRequiredOp
 =>
  f(b)(c)(t);


  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(val_,c) &
  val_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(length_,c) &
  length_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(clear_,c) &
  clear_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(last_,c) &
  last_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(valIth_,c) &
  valIth_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(insIth_,c) &
  insIth_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(delIth_,c) &
  delIth_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(modIth_,c) &
  modIth_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(pop_,c) &
  pop_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(push_,c) &
  push_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(mod_,c) &
  mod_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(conc_,c) &
  conc_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(within_,c) &
  within_seqobj_0(b)(c)(t)&
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(search_,c) &
  search_obj_0(b)(c)(t)&
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(write_,c) &
  write_seqobj_0(b)(c)(t)&
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(read_,c) &
  read_seqobj_0(b)(c)(t)
 =>
  seqobj_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintOptSeqObjOpsX IS

#define GBIposeqopTac ((MAP;MODR;WRITE)~;GBIPrintOptSeqObjOpsX)~

#define GBIPrintOptSeqObjOps(a,b,c) \
	bcall(GBIposeqopTac: opt_seqobj_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  rem
***/
  
  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",G,b,F,c) &
  _bprintf("      %_KIL_SEQ_OBJ(%);\n",a,G) &
  _bprintf("      %_RMV_FNC_OBJ(%,%_idx)\n    END",b,F,c)
 =>
  rem_seqobj_3(b)(c)(t)(F);

  GBReadTok(F) &
  GBPrintSeqTok(b) &
  _bprintf(" IN\n") &
  rem_seqobj_3(b)(c)(t)(F)
 =>
  rem_seqobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  rem_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") = \n    VAR ") &
  rem_seqobj_2(b)(c)(t)
 =>
  rem_seqobj_1(b)(c)(t);

  rem_seqobj_1(b)(c)(t)
 =>
  rem_seqobj_0(b)(c)(t);

/***
  def
***/
  
  bcall(GBIposetopTac: def_setobj_0(b)(c)(t))
 =>
  def_seqobj_0(b)(c)(t);

/***
  cre
***/
  
  bcall(GBIposetopTac: cre_setobj_0(b)(c)(t))
 =>
  cre_seqobj_0(b)(c)(t);


  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(cre_,c) &
  cre_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(rem_,c) &
  rem_seqobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(def_,c) &
  def_seqobj_0(b)(c)(t)
 =>
  opt_seqobj_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintFStrObjOpsX IS

#define GBIpfstropTac ((MAP;MODR;WRITE)~;GBIPrintFStrObjOpsX)~

#define GBIPrintFStrObjOps(a,b,c) \
	bcall(GBIpfstropTac: fstrobj_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  key_search
***/

  ReadSystemName(a) &
  GBReadFreshVar(k) &
  _bprintf(".(%:%..card(%_fnctok) => (\n",k,l,b) &
  _bprintf("             not(%_UnPack(((%_idx..%_idx+%_len)<|%_fncstruct(%_locate(%))))=%))\n",b,c,c,c,b,b,k,S) &
  _bprintf("             )) &\n") &
  _bprintf("          (%=TRUE => (\n            (%_UnPack(((%_idx..%_idx+%_len)<|%_fncstruct(%_locate(%))))=%))\n            )\n",f,b,c,c,c,b,b,l,S) &
  _bprintf("        VARIANT\n          %\n        END\n      END;\n",l) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G)
 =>
  key_search_fstrobj_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H);

  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %,%<--%_FIRST_FNC_OBJ;\n",l,G,b) &
  _bprintf("      IF %/=0 THEN\n",l) &
  _bprintf("        %<--%_EQL_FFNC_OBJ(%,%_idx,%_len,%);\n",f,b,G,c,c,S) &
  _bprintf("        WHILE %/=1 & %=FALSE DO\n",l,f) &
  _bprintf("          %,%<--%_NEXT_FNC_OBJ(%,%);\n",l,G,b,l,G) &
  _bprintf("          %<--%_EQL_FFNC_OBJ(%,%_idx,%_len,%)\n",f,b,G,c,c,S) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: dom(%) &\n",G,c) &
  _bprintf("          % = %_locate(%) &\n",G,b,l) &
  _bprintf("          %: 1..card(%_fnctok) &\n",l,b) &
  _bprintf("          %_idx: dom(%_fncstruct(%_locate(%))) &\n",c,b,b,l) &
  _bprintf("          (found=FALSE => !") &
  GBPrintFreshVar(ii) &
  key_search_fstrobj_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H)
 =>
  key_search_fstrobj_8(b)(c)(t)(x)(F)(S)(l)(G)(f);

  GBReadFreshVar(f) &
  _bprintf(" IN\n") &
  key_search_fstrobj_8(b)(c)(t)(x)(F)(S)(l)(G)(f)
 =>
  key_search_fstrobj_7(b)(c)(t)(x)(F)(S)(l)(G);

  GBReadTok(G) &
  _bprintf(",") &
  GBPrintFreshVar(found) &
  key_search_fstrobj_7(b)(c)(t)(x)(F)(S)(l)(G)
 =>
  key_search_fstrobj_6(b)(c)(t)(x)(F)(S)(l);

  GBReadFreshVar(l) &
  _bprintf(",") &
  GBPrintFncTok(b) &
  key_search_fstrobj_6(b)(c)(t)(x)(F)(S)(l)
 =>
  key_search_fstrobj_5(b)(c)(t)(x)(F)(S);

  GBReadTok(S) &
  _bprintf(") =\n    VAR ") &
  GBPrintFreshVar(loc) &
  key_search_fstrobj_5(b)(c)(t)(x)(F)(S)
 =>
  key_search_fstrobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFStrTok(a) &
  key_search_fstrobj_4(b)(c)(t)(x)(F)
 =>
  key_search_fstrobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- key_search_%(",c) &
  key_search_fstrobj_3(b)(c)(t)(x)
 =>
  key_search_fstrobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  key_search_fstrobj_2(b)(c)(t)
 =>
  key_search_fstrobj_1(b)(c)(t);

  key_search_fstrobj_1(b)(c)(t)
 =>
  key_search_fstrobj_0(b)(c)(t);

  key_search_fstrobj_0(GLOBAL ? END)(c)(t);


/***
  eql_mand_mand
***/

  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n",y,B,F,i,i) &
  _bprintf("      %<--%_EQL_FFNC_OBJ(%,%_idx,%_len,%)\n    END",x,b,S,c,c,y)
 =>
  eql_mand_mand_fstrobj_4(b)(c)(t)(c)(B(i))(x)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n",y,B,F,i,i) &
  _bprintf("      %<--%_EQL_FFNC(%_idx,%_len,%)\n    END",x,a,c,c,y)
 =>
  eql_mand_mand_fstrobj_4(GLOBAL ? END)(c)(t)(c)(B(i))(x)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC(%_idx,%_len);\n",y,a,i,i) &
  _bprintf("      %<--%_EQL_FFNC_OBJ(%,%_idx,%_len,%)\n    END",x,b,S,c,c,y)
 =>
  eql_mand_mand_fstrobj_4(b)(c)(t)(c)((GLOBAL ? END)(i))(x)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC(%_idx,%_len);\n",y,a,i,i) &
  _bprintf("      %<--%_EQL_FFNC(%_idx,%_len,%)\n    END",x,a,c,c,y)
 =>
  eql_mand_mand_fstrobj_4((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i))(x)(F)(S);

  GBReadTok(S) &
  _bprintf(") =\n    VAR ") &
  GBPrintFreshVar(Addr) &
  _bprintf(" IN\n") &
  eql_mand_mand_fstrobj_4(b)(c)(t)(c)(B(i))(x)(F)(S)
 =>
  eql_mand_mand_fstrobj_3(b)(c)(t)(c)(B(i))(x)(F);

  GBReadTok(S) &
  _bprintf(" =\n    VAR ") &
  GBPrintFreshVar(Addr) &
  _bprintf(" IN\n") &
  eql_mand_mand_fstrobj_4((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i))(x)(F)(S)
 =>
  eql_mand_mand_fstrobj_3((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i))(x)(F);

  GBReadTok(F) &
  _bprintf(",") &
  GBPrintFncTok(b) &
  eql_mand_mand_fstrobj_3(b)(c)(t)(c)(B(i))(x)(F)
 =>
  eql_mand_mand_fstrobj_2(b)(c)(t)(c)(B(i))(x);

  GBReadTok(F) &
  GBPrintFncTok(b) &
  eql_mand_mand_fstrobj_3(b)(c)(t)(c)((GLOBAL ? END)(i))(x)(F)
 =>
  eql_mand_mand_fstrobj_2(b)(c)(t)(c)((GLOBAL ? END)(i))(x);

  GBReadTok(F) &
  eql_mand_mand_fstrobj_3(GLOBAL ? END)(c)(t)(c)(B(i))(x)(F)
 =>
  eql_mand_mand_fstrobj_2(GLOBAL ? END)(c)(t)(c)(B(i))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(B) &
  eql_mand_mand_fstrobj_2(b)(c)(t)(c)(B(i))(x)
 =>
  eql_mand_mand_fstrobj_1(b)(c)(t)(c)(B(i));

  GBReadFreshVar(x) &
  eql_mand_mand_fstrobj_2(b)(c)(t)(c)((GLOBAL ? END)(i))(x)
 =>
  eql_mand_mand_fstrobj_1(b)(c)(t)(c)((GLOBAL ? END)(i));

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%_%(",i,c) &
  eql_mand_mand_fstrobj_1(b)(c)(t)(c)(B(i))
 =>
  eql_mand_mand_fstrobj_0(b)(c)(t)(c)(B(i));

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%_%",i,c) &
  eql_mand_mand_fstrobj_1((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i))
 =>
  eql_mand_mand_fstrobj_0((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i));


/***
  copy_mand_mand
***/

  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n",y,B,F,i,i) &
  _bprintf("      %_OVR_FFNC_OBJ(%,%_idx,%_len,%)\n    END",b,S,c,c,y)
 =>
  copy_mand_mand_fstrobj_3(b)(c)(t)(c)(B(i))(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n",y,B,F,i,i) &
  _bprintf("      %_OVR_FFNC(%_idx,%_len,%)\n    END",a,c,c,y)
 =>
  copy_mand_mand_fstrobj_3(GLOBAL ? END)(c)(t)(c)(B(i))(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC(%_idx,%_len);\n",y,a,i,i) &
  _bprintf("      %_OVR_FFNC_OBJ(%,%_idx,%_len,%)\n    END",b,S,c,c,y)
 =>
  copy_mand_mand_fstrobj_3(b)(c)(t)(c)((GLOBAL ? END)(i))(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %<--%_XTR_FFNC(%_idx,%_len);\n",y,a,i,i) &
  _bprintf("      %_OVR_FFNC(%_idx,%_len,%)\n    END",a,c,c,y)
 =>
  copy_mand_mand_fstrobj_3((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i))(F)(S);

  ReadSystemName(a) &
  GBReadTok(S) &
  GBPrintFreshVar(Addr) &
  _bprintf(" IN\n") &
  copy_mand_mand_fstrobj_3(b)(c)(t)(c)(B(i))(F)(S)
 =>
  copy_mand_mand_fstrobj_2(b)(c)(t)(c)(B(i))(F);

  GBReadTok(F) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  copy_mand_mand_fstrobj_2(b)(c)(t)(c)(B(i))(F)
 =>
  copy_mand_mand_fstrobj_1(b)(c)(t)(c)(B(i));

  GBReadTok(F) &
  _bprintf(") =\n    VAR ") &
  copy_mand_mand_fstrobj_2(GLOBAL ? END)(c)(t)(c)(B(i))(F)
 =>
  copy_mand_mand_fstrobj_1(GLOBAL ? END)(c)(t)(c)(B(i));

  GBReadTok(F) &
  _bprintf(" =\n    VAR ") &
  copy_mand_mand_fstrobj_2(GLOBAL ? END)(c)(t)(c)((GLOBAL ? END)(i))(F)
 =>
  copy_mand_mand_fstrobj_1(GLOBAL ? END)(c)(t)(c)((GLOBAL ? END)(i));

  GBOpSC &
  _bprintf("  ") &
  _bprintf("copy_%_%(",i,c) &
  GBPrintFncTok(B) &
  _bprintf(",") &
  copy_mand_mand_fstrobj_1(b)(c)(t)(c)(B(i))
 =>
  copy_mand_mand_fstrobj_0(b)(c)(t)(c)(B(i));

  GBOpSC &
  _bprintf("  ") &
  _bprintf("copy_%_%(",i,c) &
  GBPrintFncTok(B) &
  copy_mand_mand_fstrobj_1(GLOBAL ? END)(c)(t)(c)(B(i))
 =>
  copy_mand_mand_fstrobj_0(GLOBAL ? END)(c)(t)(c)(B(i));

  GBOpSC &
  _bprintf("  ") &
  _bprintf("copy_%_%(",i,c) &
  copy_mand_mand_fstrobj_1(b)(c)(t)(c)((GLOBAL ? END)(i))
 =>
  copy_mand_mand_fstrobj_0(b)(c)(t)(c)((GLOBAL ? END)(i));

  GBOpSC &
  _bprintf("  ") &
  _bprintf("copy_%_%",i,c) &
  copy_mand_mand_fstrobj_1((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i))
 =>
  copy_mand_mand_fstrobj_0((GLOBAL ? END))(c)(t)(c)((GLOBAL ? END)(i));


/***
  write_fstr
***/

  GBReadTok(S) &
  _bprintf("      %<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n      PUT_STR(%); NWL(1)\n    END",S,b,F,c,c,S)
 =>
  write_fstr_fstrobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_XTR_FFNC(%_idx,%_len);\n      PUT_STR(%); NWL(1)\n    END",S,a,c,c,S)
 =>
  write_fstr_fstrobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFStrTok(a) &
  _bprintf(" IN\n") &
  write_fstr_fstrobj_4(b)(c)(t)(F)
 =>
  write_fstr_fstrobj_3(b)(c)(t);

  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  write_fstr_fstrobj_3(b)(c)(t)
 =>
  write_fstr_fstrobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  write_fstr_fstrobj_3(GLOBAL ? END)(c)(t)
 =>
  write_fstr_fstrobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("write_fstr_%",c) &
  write_fstr_fstrobj_2(b)(c)(t)
 =>
  write_fstr_fstrobj_1(b)(c)(t);

  write_fstr_fstrobj_1(b)(c)(t)
 =>
  write_fstr_fstrobj_0(b)(c)(t);

/***
  read_fstr
***/

  GBReadTok(S) &
  _bprintf("      %<--GET_STR;\n      %_OVR_FFNC_OBJ(%,%_idx,%_len,%)\n    END",S,b,F,c,c,S)
 =>
  read_fstr_fstrobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--GET_STR;\n      %_OVR_FFNC(%_idx,%_len,%)\n    END",S,a,c,c,S)
 =>
  read_fstr_fstrobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFStrTok(a) &
  _bprintf(" IN\n") &
  read_fstr_fstrobj_4(b)(c)(t)(F)
 =>
  read_fstr_fstrobj_3(b)(c)(t);

  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  read_fstr_fstrobj_3(b)(c)(t)
 =>
  read_fstr_fstrobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  read_fstr_fstrobj_3(GLOBAL ? END)(c)(t)
 =>
  read_fstr_fstrobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("read_fstr_%",c) &
  read_fstr_fstrobj_2(b)(c)(t)
 =>
  read_fstr_fstrobj_1(b)(c)(t);

  read_fstr_fstrobj_1(b)(c)(t)
 =>
  read_fstr_fstrobj_0(b)(c)(t);


/***
  eql
***/

  GBReadTok(S) &
  _bprintf(") =\n    %<--%_EQL_FFNC_OBJ(%,%_idx,%_len,%)",x,b,F,c,c,S)
 =>
  eql_fstrobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    %<--%_EQL_FFNC(%_idx,%_len,%)",x,a,c,c,S)
 =>
  eql_fstrobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFStrTok(a) &
  eql_fstrobj_4(b)(c)(t)(x)(F)
 =>
  eql_fstrobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  eql_fstrobj_3(b)(c)(t)(x)
 =>
  eql_fstrobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  eql_fstrobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  eql_fstrobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%(",c) &
  eql_fstrobj_2(b)(c)(t)
 =>
  eql_fstrobj_1(b)(c)(t);

  eql_fstrobj_1(b)(c)(t)
 =>
  eql_fstrobj_0(b)(c)(t);

/***
  length
***/

  brule(GBFSTRSIZEX.1,W) &
  bsearch(c(N),W,Y) &
  _bprintf(" =\n    %:=%",x,N)
 =>
  length_fstrobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(")") &
  length_fstrobj_3(b)(c)(t)(x)
 =>
  length_fstrobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  length_fstrobj_3((GLOBAL ? END))(c)(t)(x)
 =>
  length_fstrobj_2((GLOBAL ? END))(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nbr) &
  _bprintf(" <-- length_%(",c) &
  length_fstrobj_2(b)(c)(t)
 =>
  length_fstrobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nbr) &
  _bprintf(" <-- length_%",c) &
  length_fstrobj_2((GLOBAL ? END))(c)(t)
 =>
  length_fstrobj_1((GLOBAL ? END))(c)(t);

  length_fstrobj_1(b)(c)(t)
 =>
  length_fstrobj_0(b)(c)(t);

/***
  ovr
***/

  GBReadTok(S) &
  _bprintf(") =\n    %_OVR_FFNC_OBJ(%,%_idx,%_len,%)",b,F,c,c,S)
 =>
  ovr_fstrobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    %_OVR_FFNC(%_idx,%_len,%)",a,c,c,S)
 =>
  ovr_fstrobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFStrTok(a) &
  ovr_fstrobj_4(b)(c)(t)(F)
 =>
  ovr_fstrobj_3(b)(c)(t);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFStrTok(a) &
  ovr_fstrobj_4(GLOBAL ? END)(c)(t)(F)
 =>
  ovr_fstrobj_3(GLOBAL ? END)(c)(t);

  GBPrintFncTok(b) &
  _bprintf(",") &
  ovr_fstrobj_3(b)(c)(t)
 =>
  ovr_fstrobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("ovr_%(",c) &
  ovr_fstrobj_2(b)(c)(t)
 =>
  ovr_fstrobj_1(b)(c)(t);

  ovr_fstrobj_3(GLOBAL ? END)(c)(t)
 =>
  ovr_fstrobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("ovr_%(",c) &
  ovr_fstrobj_2(GLOBAL ? END)(c)(t)
 =>
  ovr_fstrobj_1(GLOBAL ? END)(c)(t);

  ovr_fstrobj_1(b)(c)(t)
 =>
  ovr_fstrobj_0(b)(c)(t);

/***
  xtr
***/

  GBReadTok(F) &
  _bprintf("%,%_idx,%_len)",F,c,c)
 =>
  xtr_fstrobj_3(b)(c)(t);

  GBReadTok(F) &
  _bprintf("%_idx,%_len)",c,c)
 =>
  xtr_fstrobj_3(GLOBAL ? END)(c)(t);

  GBReadTok(S) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_XTR_FFNC_OBJ(",S,b) &
  xtr_fstrobj_3(b)(c)(t)
 =>
  xtr_fstrobj_2(b)(c)(t);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" =\n    %<--%_XTR_FFNC(",S,a) &
  xtr_fstrobj_3(GLOBAL ? END)(c)(t)
 =>
  xtr_fstrobj_2(GLOBAL ? END)(c)(t);

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintFStrTok(a) &
  _bprintf(" <-- xtr_%",c) &
  xtr_fstrobj_2(b)(c)(t)
 =>
  xtr_fstrobj_1(b)(c)(t);

  xtr_fstrobj_1(b)(c)(t)
 =>
  xtr_fstrobj_0(b)(c)(t);



  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  eql_mand_mand_fstrobj_00(b,c,t,c,x);

  brule(GBFSTRSIZEX.1,W) &
  bsearch(c(N),W,Y) &
  bsearch(i(N),Y,Z) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredCopyOp(eql_,i,c) &
  eql_mand_mand_fstrobj_0(b)(c)(t)(c)(B(i))
 =>
  eql_mand_mand_fstrobj_00(b,c,t,c,B(i));

  eql_mand_mand_fstrobj_00(b,c,t,c,b(i))
 =>
  eql_mand_mand_fstrobj_00_0(b,c,t,c,i);

  eql_mand_fstrobj_000(b,c,t,x);           /* c/= x */

  brule(GBIOpsX.6,O) &
  brule(GBIOpsX.4,P) &
  WriteDot &
  eql_mand_mand_fstrobj_00(b,c,t,c) bsmap O &
  eql_mand_mand_fstrobj_00_0(b,c,t,c) bsmap P
 =>
  eql_mand_fstrobj_000(b,c,t,c);

  brule(GBIOpsX.4,O) &
  eql_mand_fstrobj_000(b,c,t) bsmap O
 =>
  eql_mand_fstrobj_0000(b)(c)(t);



  copy_mand_mand_fstrobj_00(b,c,t,c,x);

  brule(GBFSTRSIZEX.1,W) &
  bsearch(c(N),W,Y) &
  bsearch(i(N),Y,Z) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredCopyOp(copy_,i,c) &
  copy_mand_mand_fstrobj_0(b)(c)(t)(c)(B(i))
 =>
  copy_mand_mand_fstrobj_00(b,c,t,c,B(i));

  copy_mand_mand_fstrobj_00(b,c,t,c,b(i))
 =>
  copy_mand_mand_fstrobj_00_0(b,c,t,c,i);

  copy_mand_fstrobj_000(b,c,t,x);           /* c/= x */

  brule(GBIOpsX.6,O) &
  brule(GBIOpsX.4,P) &
  WriteDot &
  copy_mand_mand_fstrobj_00(b,c,t,c) bsmap O &
  copy_mand_mand_fstrobj_00_0(b,c,t,c) bsmap P
 =>
  copy_mand_fstrobj_000(b,c,t,c);

  brule(GBIOpsX.4,O) &
  copy_mand_fstrobj_000(b,c,t) bsmap O
 =>
  copy_mand_fstrobj_0000(b)(c)(t);




  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(xtr_,c) &
  xtr_fstrobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(length_,c) &
  length_fstrobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(ovr_,c) &
  ovr_fstrobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_fstrobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(read_fstr_,c) &
  read_fstr_fstrobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(write_fstr_,c) &
  write_fstr_fstrobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(key_search_,c) &
  key_search_fstrobj_0(b)(c)(t) &
  copy_mand_fstrobj_0000(b)(c)(t) &
  eql_mand_fstrobj_0000(b)(c)(t)
 =>
  fstrobj_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintStrObjOpsX IS

#define GBIpstropTac ((MAP;MODR;WRITE)~;GBIPrintStrObjOpsX)~

#define GBIPrintStrObjOps(a,b,c) \
	bcall(GBIpstropTac: strobj_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  key_search
***/

  ReadSystemName(a) &
  GBReadFreshVar(k) &
  _bprintf(".(%:%..card(%_fnctok) => (\n",k,l,b) &
  _bprintf("             not(%_strstruct(%_fncstruct(%_locate(%))(%_idx))=%))\n",a,b,b,k,c,S) &
  _bprintf("             )) &\n") &
  _bprintf("          (%=TRUE => %_strstruct(%_fncstruct(%_locate(%))(%_idx))=%)\n",f,a,b,b,l,c,S) &
  _bprintf("        VARIANT\n          %\n        END\n      END;\n",l) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G)
 =>
  key_search_strobj_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H);

  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %,%<--%_FIRST_FNC_OBJ;\n",l,G,b) &
  _bprintf("      IF %/=0 THEN\n",l) &
  _bprintf("        %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,G,c) &
  _bprintf("        %<--%_EQL_LIT_STR_OBJ(%,%);\n",f,a,H,S) &
  _bprintf("        WHILE %/=1 & %=FALSE DO\n",l,f) &
  _bprintf("          %,%<--%_NEXT_FNC_OBJ(%,%);\n",l,G,b,l,G) &
  _bprintf("          %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,G,c) &
  _bprintf("          %<--%_EQL_LIT_STR_OBJ(%,%)\n",f,a,H,S) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: dom(%) &\n",G,c) &
  _bprintf("          % = %_locate(%) &\n",G,b,l) &
  _bprintf("          %: 1..card(%_fnctok) &\n",l,b) &
  _bprintf("          %_idx: dom(%_fncstruct(%_locate(%))) &\n",c,b,b,l) &
  _bprintf("          (found=FALSE => !") &
  GBPrintFreshVar(ii) &
  key_search_strobj_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H)
 =>
  key_search_strobj_8(b)(c)(t)(x)(F)(S)(l)(G)(f);

  ReadSystemName(a) &
  GBReadFreshVar(f) &
  _bprintf(",") &
  GBPrintStrTok(a) &
  _bprintf(" IN\n") &
  key_search_strobj_8(b)(c)(t)(x)(F)(S)(l)(G)(f)
 =>
  key_search_strobj_7(b)(c)(t)(x)(F)(S)(l)(G);

  GBReadTok(G) &
  _bprintf(",") &
  GBPrintFreshVar(found) &
  key_search_strobj_7(b)(c)(t)(x)(F)(S)(l)(G)
 =>
  key_search_strobj_6(b)(c)(t)(x)(F)(S)(l);

  GBReadFreshVar(l) &
  _bprintf(",") &
  GBPrintFncTok(b) &
  key_search_strobj_6(b)(c)(t)(x)(F)(S)(l)
 =>
  key_search_strobj_5(b)(c)(t)(x)(F)(S);

  GBReadTok(S) &
  _bprintf(") =\n    VAR ") &
  GBPrintFreshVar(loc) &
  key_search_strobj_5(b)(c)(t)(x)(F)(S)
 =>
  key_search_strobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  key_search_strobj_4(b)(c)(t)(x)(F)
 =>
  key_search_strobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- key_search_%(",c) &
  key_search_strobj_3(b)(c)(t)(x)
 =>
  key_search_strobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  key_search_strobj_2(b)(c)(t)
 =>
  key_search_strobj_1(b)(c)(t);

  key_search_strobj_1(b)(c)(t)
 =>
  key_search_strobj_0(b)(c)(t);

  key_search_strobj_0(GLOBAL ? END)(c)(t);

/***
  write_str
***/

  ReadSystemName(a) &
  GBReadTok(T) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_XTR_STR_OBJ(%);\n",T,a,S) &
  _bprintf("      PUT_STR(%); NWL(1)\n    END",T)
 =>
  write_str_strobj_5(b)(c)(t)(F)(S);

  ReadSystemName(a) &
  GBReadTok(T) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_XTR_STR_OBJ(%);\n",T,a,S) &
  _bprintf("      PUT_STR(%); NWL(1)\n    END",T)
 =>
  write_str_strobj_5(GLOBAL ? END)(c)(t)(F)(S);

  ReadSystemName(a) &
  GBReadTok(S) &
  GBPrintStrTok(a) &
  _bprintf(" IN\n") &
  write_str_strobj_5(b)(c)(t)(F)(S)
 =>
  write_str_strobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  _bprintf(",") &
  write_str_strobj_4(b)(c)(t)(F)
 =>
  write_str_strobj_3(b)(c)(t);

  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  write_str_strobj_3(b)(c)(t)
 =>
  write_str_strobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  write_str_strobj_3(GLOBAL ? END)(c)(t)
 =>
  write_str_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("write_str_%",c) &
  write_str_strobj_2(b)(c)(t)
 =>
  write_str_strobj_1(b)(c)(t);

  write_str_strobj_1(b)(c)(t)
 =>
  write_str_strobj_0(b)(c)(t);

/***
  read_str
***/

  ReadSystemName(a) &
  GBReadTok(T) &
  _bprintf(" IN\n") &
  _bprintf("      %<--%_DEF_FNC_OBJ(%,%_idx);\n",x,b,F,c) &
  _bprintf("      IF %=TRUE THEN\n",x) &
  _bprintf("        %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("        %_KIL_STR_OBJ(%)\n      END;\n",a,S) &
  _bprintf("      %<--GET_STR;\n",T) &
  _bprintf("      %,%<--%_NEW_STR_OBJ(%);\n",x,S,a,T) &
  _bprintf("      IF %=TRUE THEN %_STO_FNC_OBJ(%,%_idx,%) END;\n",x,b,F,c,S) &
  _bprintf("      %:=%\n    END",r,x)
 =>
  read_str_strobj_6(b)(c)(t)(r)(F)(x)(S);

  ReadSystemName(a) &
  GBReadTok(S) &
  GBPrintStrTok(a) &
  read_str_strobj_6(b)(c)(t)(r)(F)(x)(S)
 =>
  read_str_strobj_5(b)(c)(t)(r)(F)(x);

  ReadSystemName(a) &
  GBReadFreshVar(x) &
  GBPrintStrTok(a) &
  _bprintf(",") &
  read_str_strobj_5(b)(c)(t)(r)(F)(x)
 =>
  read_str_strobj_4(b)(c)(t)(r)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  read_str_strobj_4(b)(c)(t)(r)(F)
 =>
  read_str_strobj_3(b)(c)(t)(r);

  GBReadFreshVar(r) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  read_str_strobj_3(b)(c)(t)(r)
 =>
  read_str_strobj_2(b)(c)(t);


  ReadSystemName(a) &
  GBReadTok(T) &
  _bprintf("      %<--GET_STR;\n",T) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_KIL_STR_OBJ(%);\n",a,S) &
  _bprintf("      %,%<--%_NEW_STR_OBJ(%);\n",x,S,a,T) &
  _bprintf("      IF %=TRUE THEN %_STO_FNC(%_idx,%) END;\n",x,a,c,S) &
  _bprintf("      %:=%\n    END",r,x)
 =>
  read_str_strobj_5(GLOBAL ? END)(c)(t)(r)(x)(S);

  ReadSystemName(a) &
  GBReadTok(S) &
  GBPrintStrTok(a) &
  _bprintf(" IN\n") &
  read_str_strobj_5(GLOBAL ? END)(c)(t)(r)(x)(S)
 =>
  read_str_strobj_4(GLOBAL ? END)(c)(t)(r)(x);

  GBReadFreshVar(x) &
  ReadSystemName(a) &
  GBPrintStrTok(a) &
  _bprintf(",") &
  read_str_strobj_4(GLOBAL ? END)(c)(t)(r)(x)
 =>
  read_str_strobj_3(GLOBAL ? END)(c)(t)(r);

  GBReadFreshVar(r) &
  ReadSystemName(a) &
  _bprintf(" =\n    VAR ") &
  GBPrintFreshVar(bb) &
  _bprintf(",") &
  read_str_strobj_3(GLOBAL ? END)(c)(t)(r)
 =>
  read_str_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- read_str_%",c) &
  read_str_strobj_2(b)(c)(t)
 =>
  read_str_strobj_1(b)(c)(t);

  read_str_strobj_1(b)(c)(t)
 =>
  read_str_strobj_0(b)(c)(t);

/***
  eql
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,S,b,F,c) &
  _bprintf("      %<--%_EQL_LIT_STR_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  eql_strobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",S,S,a,c) &
  _bprintf("      %<--%_EQL_LIT_STR_OBJ(%_0,%)\n    END",x,a,S,S)
 =>
  eql_strobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  eql_strobj_4(b)(c)(t)(x)(F)
 =>
  eql_strobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  eql_strobj_3(b)(c)(t)(x)
 =>
  eql_strobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  eql_strobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  eql_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%(",c) &
  eql_strobj_2(b)(c)(t)
 =>
  eql_strobj_1(b)(c)(t);

  eql_strobj_1(b)(c)(t)
 =>
  eql_strobj_0(b)(c)(t);

/***
  conc
***/

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %,%_1<--%_NEW_STR_OBJ(%);\n",y,S,a,S) &
  _bprintf("      IF %=TRUE THEN\n",y) &
  _bprintf("        %<--%_APP_STR_OBJ(%_0,%_1);\n",y,a,S,S) &
  _bprintf("        %_KIL_STR_OBJ(%_1)\n      END;\n",a,S) &
  _bprintf("      %:=%\n    END",x,y)
 =>
  conc_strobj_5(b)(c)(t)(x)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %_0<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %,%_1<--%_NEW_STR_OBJ(%);\n",y,S,a,S) &
  _bprintf("      IF %=TRUE THEN\n",y) &
  _bprintf("        %<--%_APP_STR_OBJ(%_0,%_1);\n",y,a,S,S) &
  _bprintf("        %_KIL_STR_OBJ(%_1)\n      END;\n",a,S) &
  _bprintf("      %:=%\n    END",x,y)
 =>
  conc_strobj_5(GLOBAL ? END)(c)(t)(x)(F)(S);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0,%_1,",S,S) &
  GBPrintFreshVar(bb) &
  _bprintf(" IN\n") &
  conc_strobj_5(b)(c)(t)(x)(F)(S)
 =>
  conc_strobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  conc_strobj_4(b)(c)(t)(x)(F)
 =>
  conc_strobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  conc_strobj_3(b)(c)(t)(x)
 =>
  conc_strobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  conc_strobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  conc_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- conc_%(",c) &
  conc_strobj_2(b)(c)(t)
 =>
  conc_strobj_1(b)(c)(t);

  conc_strobj_1(b)(c)(t)
 =>
  conc_strobj_0(b)(c)(t);

/***
  valIth
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_VAL_STR_OBJ(%,%)\n    END",x,a,S,y)
 =>
  valIth_strobj_5(b)(c)(t)(x)(F)(y);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_VAL_STR_OBJ(%,%)\n    END",x,a,S,y)
 =>
  valIth_strobj_5(GLOBAL ? END)(c)(t)(x)(F)(y);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  GBPrintStrTok(a) &
  valIth_strobj_5(b)(c)(t)(x)(F)(y)
 =>
  valIth_strobj_4(b)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFreshVar(ii) &
  _bprintf(") =\n    VAR ") &
  valIth_strobj_4(b)(c)(t)(x)(F)
 =>
  valIth_strobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  valIth_strobj_3(b)(c)(t)(x)
 =>
  valIth_strobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  valIth_strobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  valIth_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(Char) &
  _bprintf(" <-- valIth_%(",c) &
  valIth_strobj_2(b)(c)(strobj(t))
 =>
  valIth_strobj_1(b)(c)(strobj(t));

  valIth_strobj_1(b)(c)(t)
 =>
  valIth_strobj_0(b)(c)(t);

/***
  clear
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_CLR_STR_OBJ(%)\n    END",a,S)
 =>
  clear_strobj_4(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_CLR_STR_OBJ(%)\n    END",a,S)
 =>
  clear_strobj_4(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  _bprintf("% IN\n") &
  clear_strobj_4(b)(c)(t)(F)
 =>
  clear_strobj_3(b)(c)(t);

  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  clear_strobj_3(b)(c)(t)
 =>
  clear_strobj_2(b)(c)(t);

  _bprintf(" =\n    VAR ") &
  clear_strobj_3(GLOBAL ? END)(c)(t)
 =>
  clear_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("clear_%",c) &
  clear_strobj_2(b)(c)(t)
 =>
  clear_strobj_1(b)(c)(t);

  clear_strobj_1(b)(c)(t)
 =>
  clear_strobj_0(b)(c)(t);

/***
  length
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_LEN_STR_OBJ(%)\n    END",x,a,S)
 =>
  length_strobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_LEN_STR_OBJ(%)\n    END",x,a,S)
 =>
  length_strobj_4(GLOBAL ? END)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  _bprintf("% IN\n") &
  length_strobj_4(b)(c)(t)(x)(F)
 =>
  length_strobj_3(b)(c)(t)(x);

  GBReadFreshVar(x) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  length_strobj_3(b)(c)(t)(x)
 =>
  length_strobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" =\n    VAR ") &
  length_strobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  length_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nbr) &
  _bprintf(" <-- length_%",c) &
  length_strobj_2(b)(c)(t)
 =>
  length_strobj_1(b)(c)(t);

  length_strobj_1(b)(c)(t)
 =>
  length_strobj_0(b)(c)(t);

/***
  mod
***/

/*
  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %_KIL_STR_OBJ(%_0);\n",a,S) &
  _bprintf("      %,%_0<--%_NEW_STR_OBJ(%);\n",y,S,a,S) &
  _bprintf("      IF %=TRUE THEN %_STO_FNC_OBJ(%,%_idx,%_0) END;\n",y,b,F,c,S) &
  _bprintf("      %:=%\n    END",x,y)
 =>
  mod_strobj_5(b)(c)(t)(x)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %_0<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %_KIL_STR_OBJ(%_0);\n",a,S) &
  _bprintf("      %,%_0<--%_NEW_STR_OBJ(%);\n",y,S,a,S) &
  _bprintf("      IF %=TRUE THEN %_STO_FNC(%_idx,%_0) END;\n",y,a,c,S) &
  _bprintf("      %:=%\n    END",x,y)
 =>
  mod_strobj_5(GLOBAL ? END)(c)(t)(x)(F)(S);
*/

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_EQL_LIT_STR_OBJ(%_0,%);\n",y,a,S,S) &
  _bprintf("      IF % = FALSE THEN\n",y) &
  _bprintf("        %,%_1<--%_NEW_STR_OBJ(%);\n",y,S,a,S) &
  _bprintf("        IF %=TRUE THEN\n",y) &
  _bprintf("          %_KIL_STR_OBJ(%_0);\n",a,S) &
  _bprintf("          %_STO_FNC_OBJ(%,%_idx,%_1)\n",b,F,c,S) &
  _bprintf("        END;\n") &
  _bprintf("        %:=%\n",x,y) &
  _bprintf("      ELSE\n") &
  _bprintf("        %:=TRUE\n",x) &
  _bprintf("      END\n    END")
 =>
  mod_strobj_5(b)(c)(t)(x)(F)(S);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  _bprintf("      %_0<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_EQL_LIT_STR_OBJ(%_0,%);\n",y,a,S,S) &
  _bprintf("      IF % = FALSE THEN\n",y) &
  _bprintf("        %,%_1<--%_NEW_STR_OBJ(%);\n",y,S,a,S) &
  _bprintf("        IF %=TRUE THEN\n",y) &
  _bprintf("          %_KIL_STR_OBJ(%_0);\n",a,S) &
  _bprintf("          %_STO_FNC(%_idx,%_1)\n",a,c,S) &
  _bprintf("        END;\n") &
  _bprintf("        %:=%\n",x,y) &
  _bprintf("      ELSE\n") &
  _bprintf("        %:=TRUE\n",x) &
  _bprintf("      END\n    END")
 =>
  mod_strobj_5(GLOBAL ? END)(c)(t)(x)(F)(S);




  GBReadTok(S) &
  _bprintf(") =\n    VAR %_0,%_1,",S,S) &
  GBPrintFreshVar(bb) &
  _bprintf(" IN\n") &
  mod_strobj_5(b)(c)(t)(x)(F)(S)
 =>
  mod_strobj_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  mod_strobj_4(b)(c)(t)(x)(F)
 =>
  mod_strobj_3(b)(c)(t)(x);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  mod_strobj_4(GLOBAL ? END)(c)(t)(x)(F)
 =>
  mod_strobj_3(GLOBAL ? END)(c)(t)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  mod_strobj_3(b)(c)(t)(x)
 =>
  mod_strobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- mod_%(",c) &
  mod_strobj_2(b)(c)(t)
 =>
  mod_strobj_1(b)(c)(t);

  GBReadFreshVar(x) &
  mod_strobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  mod_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- mod_%(",c) &
  mod_strobj_2(GLOBAL ? END)(c)(t)
 =>
  mod_strobj_1(GLOBAL ? END)(c)(t);

  mod_strobj_1(b)(c)(t)
 =>
  mod_strobj_0(b)(c)(t);

/***
  push
***/

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC_OBJ(%,%_idx);\n",S,b,F,c) &
  _bprintf("      %<--%_PSH_STR_OBJ(%,%)\n    END",x,a,S,y)
 =>
  push_strobj_5(b)(c)(t)(x)(F)(y);

  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n      %<--%_VAL_FNC(%_idx);\n",S,a,c) &
  _bprintf("      %<--%_PSH_STR_OBJ(%,%)\n    END",x,a,S,y)
 =>
  push_strobj_5(GLOBAL ? END)(c)(t)(x)(F)(y);

  ReadSystemName(a) &
  GBReadFreshVar(y) &
  GBPrintStrTok(a) &
  push_strobj_5(b)(c)(t)(x)(F)(y)
 =>
  push_strobj_4(b)(c)(t)(x)(F);

  GBReadFreshVar(F) &
  GBPrintFreshVar(Char) &
  _bprintf(") =\n    VAR ") &
  push_strobj_4(b)(c)(strobj(t))(x)(F)
 =>
  push_strobj_3(b)(c)(strobj(t))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  push_strobj_3(b)(c)(t)(x)
 =>
  push_strobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  push_strobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  push_strobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- push_%(",c) &
  push_strobj_2(b)(c)(t)
 =>
  push_strobj_1(b)(c)(t);

  push_strobj_1(b)(c)(t)
 =>
  push_strobj_0(b)(c)(t);

/***
  xtr
***/

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",G,b,F,c) &
  _bprintf("      %<--%_XTR_STR_OBJ(%)\n    END",S,a,G)
 =>
  xtr_strobj_4(b)(c)(t)(S)(F);

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("      %<--%_VAL_FNC(%_idx);\n",G,a,c) &
  _bprintf("      %<--%_XTR_STR_OBJ(%)\n    END",S,a,G)
 =>
  xtr_strobj_4(GLOBAL ? END)(c)(t)(S)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintStrTok(a) &
  _bprintf(" IN\n") &
  xtr_strobj_4(b)(c)(t)(S)(F)
 =>
  xtr_strobj_3(b)(c)(t)(S);

  GBReadTok(S) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    VAR ") &
  xtr_strobj_3(b)(c)(t)(S)
 =>
  xtr_strobj_2(b)(c)(t);

  GBReadTok(S) &
  _bprintf(" =\n    VAR ") &
  xtr_strobj_3(GLOBAL ? END)(c)(t)(S)
 =>
  xtr_strobj_2(GLOBAL ? END)(c)(t);

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintStrTok(a) &
  _bprintf(" <-- xtr_%",c) &
  xtr_strobj_2(b)(c)(t)
 =>
  xtr_strobj_1(b)(c)(t);

  xtr_strobj_1(b)(c)(t)
 =>
  xtr_strobj_0(b)(c)(t);



  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(xtr_,c) &
  xtr_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(length_,c) &
  length_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(clear_,c) &
  clear_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(valIth_,c) &
  valIth_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(push_,c) &
  push_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(mod_,c) &
  mod_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(conc_,c) &
  conc_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(read_str_,c) &
  read_str_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(write_str_,c) &
  write_str_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(key_search_,c) &
  key_search_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables
 =>
  strobj_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintOptStrObjOpsX IS

#define GBIpostropTac ((MAP;MODR;WRITE)~;GBIPrintOptStrObjOpsX)~

#define GBIPrintOptStrObjOps(a,b,c) \
	bcall(GBIpostropTac: opt_strobj_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  rem
***/
  
  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf("      %<--%_VAL_FNC_OBJ(%,%_idx);\n",G,b,F,c) &
  _bprintf("      %_KIL_STR_OBJ(%);\n",a,G) &
  _bprintf("      %_RMV_FNC_OBJ(%,%_idx)\n    END",b,F,c)
 =>
  rem_strobj_3(b)(c)(t)(F);

  GBReadTok(F) &
  GBPrintStrTok(b) &
  _bprintf(" IN\n") &
  rem_strobj_3(b)(c)(t)(F)
 =>
  rem_strobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  rem_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") = \n    VAR ") &
  rem_strobj_2(b)(c)(t)
 =>
  rem_strobj_1(b)(c)(t);

  rem_strobj_1(b)(c)(t)
 =>
  rem_strobj_0(b)(c)(t);

/***
  def
***/
  
  bcall(GBIposetopTac: def_setobj_0(b)(c)(t))
 =>
  def_strobj_0(b)(c)(t);

/***
  cre
***/
  
  bcall(GBIposetopTac: cre_setobj_0(b)(c)(t))
 =>
  cre_strobj_0(b)(c)(t);



  GBIsNotRequiredOp
 =>
  f(b)(c)(t);


  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(cre_,c) &
  cre_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(rem_,c) &
  rem_strobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(def_,c) &
  def_strobj_0(b)(c)(t)
 =>
  opt_strobj_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintFncObjOpsX IS

#define GBIpfncopTac ((MAP;MODR;WRITE)~;GBIPrintFncObjOpsX)~

#define GBIPrintFncObjOps(a,b,c) \
	bcall(GBIpfncopTac: fncobj_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  key_search
***/

  ReadSystemName(a) &
  GBReadFreshVar(k) &
  _bprintf(".(%:%..card(%_fnctok) => (\n",k,l,b) &
  _bprintf("             not(%_fncstruct(%_locate(%))(%_idx)=%))\n",b,b,k,c,S) &
  _bprintf("             )) &\n") &
  _bprintf("          (%=TRUE => %_fncstruct(%_locate(%))(%_idx)=%)\n",f,b,b,l,c,S) &
  _bprintf("        VARIANT\n          %\n        END\n      END;\n",l) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G)
 =>
  key_search_fncobj_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H);

  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %,%<--%_FIRST_FNC_OBJ;\n",l,G,b) &
  _bprintf("      IF %/=0 THEN\n",l) &
  _bprintf("        %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,G,c) &
  _bprintf("        IF %=% THEN %:=TRUE END;\n",H,S,f) &
  _bprintf("        WHILE %/=1 & %=FALSE DO\n",l,f) &
  _bprintf("          %,%<--%_NEXT_FNC_OBJ(%,%);\n",l,G,b,l,G) &
  _bprintf("          %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,G,c) &
  _bprintf("          IF %=% THEN %:=TRUE END\n",H,S,f) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: dom(%) &\n",G,c) &
  _bprintf("          % = %_locate(%) &\n",G,b,l) &
  _bprintf("          %: 1..card(%_fnctok) &\n",l,b) &
  _bprintf("          %_idx: dom(%_fncstruct(%_locate(%))) &\n",c,b,b,l) &
  _bprintf("          (found=FALSE => !") &
  GBPrintFreshVar(ii) &
  key_search_fncobj_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H)
 =>
  key_search_fncobj_8(b)(c)(t)(x)(F)(S)(l)(G)(f);

  ReadSystemName(a) &
  GBReadFreshVar(f) &
  _bprintf(",") &
  GBPrintFncTok(t) &
  _bprintf(" IN\n") &
  key_search_fncobj_8(b)(c)(fncobj(t))(x)(F)(S)(l)(G)(f)
 =>
  key_search_fncobj_7(b)(c)(fncobj(t))(x)(F)(S)(l)(G);

  GBReadTok(G) &
  _bprintf(",") &
  GBPrintFreshVar(found) &
  key_search_fncobj_7(b)(c)(t)(x)(F)(S)(l)(G)
 =>
  key_search_fncobj_6(b)(c)(t)(x)(F)(S)(l);

  GBReadFreshVar(l) &
  _bprintf(",") &
  GBPrintFncTok(b) &
  key_search_fncobj_6(b)(c)(t)(x)(F)(S)(l)
 =>
  key_search_fncobj_5(b)(c)(t)(x)(F)(S);

  GBReadTok(S) &
  _bprintf(") =\n    VAR ") &
  GBPrintFreshVar(loc) &
  key_search_fncobj_5(b)(c)(t)(x)(F)(S)
 =>
  key_search_fncobj_4(b)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFncTok(t) &
  key_search_fncobj_4(b)(c)(fncobj(t))(x)(F)
 =>
  key_search_fncobj_3(b)(c)(fncobj(t))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- key_search_%(",c) &
  key_search_fncobj_3(b)(c)(t)(x)
 =>
  key_search_fncobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  key_search_fncobj_2(b)(c)(t)
 =>
  key_search_fncobj_1(b)(c)(t);

  key_search_fncobj_1(b)(c)(t)
 =>
  key_search_fncobj_0(b)(c)(t);

  key_search_fncobj_0(GLOBAL ? END)(c)(t);


/***
  val
***/

  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  val_fncobj_3(b)(c)(t);

  GBReadTok(F) &
  _bprintf("%_idx)",c)
 =>
  val_fncobj_3(GLOBAL ? END)(c)(t);

  GBReadTok(G) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_VAL_FNC_OBJ(",G,b) &
  val_fncobj_3(b)(c)(t)
 =>
  val_fncobj_2(b)(c)(t);

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf(" =\n    %<--%_VAL_FNC(",G,a) &
  val_fncobj_3(GLOBAL ? END)(c)(t)
 =>
  val_fncobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFncTok(t) &
  _bprintf(" <-- val_%",c) &
  val_fncobj_2(b)(c)(fncobj(t))
 =>
  val_fncobj_1(b)(c)(fncobj(t));

  val_fncobj_1(b)(c)(t)
 =>
  val_fncobj_0(b)(c)(t);

/***
  mod
***/

  GBReadTok(G) &
  _bprintf(") =\n    %_STO_FNC_OBJ(%,%_idx,%)",b,F,c,G)
 =>
  mod_fncobj_3(b)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf(") =\n    %_STO_FNC(%_idx,%)",a,c,G)
 =>
  mod_fncobj_3(GLOBAL ? END)(c)(t)(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFncTok(t) &
  mod_fncobj_3(b)(c)(fncobj(t))(F)
 =>
  mod_fncobj_2(b)(c)(fncobj(t));

  GBOpSC &
  _bprintf("  mod_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  mod_fncobj_2(b)(c)(t)
 =>
  mod_fncobj_1(b)(c)(t);

  GBOpSC &
  _bprintf("  mod_%(",c) &
  mod_fncobj_2(GLOBAL ? END)(c)(t)
 =>
  mod_fncobj_1(GLOBAL ? END)(c)(t);

  mod_fncobj_1(b)(c)(t)
 =>
  mod_fncobj_0(b)(c)(t);

/***
  eql
***/

  GBReadTok(G) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",G,G,b,F,c) &
  _bprintf("      IF %_0=% THEN %:=TRUE\n      ELSE %:=FALSE\n      END\n    END",G,G,x,x)
 =>
  eql_fncobj_4(b)(c)(fncobj(t))(x)(F);

  ReadSystemName(a) &
  GBReadTok(G) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC(%_idx);\n",G,G,a,c) &
  _bprintf("      IF %_0=% THEN %:=TRUE\n      ELSE %:=FALSE\n      END\n    END",G,G,x,x)
 =>
  eql_fncobj_4(GLOBAL ? END)(c)(fncobj(t))(x)(F);

  GBReadTok(F) &
  GBPrintFncTok(t) &
  eql_fncobj_4(b)(c)(fncobj(t))(x)(F)
 =>
  eql_fncobj_3(b)(c)(fncobj(t))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  eql_fncobj_3(b)(c)(t)(x)
 =>
  eql_fncobj_2(b)(c)(t);

  GBReadFreshVar(x) &
  eql_fncobj_3(GLOBAL ? END)(c)(t)(x)
 =>
  eql_fncobj_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%(",c) &
  eql_fncobj_2(b)(c)(t)
 =>
  eql_fncobj_1(b)(c)(t);

  eql_fncobj_1(b)(c)(t)
 =>
  eql_fncobj_0(b)(c)(t);



  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(val_,c) &
  val_fncobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(mod_,c) &
  mod_fncobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_fncobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(key_search_,c) &
  key_search_fncobj_0(b)(c)(t)
 =>
  fncobj_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintOptFncObjOpsX IS

#define GBIpofncopTac ((MAP;MODR;WRITE)~;GBIPrintOptFncObjOpsX)~

#define GBIPrintOptFncObjOps(a,b,c) \
	bcall(GBIpofncopTac: opt_fncobj_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  rem
***/
  
  GBReadTok(F) &
  _bprintf("    %_RMV_FNC_OBJ(%,%_idx)",b,F,c)
 =>
  rem_fncobj_2(b)(c)(fncobj(t));

  GBOpSC &
  _bprintf("  rem_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") =\n") &
  rem_fncobj_2(b)(c)(t)
 =>
  rem_fncobj_1(b)(c)(t);

  rem_fncobj_1(b)(c)(t)
 =>
  rem_fncobj_0(b)(c)(t);

/***
  def
***/
  
  bcall(GBIposetopTac: def_setobj_0(b)(c)(t))
 =>
  def_fncobj_0(b)(c)(t);

/***
  cre
***/
  
  GBReadTok(G) &
  _bprintf(") = \n    %_STO_FNC_OBJ(%,%_idx,%)",b,F,c,G)
 =>
  cre_fncobj_4(b)(c)(fncobj(t))(F);

  GBReadTok(F) &
  _bprintf(",") &
  GBPrintFncTok(t) &
  cre_fncobj_4(b)(c)(fncobj(t))(F)
 =>
  cre_fncobj_3(b)(c)(fncobj(t));

  _bprintf("cre_%(",c) &
  GBPrintFncTok(b) &
  cre_fncobj_3(b)(c)(t)
 =>
  cre_fncobj_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  cre_fncobj_2(b)(c)(t)
 => 
  cre_fncobj_1(b)(c)(t);

  cre_fncobj_1(b)(c)(t)
 =>
  cre_fncobj_0(b)(c)(t);




  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(cre_,c) &
  cre_fncobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(rem_,c) &
  rem_fncobj_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp( def_,c) &
  def_fncobj_0(b)(c)(t)
 =>
  opt_fncobj_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintSetOpsX IS

#define GBIpsetopsTac ((MAP;MODR;WRITE)~;GBIPrintSetOpsX)~

#define GBIPrintSetOps(a,b,c) \
	bcall(GBIpsetopsTac: set_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  key_search
***/

  ReadSystemName(a) &
  GBReadFreshVar(k) &
  _bprintf(".(%:%..card(%_fnctok) => (\n",k,l,b) &
  _bprintf("             not(%_fncstruct(%_locate(%))(%_idx)=%))\n",b,b,k,c,S) &
  _bprintf("             )) &\n") &
  _bprintf("          (%=TRUE => %_fncstruct(%_locate(%))(%_idx)=%)\n",f,b,b,l,c,S) &
  _bprintf("        VARIANT\n          %\n        END\n      END;\n",l) &
  _bprintf("      %:=%;\n      %:=%\n    END",x,f,F,G)
 =>
  key_search_set_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H);

  ReadSystemName(a) &
  GBReadFreshVar(H) &
  _bprintf("      %:=FALSE;\n",f) &
  _bprintf("      %,%<--%_FIRST_FNC_OBJ;\n",l,G,b) &
  _bprintf("      IF %/=0 THEN\n",l) &
  _bprintf("        %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,G,c) &
  _bprintf("        IF %=% THEN %:=TRUE END;\n",H,S,f) &
  _bprintf("        WHILE %/=1 & %=FALSE DO\n",l,f) &
  _bprintf("          %,%<--%_NEXT_FNC_OBJ(%,%);\n",l,G,b,l,G) &
  _bprintf("          %<--%_VAL_FNC_OBJ(%,%_idx);\n",H,b,G,c) &
  _bprintf("          IF %=% THEN %:=TRUE END\n",H,S,f) &
  _bprintf("        INVARIANT\n") &
  _bprintf("          %: dom(%) &\n",G,c) &
  _bprintf("          % = %_locate(%) &\n",G,b,l) &
  _bprintf("          %: 1..card(%_fnctok) &\n",l,b) &
  _bprintf("          %_idx: dom(%_fncstruct(%_locate(%))) &\n",c,b,b,l) &
  _bprintf("          (found=FALSE => !") &
  GBPrintFreshVar(ii) &
  key_search_set_9(b)(c)(t)(x)(F)(S)(l)(G)(f)(H)
 =>
  key_search_set_8(b)(c)(t)(x)(F)(S)(l)(G)(f);

  ReadSystemName(a) &
  GBReadFreshVar(f) &
  _bprintf(",") &
  GBPrintFreshVar(nat) &
  _bprintf(" IN\n") &
  key_search_set_8(b)(c)(nat(t))(x)(F)(S)(l)(G)(f)
 =>
  key_search_set_7(b)(c)(nat(t))(x)(F)(S)(l)(G);

  ReadSystemName(a) &
  GBReadFreshVar(f) &
  _bprintf(",") &
  GBPrintMbr(t) &
  _bprintf(" IN\n") &
  key_search_set_8(b)(c)(set(t))(x)(F)(S)(l)(G)(f)
 =>
  key_search_set_7(b)(c)(set(t))(x)(F)(S)(l)(G);

  GBReadTok(G) &
  _bprintf(",") &
  GBPrintFreshVar(found) &
  key_search_set_7(b)(c)(t)(x)(F)(S)(l)(G)
 =>
  key_search_set_6(b)(c)(t)(x)(F)(S)(l);

  GBReadFreshVar(l) &
  _bprintf(",") &
  GBPrintFncTok(b) &
  key_search_set_6(b)(c)(t)(x)(F)(S)(l)
 =>
  key_search_set_5(b)(c)(t)(x)(F)(S);

  GBReadFreshVar(S) &
  _bprintf(") =\n    VAR ") &
  GBPrintFreshVar(loc) &
  key_search_set_5(b)(c)(t)(x)(F)(S)
 =>
  key_search_set_4(b)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  key_search_set_4(b)(c)(nat(t))(x)(F)
 =>
  key_search_set_3(b)(c)(nat(t))(x);

  GBReadTok(F) &
  GBPrintMbr(t) &
  key_search_set_4(b)(c)(set(t))(x)(F)
 =>
  key_search_set_3(b)(c)(set(t))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- key_search_%(",c) &
  key_search_set_3(b)(c)(t)(x)
 =>
  key_search_set_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  key_search_set_2(b)(c)(t)
 =>
  key_search_set_1(b)(c)(t);

  key_search_set_1(b)(c)(t)
 =>
  key_search_set_0(b)(c)(t);

  key_search_set_0(GLOBAL ? END)(c)(t);

/***
  eql
***/

  ReadSystemName(a) &
  GBReadFreshVar(M) &
  _bprintf(") =\n    VAR %_0 IN\n      %_0<--%_VAL_FNC_OBJ(%,%_idx);\n",M,M,b,F,c) &
  _bprintf("      IF %_0=% THEN %:=TRUE\n      ELSE %:=FALSE\n      END\n    END",M,M,x,x)
 =>
  eql_set_4(b)(c)(t)(x)(F);

  ReadSystemName(a) &
  GBReadFreshVar(M) &
  _bprintf(") =\n    %<--%_EQL_FNC(%_idx,%)",x,a,c,M)
 =>
  eql_set_4(GLOBAL ? END)(c)(t)(x)(F);

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  eql_set_4(b)(c)(nat(t))(x)(F)
 =>
  eql_set_3(b)(c)(nat(t))(x);

  GBReadTok(F) &
  GBPrintMbr(t) &
  eql_set_4(b)(c)(set(t))(x)(F)
 =>
  eql_set_3(b)(c)(set(t))(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  eql_set_3(b)(c)(t)(x)
 =>
  eql_set_2(b)(c)(t);

  GBReadFreshVar(x) &
  eql_set_3(GLOBAL ? END)(c)(t)(x)
 =>
  eql_set_2(GLOBAL ? END)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(" <-- eql_%(",c) &
  eql_set_2(b)(c)(t)
 =>
  eql_set_1(b)(c)(t);

  eql_set_1(b)(c)(t)
 =>
  eql_set_0(b)(c)(t);

/***
  mod
***/

  GBReadTok(M) &
  _bprintf("%,%_idx,%)",F,c,M)
 =>
  mod_set_3(b)(c)(t)(F);

  GBReadTok(M) &
  _bprintf("%_idx,%)",c,M)
 =>
  mod_set_3(GLOBAL ? END)(c)(t)(F);

  GBReadFreshVar(M) &
  _bprintf("%,%_idx,%)",F,c,M)
 =>
  mod_set_3(b)(c)(nat(t))(F);

  GBReadFreshVar(M) &
  _bprintf("%_idx,%)",c,M)
 =>
  mod_set_3(GLOBAL ? END)(c)(nat(t))(F);

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n    %_STO_FNC_OBJ(",b) &
  mod_set_3(b)(c)(set(t))(F)
 =>
  mod_set_2(b)(c)(set(t));

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintMbr(t) &
  _bprintf(") =\n    %_STO_FNC(",a) &
  mod_set_3(GLOBAL ? END)(c)(set(t))(F)
 =>
  mod_set_2(GLOBAL ? END)(c)(set(t));

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    %_STO_FNC_OBJ(",b) &
  mod_set_3(b)(c)(nat(t))(F)
 =>
  mod_set_2(b)(c)(nat(t));

  ReadSystemName(a) &
  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  _bprintf(") =\n    %_STO_FNC(",a) &
  mod_set_3(GLOBAL ? END)(c)(nat(t))(F)
 =>
  mod_set_2(GLOBAL ? END)(c)(nat(t));

  GBOpSC &
  _bprintf("  ") &
  _bprintf("mod_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  mod_set_2(b)(c)(t)
 =>
  mod_set_1(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("mod_%(",c) &
  mod_set_2(GLOBAL ? END)(c)(t)
 =>
  mod_set_1(GLOBAL ? END)(c)(t);

  mod_set_1(b)(c)(t)
 =>
  mod_set_0(b)(c)(t);

/***
  val
***/

  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  val_set_3(b)(c)(t);

  GBReadTok(F) &
  _bprintf("%_idx)",c)
 =>
  val_set_3(GLOBAL ? END)(c)(t);

  GBReadTok(M) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_VAL_FNC_OBJ(",M,b) &
  val_set_3(b)(c)(t)
 =>
  val_set_2(b)(c)(t);

  ReadSystemName(a) &
  GBReadTok(M) &
  _bprintf(" =\n    %<--%_VAL_FNC(",M,a) &
  val_set_3(GLOBAL ? END)(c)(t)
 =>
  val_set_2(GLOBAL ? END)(c)(t);

  GBReadFreshVar(M) &
  _bprintf("(") &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_VAL_FNC_OBJ(",M,b) &
  val_set_3(b)(c)(nat(t))
 =>
  val_set_2(b)(c)(nat(t));

  ReadSystemName(a) &
  GBReadFreshVar(M) &
  _bprintf(" =\n    %<--%_VAL_FNC(",M,a) &
  val_set_3(GLOBAL ? END)(c)(nat(t))
 =>
  val_set_2(GLOBAL ? END)(c)(nat(t));

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintMbr(t) &
  _bprintf(" <-- val_%",c) &
  val_set_2(b)(c)(set(t))
 =>
  val_set_1(b)(c)(set(t));

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(nat) &
  _bprintf(" <-- val_%",c) &
  val_set_2(b)(c)(nat(t))
 =>
  val_set_1(b)(c)(nat(t));

  val_set_1(b)(c)(t)
 =>
  val_set_0(b)(c)(t);


  GBIsNotRequiredOp
 =>
  f(b)(c)(t);


  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(val_,c) &
  val_set_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(mod_,c) &
  mod_set_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_set_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(key_search_,c) &
  key_search_set_0(b)(c)(t)
 =>
  set_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintOptSetOpsX IS

#define GBIposetopsTac ((MAP;MODR;WRITE)~;GBIPrintOptSetOpsX)~

#define GBIPrintOptSetOps(a,b,c) \
	bcall(GBIposetopsTac: opt_set_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  cre
***/
  
  GBReadTok(M) &
  _bprintf(") =\n    %_STO_FNC_OBJ(%,%_idx,%)",b,F,c,M)
 =>
  cre_set_3(b)(c)(t)(F);

  GBReadFreshVar(M) &
  _bprintf(") =\n    %_STO_FNC_OBJ(%,%_idx,%)",b,F,c,M)
 =>
  cre_set_3(b)(c)(nat(t))(F);

  GBReadTok(F) &
  GBPrintMbr(t) &
  cre_set_3(b)(c)(set(t))(F)
 =>
  cre_set_2(b)(c)(set(t));

  GBReadTok(F) &
  GBPrintFreshVar(nat) &
  cre_set_3(b)(c)(nat(t))(F)
 =>
  cre_set_2(b)(c)(nat(t));

  GBOpSC &
  _bprintf("  cre_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(",") &
  cre_set_2(b)(c)(t)
 =>
  cre_set_1(b)(c)(t);

  cre_set_1(b)(c)(t)
 =>
  cre_set_0(b)(c)(t);

/***
  def
***/
  
  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  def_set_3(b)(c)(t);

  GBReadFreshVar(x) &
  _bprintf(" <-- def_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") = \n    %<--%_DEF_FNC_OBJ(",x,b) &   
  def_set_3(b)(c)(t)
 => 
  def_set_2(b)(c)(t);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  def_set_2(b)(c)(t)
 => 
  def_set_1(b)(c)(t);

  def_set_1(b)(c)(t)
 =>
  def_set_0(b)(c)(t);

/***
  rem
***/
  
  GBReadTok(F) &
  _bprintf("%,%_idx)",F,c)
 =>
  rem_set_2(b)(c)(t);

  GBOpSC &
  _bprintf("  rem_%(",c) &
  GBPrintFncTok(b) &
  _bprintf(") = \n    %_RMV_FNC_OBJ(",b) &   
  rem_set_2(b)(c)(t)
 => 
  rem_set_1(b)(c)(t);

  rem_set_1(b)(c)(t)
 =>
  rem_set_0(b)(c)(t);




  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(cre_,c) &
  cre_set_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(rem_,c) &
  rem_set_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(def_,c) &
  def_set_0(b)(c)(t)
 =>
  opt_set_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintNatOpsX IS

#define GBIpnatopTac ((MAP;MODR;WRITE)~;GBIPrintNatOpsX)~

#define GBIPrintNatOps(a,b,c) \
	bcall(GBIpnatopTac: nat_ops_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  key_search
***/

  bcall(GBIpsetopsTac: key_search_set_0(b)(c)(t))
 =>
  key_search_nat_0(b)(c)(t);

/***
  eql
***/

  bcall(GBIpsetopsTac: eql_set_0(b)(c)(t))
 =>
  eql_nat_0(b)(c)(t);

/***
  mod
***/

  bcall(GBIpsetopsTac: mod_set_0(b)(c)(t))
 =>
  mod_nat_0(b)(c)(t);

/***
  val
***/

  bcall(GBIpsetopsTac: val_set_0(b)(c)(t))
 =>
  val_nat_0(b)(c)(t);


  GBIsNotRequiredOp
 =>
  f(b)(c)(t);



  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(val_,c) &
  val_nat_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(mod_,c) &
  mod_nat_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(eql_,c) &
  eql_nat_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(key_search_,c) &
  key_search_nat_0(b)(c)(t)
 =>
  nat_ops_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintOptNatOpsX IS

#define GBIponatopTac ((MAP;MODR;WRITE)~;GBIPrintOptNatOpsX)~

#define GBIPrintOptNatOps(a,b,c) \
	bcall(GBIponatopTac: opt_nat_0(a)(b)(c))

  bprintf(a)
 =>
  _bprintf(a);

/***
  def
***/
  
  bcall(GBIposetopsTac: def_set_0(b)(c)(t))
 =>
  def_nat_0(b)(c)(t);

/***
  rem
***/
  
  bcall(GBIposetopsTac: rem_set_0(b)(c)(t))
 =>
  rem_nat_0(b)(c)(t);

/***
  cre
***/
  
  bcall(GBIposetopsTac: cre_set_0(b)(c)(t))
 =>
  cre_nat_0(b)(c)(t);



  GBIsNotRequiredOp
 =>
  f(b)(c)(t);




  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(cre_,c) &
  cre_nat_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(rem_,c) &
  rem_nat_0(b)(c)(t) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(def_,c) &
  def_nat_0(b)(c)(t)
 =>
  opt_nat_0(b)(c)(t);

  NAT==SCALAR

END

&

THEORY GBIPrintBaseOpsX IS

#define GBIpbopTac ((MAP;MODR;CATL;WRITE)~;GBIPrintBaseOpsX)~

#define GBIpbopARITac ((MAP;MODR;CATL;ARI~;WRITE)~;GBIPrintBaseOpsX)~

#define GBIPrintBaseOps(a,b,c)  bcall(GBIpbopTac: base_ops_0(a)(b)(c))

  ?;?;?;?;?;?;?;?;?;

  bprintf(a)
 =>
  _bprintf(a);

/***
  printID_
***/

  bprintf("        ")
 =>
  printID_type_ID_sp(0)(v:b);

  bprintf("          ")
 =>
  printID_type_ID_sp(1)(v:b);




  bprintf(";\n") &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  oo%<--%_VAL_FNC_OBJ(oo%,%_idx)",N+1,w,N,i)
 =>
  printID_type_check_ID_non_bottom(M)(w)(i)(N);

  printID_type_ID_sp(M)(v:b) &
  bprintf("  oo%<--%_VAL_FNC_OBJ(elem,%_idx)",1,w,i)
 =>
  printID_type_check_ID_non_bottom(M)(w)(i)(0);



  ReadSystemName(a) &
  ReadIDs(K) &       /* bottom ID found */
  bsearch(b(i),K,L) &
  bprintf(";\n") &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  oo%<--%_VAL_FNC_OBJ(oo%,%_idx);\n",N+1,b,N,i) &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  ss<--%_XTR_STR_OBJ(oo%); PUT_STR(ss); PUT_EOT",a,N+1)
 =>
  printID_type_check_ID(M)(v:b)(N);

  ReadSystemName(a) &                           /* rule added Sept 15 2000 */
  ReadIDs(K) &       /* bottom ID found */
  bsearch(b(i),K,L) &
  brule(GBConstantsTypeStoX.J,b(T)) &
  bsearch((i|nat(S)),T,U) &
  bprintf(";\n") &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  oo%<--%_VAL_FNC_OBJ(oo%,%_idx);\n",N+1,b,N,i) &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  PUT_NAT(oo%)",N+1)
 =>
  printID_type_check_ID(M)(v:b)(N);


  ReadSystemName(a) &
  ReadIDs(K) &       /* bottom ID found */
  bsearch(b(i),K,L) &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  oo1<--%_VAL_FNC_OBJ(elem,%_idx);\n",b,i) &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  ss<--%_XTR_STR_OBJ(oo1); PUT_STR(ss); PUT_EOT",a)
 =>
  printID_type_check_ID(M)(v:b)(0);

  ReadSystemName(a) &                           /* rule added Sept 15 2000 */
  ReadIDs(K) &       /* bottom ID found */
  bsearch(b(i),K,L) &
  brule(GBConstantsTypeStoX.J,b(T)) &
  bsearch((i|nat(S)),T,U) &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  oo1<--%_VAL_FNC_OBJ(elem,%_idx);\n",b,i) &
  printID_type_ID_sp(M)(v:b) &
  bprintf("  PUT_NAT(oo1)")
 =>
  printID_type_check_ID(M)(v:b)(0);


  ReadBaseIDs(K) &
  bsearch(b(i),K,L) &
  ReadFieldDotBaseNames(W) &
  bsearch((i:w),W,Y) &
  brule(GBConstantsTypeStoX.P,w(E)) &
  bsearch((i|f(B)),E,F) &
  printID_type_check_ID_non_bottom(M)(w)(i)(N) &
  printID_type_check_ID(M)(i:B)(N+1)
 =>
  printID_type_check_ID(M)(v:b)(N);



  printID_count_depth_ID_1(N-1) &
  bprintf(",oo%",N)
 =>
  printID_count_depth_ID_1(N);

  bprintf("oo%",1)
 =>
  printID_count_depth_ID_1(1);


  brule(GBIPrintBaseOpsX.9,B) &
  Writef(("\n\n    Operation printID_BaseObj_%:\n",B)) &
  Writef(("\n      Can't find bottom level ID field\n      from % object ",bsrv b berv)) &
  SetGenBaseError
 =>
  printID_count_depth_ID(M)(v:b)(N);

  ReadIDs(K) &       /* bottom ID found */
  bsearch(b(i),K,L) &
  printID_count_depth_ID_1(N)
 =>
  printID_count_depth_ID(M)(v:b)(N);


  ReadBaseIDs(K) &    /* base ID found */
  bsearch(b(i),K,L) &
  ReadFieldDotBaseNames(W) &
  bsearch((i:w),W,Y) &
  brule(GBConstantsTypeStoX.P,w(E)) &
  bsearch((i|f(B)),E,F) &
  printID_count_depth_ID(M)(i:B)(N+1)
 =>
  printID_count_depth_ID(M)(v:b)(N);



  ReadSystemName(a) &
  bprintf("; %_PUT_ACT_TOK(%,%)",a,b,v)
 =>
  printID_type(M)(v:b);  /* must be a set */

  ReadBaseNames(B) &
  bsearch(b,(B,?),C) &
  ReadSystemName(a) &
  bprintf(";\n") &
  printID_type_ID_sp(M)(v:b) &
  bprintf("VAR ") &
  bcall(GBIpbopARITac : printID_count_depth_ID(M)(v:b)(1)) &
  bprintf(",ss IN\n") &
  bcall(GBIpbopARITac : printID_type_check_ID(M)(v:b)(0)) &
  bprintf("\n") &
  printID_type_ID_sp(M)(v:b) &
  bprintf("END")
 =>
  printID_type(M)(v:b);

  bprintf("; PUT_CHR(%)",v)
 =>
  printID_type(M)(v:CHAR);

  bprintf("; PUT_BTS(%)",v)
 =>
  printID_type(M)(v:BITS);

  bprintf("; PUT_BOOL(%)",v)
 =>
  printID_type(M)(v:BOOL);

  bprintf("; PUT_NAT(%)",v)
 =>
  printID_type(M)(v:SCALAR);

  ReadSystemName(a) &
  bprintf(";\n          VAR ss IN ss<--%_XTR_STR_OBJ(%); PUT_STR(ss); PUT_EOT END",a,v)
 =>
  printID_type(1)(v:STRING);

  ReadSystemName(a) &
  bprintf(";\n        VAR ss IN ss<--%_XTR_STR_OBJ(%); PUT_STR(ss); PUT_EOT END",a,v)
 =>
  printID_type(0)(v:STRING);



  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR bb,seqobj,elem,len,ith IN\n") &
  bprintf("        bb<--%_DEF_FNC_OBJ(%,%_idx)",b,F,n) &
  bprintf(";\n        IF bb=TRUE THEN\n") &
  _bprintf("          BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"[ \");\n",bcatl("",n," "),M+2) &
  bprintf("          seqobj<--%_VAL_FNC_OBJ(%,%_idx); len<--%_LEN_SEQ_OBJ(seqobj); ith:=1;\n",b,F,n,a) &
  bprintf("          WHILE ith<=len DO\n") &
  bprintf("            elem<--%_VAL_SEQ_OBJ(seqobj,ith)",a) &
  printID_type(0)(elem:t) &
  bprintf("; BLK(1); ith:=ith+1\n") &
  bprintf("          VARIANT len-ith\n") &
  bprintf("          INVARIANT true\n") &
  bprintf("          END;\n") &
  bprintf("          PUT_STR(\"]\"); NWL(1)\n") &
  bprintf("        END\n") &
  bprintf("      END")
 =>
  printID_opt_seq(b)(n:t)(F)(s);

  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR bb,setobj,elem,crd,ord IN\n") &
  bprintf("        bb<--%_DEF_FNC_OBJ(%,%_idx)",b,F,n) &
  bprintf(";\n        IF bb=TRUE THEN\n") &
  _bprintf("          BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"{ \");\n",bcatl("",n," "),M+2) &
  bprintf("          setobj<--%_VAL_FNC_OBJ(%,%_idx); crd<--%_CRD_SET_OBJ(setobj); ord:=1;\n",b,F,n,a) &
  bprintf("          WHILE ord<=crd DO\n") &
  bprintf("            elem<--%_VAL_SET_OBJ(setobj,ord)",a) &
  printID_type(0)(elem:t) &
  bprintf("; BLK(1); ord:=ord+1\n",a) &
  bprintf("          VARIANT crd-ord\n") &
  bprintf("          INVARIANT true\n") &
  bprintf("          END;\n") &
  bprintf("          PUT_STR(\"}\"); NWL(1)\n") &
  bprintf("        END\n") &
  bprintf("      END")
 =>
  printID_opt_set(b)(n:t)(F)(s);

  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR bb, elem IN\n") &
  bprintf("        bb<--%_DEF_FNC_OBJ(%,%_idx);\n",b,F,n) &
  bprintf("        IF bb=TRUE THEN\n") &
  bprintf("          elem<--%_VAL_FNC_OBJ(%,%_idx)",b,F,n) &
  _bprintf(";\n          BLK(2); PUT_STR_PAD(%,%)",bcatl("",n," "),M+2) &
  printID_type(1)(elem:t) &
  bprintf("; NWL(1)\n        END") &
  bprintf("\n      END")
 =>
  printID_opt_elem(b)(n:t)(F)(s);


  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|seqobj(t)),T,U) &
  printID_opt_seq(b)(n:t)(F)("")
 =>
  printID_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|setobj(t)),T,U) &
  printID_opt_set(b)(n:t)(F)("")
 =>
  printID_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fncobj(t)),T,U) &
  printID_opt_elem(b)(n:t)(F)("")            /* treat fncobj as elem */
 =>
  printID_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|strobj(t)),T,U) &
  printID_opt_elem(b)(n:STRING)(F)("")       /* treat strobj as elem */
 =>
  printID_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|nat(t)),T,U) &
  printID_opt_elem(b)(n:NAT)(F)("")          /* treat nat as elem */
 =>
  printID_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|set(t)),T,U) &
  printID_opt_elem(b)(n:t)(F)("")            /* treat set as elem */
 =>
  printID_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fstrobj(t)),T,U) &
  printID_opt_fstrobj(b)(n:t)(F)("")
 =>
  printID_opt(b)(n)(F);

  printID_opt(b)(?)(F);

  printID_opt(b)(A)(F) &
  printID_opt(b)(a)(F)
 =>
  printID_opt(b)(A;a)(F);



  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR ss IN\n") &
  bprintf("        ss<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n",b,F,n,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(ss); PUT_EOT; NWL(1)\n",bcatl("",n," "),M+2) &
  bprintf("      END")
 =>
  printID_mand_fstrobj(b)(n:t)(F)(s);

  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR seqobj,elem,len,ith IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"[ \");\n",bcatl("",n," "),M+2) &
  bprintf("        seqobj<--%_VAL_FNC_OBJ(%,%_idx); len<--%_LEN_SEQ_OBJ(seqobj); ith:=1;\n",b,F,n,a) &
  bprintf("        WHILE ith<=len DO\n") &
  bprintf("          elem<--%_VAL_SEQ_OBJ(seqobj,ith)",a) &
  printID_type(0)(elem:t) &
  bprintf("; BLK(1); ith:=ith+1\n") &
  bprintf("        VARIANT len-ith\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"]\"); NWL(1)\n") &
  bprintf("      END")
 =>
  printID_mand_seq(b)(n:t)(F)(s);

  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR setobj,elem,crd,ord IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"{ \");\n",bcatl("",n," "),M+2) &
  bprintf("        setobj<--%_VAL_FNC_OBJ(%,%_idx); crd<--%_CRD_SET_OBJ(setobj); ord:=1;\n",b,F,n,a) &
  bprintf("        WHILE ord<=crd DO\n") &
  bprintf("          elem<--%_VAL_SET_OBJ(setobj,ord)",a) &
  printID_type(0)(elem:t) &
  bprintf("; BLK(1); ord:=ord+1\n",a) &
  bprintf("        VARIANT crd-ord\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"}\"); NWL(1)\n") &
  bprintf("      END")
 =>
  printID_mand_set(b)(n:t)(F)(s);

  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR elem IN\n") &
  bprintf("        elem<--%_VAL_FNC_OBJ(%,%_idx);\n",b,F,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%)",bcatl("",n," "),M+2) &
  printID_type(0)(elem:t) &
  bprintf("; NWL(1)\n      END")
 =>
  printID_mand_elem(b)(n:t)(F)(s);


  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|seqobj(t)),T,U) &
  printID_mand_seq(b)(n:t)(F)("")
 =>
  printID_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|setobj(t)),T,U) &
  printID_mand_set(b)(n:t)(F)("")
 =>
  printID_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fncobj(t)),T,U) &
  printID_mand_elem(b)(n:t)(F)("")                 /* treat fncobj as selem */
 =>
  printID_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|strobj(t)),T,U) &
  printID_mand_elem(b)(n:STRING)(F)("")            /* treat strobj as elem */
 =>
  printID_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|nat(t)),T,U) &
  printID_mand_elem(b)(n:NAT)(F)("")               /* treat nat as elem */
 =>
  printID_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|set(t)),T,U) &
  printID_mand_elem(b)(n:t)(F)("")                 /* treat set as elem*/
 =>
  printID_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fstrobj(t)),T,U) &
  printID_mand_fstrobj(b)(n:t)(F)("")
 =>
  printID_mand(b)(n)(F);


  printID_mand(b)(?)(F);

  printID_mand(b)(A)(F) &
  printID_mand(b)(a)(F)
 =>
  printID_mand(b)(A;a)(F);


  ReadSystemName(a) &
  _bprintf("      PUT_STR(\"\\n-------- BASE % OBJECT \"); %_PUT_TOK(%);\n      PUT_STR(\" --------\\n\");",b,a,F) &
  _bprintf(" PUT_STR(\"MANDATORY\\n\")") &
  printID_mand(b)(A)(F) &
  _bprintf(";\n      PUT_STR(\"OPTIONAL\\n\")") &
  printID_opt(b)(B)(F) &
  _bprintf(";\n      PUT_STR(%)\n",dashes_string)
 =>
  printID_3(b)(A)(B)(F);

  ReadSystemName(a) &
  _bprintf("      PUT_STR(\"\\n-------- BASE % OBJECT \"); %_PUT_TOK(%);\n      PUT_STR(\" --------\\n\");",b,a,F) &
  _bprintf(" PUT_STR(\"OPTIONAL\\n\")") &
  printID_opt(b)(B)(F) &
  _bprintf(";\n      PUT_STR(%)\n",dashes_string)
 =>
  printID_3(b)(?)(B)(F);

  ReadSystemName(a) &
  _bprintf("      PUT_STR(\"\\n-------- BASE % OBJECT \"); %_PUT_TOK(%);\n      PUT_STR(\" --------\\n\");",b,a,F) &
  _bprintf(" PUT_STR(\"MANDATORY\\n\")") &
  printID_mand(b)(A)(F) &
  _bprintf(";\n      PUT_STR(%)\n",dashes_string)
 =>
  printID_3(b)(A)(?)(F);

  GBReadTok(F) &
  _bprintf("    BEGIN\n") &
  printID_3(b)(A)(B)(F) &
  _bprintf("\n    END")
 =>
  printID_2(b)(A)(B);

  GBPrintFncTok(b) &
  _bprintf(") =\n") &
  printID_2(b)(A)(B)
 =>
  printID_1(b)(A)(B);

  GBOpSC &
  bmodr(GBIPrintBaseOpsX.9,b) &
  _bprintf("  ") &
  _bprintf("printID_BaseObj_%(",b) &
  printID_1(b)(A)(B)
 =>
  printID_0(b)(A)(B);




  ReadSystemName(a) &
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|nat(t)),T,U) &
  ReadSystemName(a) &
  setPrintGlobalNatFlag &
  _bprintf(";\n      PrintGlobalNat(%_VAL_FNC,%_idx,%)",a,n,bcatl("",n," "))
 =>
  printID_1(GLOBAL ? END)(n);
 
  ReadSystemName(a) &
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|fstrobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR fstrobj,ss IN\n") &
  bprintf("        fstrobj<--%_VAL_FNC(%_idx); ss<--%_XTR_FFNC(fstrobj,%_len);\n",a,n,a,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(ss); PUT_EOT; NWL(1)\n",bcatl("",n," "),M+2) &
  bprintf("      END")
 =>
  printID_1(GLOBAL ? END)(n);
 
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|strobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR strobj,ss IN\n") &
  bprintf("        strobj<--%_VAL_FNC(%_idx);\n",a,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); ss<--%_XTR_STR_OBJ(strobj); PUT_STR(ss); PUT_EOT; NWL(1)\n",bcatl("",n," "),M+2,a) &
  bprintf("    END")
 =>
  printID_1(GLOBAL ? END)(n);
 
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|seqobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR seqobj,elem,len,ith IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"[ \");\n",bcatl("",n," "),M+2) &
  bprintf("        seqobj<--%_VAL_FNC(%_idx); len<--%_LEN_SEQ_OBJ(seqobj); ith:=1;\n",a,n,a) &
  bprintf("        WHILE ith<=len DO\n") &
  bprintf("          elem<--%_VAL_SEQ_OBJ(seqobj,ith)",a) &
  printID_type(0)(elem:t) &
  bprintf("; NWL(1); BLK(1); ith:=ith+1\n") &
  bprintf("        VARIANT len-ith\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"]\"); NWL(1)\n") &
  bprintf("      END")
 =>
  printID_1(GLOBAL ? END)(n);
 
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|setobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR setobj,elem,crd,ord IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"{ \");\n",bcatl("",n," "),M+2) &
  bprintf("        setobj<--%_VAL_FNC(%_idx); crd<--%_CRD_SET_OBJ(setobj); ord:=1;\n",a,n,a) &
  bprintf("        WHILE ord<=crd DO\n") &
  bprintf("          elem<--%_VAL_SET_OBJ(setobj,ord)",a) &
  printID_type(0)(elem:t) &
  bprintf("; NWL(1); BLK(1); ord:=ord+1\n") &
  bprintf("        VARIANT crd-ord\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"}\"); NWL(1)\n") &
  bprintf("      END")
 =>
  printID_1(GLOBAL ? END)(n);


  printID_1(GLOBAL ? END)(?);

  printID_1(GLOBAL ? END)(A) &
  printID_1(GLOBAL ? END)(a)
 =>
  printID_1(GLOBAL ? END)(A;a);

  GBOpSC &
  ReadSystemName(a) &
  _bprintf("  ") &
  _bprintf("printID_Globals_% =\n    BEGIN",a) &
  _bprintf("\n      PUT_STR(\"\\n---------------- GLOBAL ----------------\\n\")",b,a,F) &
  printID_1(GLOBAL ? END)(A) &
  _bprintf(";\n      PUT_STR(%)\n      END",dashes_string)
 =>
  printID_0(GLOBAL ? END)(A)(B);

/***
  print_
***/

  bprintf("        ")
 =>
  print_type_ID_sp(0)(v:b);

  bprintf("          ")
 =>
  print_type_ID_sp(1)(v:b);


/***
HERE(("IS NOT STRING ID":print_type_ID(M)(v:b)(i)))=>
***/
  print_type_check_ID(M)(v:b);

  ReadIDs(K) &
  bsearch(b(i),K,L) &
  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((i|strobj(s)),T,U) &
/***
HERE(("IS STRING ID":print_type_ID(M)(v:b)(i)))&
***/
  ReadSystemName(a) &
  bprintf(";\n") &
  print_type_ID_sp(M)(v:b) &
  bprintf("VAR ss,oo IN\n") &
  print_type_ID_sp(M)(v:b) &
  bprintf("  oo<--%_VAL_FNC_OBJ(elem,%_idx);\n",b,i) &
  print_type_ID_sp(M)(v:b) &
  bprintf("  ss<--%_XTR_STR_OBJ(oo);\n",a) &
  print_type_ID_sp(M)(v:b) &
  bprintf("  PUT_STR(\"(\"); PUT_STR(ss); PUT_STR(\")\"); PUT_EOT\n") &
  print_type_ID_sp(M)(v:b) &
  bprintf("END")
 =>
  print_type_check_ID(M)(v:b);



  ReadSystemName(a) &
  bprintf("; %_PUT_ACT_TOK(%,%)",a,b,v)
 =>
  print_type(M)(v:b);  /* must be a set */

  ReadBaseNames(B) &
  bsearch(b,(B,?),C) &
  ReadSystemName(a) &
  bprintf("; PUT_STR(\"%.\"); %_PUT_TOK(%)",b,a,v) &
  print_type_check_ID(M)(v:b)
 =>
  print_type(M)(v:b);

  bprintf("; PUT_CHR(%)",v)
 =>
  print_type(M)(v:CHAR);

  bprintf("; PUT_BTS(%)",v)
 =>
  print_type(M)(v:BITS);

  bprintf("; PUT_BOOL(%)",v)
 =>
  print_type(M)(v:BOOL);

  bprintf("; PUT_NAT(%)",v)
 =>
  print_type(M)(v:SCALAR);

  ReadSystemName(a) &
  bprintf(";\n          VAR ss IN ss<--%_XTR_STR_OBJ(%); PUT_STR(ss); PUT_EOT END",a,v)
 =>
  print_type(1)(v:STRING);

  ReadSystemName(a) &
  bprintf(";\n        VAR ss IN ss<--%_XTR_STR_OBJ(%); PUT_STR(ss); PUT_EOT END",a,v)
 =>
  print_type(0)(v:STRING);



  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR bb,seqobj,elem,len,ith IN\n") &
  bprintf("        bb<--%_DEF_FNC_OBJ(%,%_idx)",b,F,n) &
  bprintf(";\n        IF bb=TRUE THEN\n") &
  _bprintf("          BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"[ \");\n",bcatl("",n," "),M+2) &
  bprintf("          seqobj<--%_VAL_FNC_OBJ(%,%_idx); len<--%_LEN_SEQ_OBJ(seqobj); ith:=1;\n",b,F,n,a) &
  bprintf("          WHILE ith<=len DO\n") &
  bprintf("            elem<--%_VAL_SEQ_OBJ(seqobj,ith)",a) &
  print_type(0)(elem:t) &
  bprintf("; BLK(1); ith:=ith+1\n") &
  bprintf("          VARIANT len-ith\n") &
  bprintf("          INVARIANT true\n") &
  bprintf("          END;\n") &
  bprintf("          PUT_STR(\"]\"); NWL(1)\n") &
  bprintf("        END\n") &
  bprintf("      END")
 =>
  print_opt_seq(b)(n:t)(F)(s);

  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR bb,setobj,elem,crd,ord IN\n") &
  bprintf("        bb<--%_DEF_FNC_OBJ(%,%_idx)",b,F,n) &
  bprintf(";\n        IF bb=TRUE THEN\n") &
  _bprintf("          BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"{ \");\n",bcatl("",n," "),M+2) &
  bprintf("          setobj<--%_VAL_FNC_OBJ(%,%_idx); crd<--%_CRD_SET_OBJ(setobj); ord:=1;\n",b,F,n,a) &
  bprintf("          WHILE ord<=crd DO\n") &
  bprintf("            elem<--%_VAL_SET_OBJ(setobj,ord)",a) &
  print_type(0)(elem:t) &
  bprintf("; BLK(1); ord:=ord+1\n",a) &
  bprintf("          VARIANT crd-ord\n") &
  bprintf("          INVARIANT true\n") &
  bprintf("          END;\n") &
  bprintf("          PUT_STR(\"}\"); NWL(1)\n") &
  bprintf("        END\n") &
  bprintf("      END")
 =>
  print_opt_set(b)(n:t)(F)(s);

  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR bb, elem IN\n") &
  bprintf("        bb<--%_DEF_FNC_OBJ(%,%_idx);\n",b,F,n) &
  bprintf("        IF bb=TRUE THEN\n") &
  bprintf("          elem<--%_VAL_FNC_OBJ(%,%_idx)",b,F,n) &
  _bprintf(";\n          BLK(2); PUT_STR_PAD(%,%)",bcatl("",n," "),M+2) &
  print_type(1)(elem:t) &
  bprintf("; NWL(1)\n        END") &
  bprintf("\n      END")
 =>
  print_opt_elem(b)(n:t)(F)(s);


  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|seqobj(t)),T,U) &
  print_opt_seq(b)(n:t)(F)("")
 =>
  print_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|setobj(t)),T,U) &
  print_opt_set(b)(n:t)(F)("")
 =>
  print_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fncobj(t)),T,U) &
  print_opt_elem(b)(n:t)(F)("")            /* treat fncobj as elem */
 =>
  print_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|strobj(t)),T,U) &
  print_opt_elem(b)(n:STRING)(F)("")       /* treat strobj as elem */
 =>
  print_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|nat(t)),T,U) &
  print_opt_elem(b)(n:NAT)(F)("")          /* treat nat as elem */
 =>
  print_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|set(t)),T,U) &
  print_opt_elem(b)(n:t)(F)("")            /* treat set as elem */
 =>
  print_opt(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fstrobj(t)),T,U) &
  print_opt_fstrobj(b)(n:t)(F)("")
 =>
  print_opt(b)(n)(F);

  print_opt(b)(?)(F);

  print_opt(b)(A)(F) &
  print_opt(b)(a)(F)
 =>
  print_opt(b)(A;a)(F);



  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR ss IN\n") &
  bprintf("        ss<--%_XTR_FFNC_OBJ(%,%_idx,%_len);\n",b,F,n,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(ss); PUT_EOT; NWL(1)\n",bcatl("",n," "),M+2) &
  bprintf("      END")
 =>
  print_mand_fstrobj(b)(n:t)(F)(s);

  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR seqobj,elem,len,ith IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"[ \");\n",bcatl("",n," "),M+2) &
  bprintf("        seqobj<--%_VAL_FNC_OBJ(%,%_idx); len<--%_LEN_SEQ_OBJ(seqobj); ith:=1;\n",b,F,n,a) &
  bprintf("        WHILE ith<=len DO\n") &
  bprintf("          elem<--%_VAL_SEQ_OBJ(seqobj,ith)",a) &
  print_type(0)(elem:t) &
  bprintf("; BLK(1); ith:=ith+1\n") &
  bprintf("        VARIANT len-ith\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"]\"); NWL(1)\n") &
  bprintf("      END")
 =>
  print_mand_seq(b)(n:t)(F)(s);

  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR setobj,elem,crd,ord IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"{ \");\n",bcatl("",n," "),M+2) &
  bprintf("        setobj<--%_VAL_FNC_OBJ(%,%_idx); crd<--%_CRD_SET_OBJ(setobj); ord:=1;\n",b,F,n,a) &
  bprintf("        WHILE ord<=crd DO\n") &
  bprintf("          elem<--%_VAL_SET_OBJ(setobj,ord)",a) &
  print_type(0)(elem:t) &
  bprintf("; BLK(1); ord:=ord+1\n",a) &
  bprintf("        VARIANT crd-ord\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"}\"); NWL(1)\n") &
  bprintf("      END")
 =>
  print_mand_set(b)(n:t)(F)(s);

  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR elem IN\n") &
  bprintf("        elem<--%_VAL_FNC_OBJ(%,%_idx);\n",b,F,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%)",bcatl("",n," "),M+2) &
  print_type(0)(elem:t) &
  bprintf("; NWL(1)\n      END")
 =>
  print_mand_elem(b)(n:t)(F)(s);


  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|seqobj(t)),T,U) &
  print_mand_seq(b)(n:t)(F)("")
 =>
  print_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|setobj(t)),T,U) &
  print_mand_set(b)(n:t)(F)("")
 =>
  print_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fncobj(t)),T,U) &
  print_mand_elem(b)(n:t)(F)("")                 /* treat fncobj as elem */
 =>
  print_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|strobj(t)),T,U) &
  print_mand_elem(b)(n:STRING)(F)("")            /* treat strobj as elem */
 =>
  print_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|nat(t)),T,U) &
  print_mand_elem(b)(n:NAT)(F)("")               /* treat nat as elem */
 =>
  print_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|set(t)),T,U) &
  print_mand_elem(b)(n:t)(F)("")                 /* treat set as elem*/
 =>
  print_mand(b)(n)(F);

  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((n|fstrobj(t)),T,U) &
  print_mand_fstrobj(b)(n:t)(F)("")
 =>
  print_mand(b)(n)(F);


  print_mand(b)(?)(F);

  print_mand(b)(A)(F) &
  print_mand(b)(a)(F)
 =>
  print_mand(b)(A;a)(F);


  ReadSystemName(a) &
  _bprintf("      PUT_STR(\"\\n-------- BASE % OBJECT \"); %_PUT_TOK(%);\n      PUT_STR(\" --------\\n\");",b,a,F) &
  _bprintf(" PUT_STR(\"MANDATORY\\n\")") &
  print_mand(b)(A)(F) &
  _bprintf(";\n      PUT_STR(\"OPTIONAL\\n\")") &
  print_opt(b)(B)(F) &
  _bprintf(";\n      PUT_STR(%)\n",dashes_string)
 =>
  print_3(b)(A)(B)(F);

  ReadSystemName(a) &
  _bprintf("      PUT_STR(\"\\n-------- BASE % OBJECT \"); %_PUT_TOK(%);\n      PUT_STR(\" --------\\n\");",b,a,F) &
  _bprintf(" PUT_STR(\"OPTIONAL\\n\")") &
  print_opt(b)(B)(F) &
  _bprintf(";\n      PUT_STR(%)\n",dashes_string)
 =>
  print_3(b)(?)(B)(F);

  ReadSystemName(a) &
  _bprintf("      PUT_STR(\"\\n-------- BASE % OBJECT \"); %_PUT_TOK(%);\n      PUT_STR(\" --------\\n\");",b,a,F) &
  _bprintf(" PUT_STR(\"MANDATORY\\n\")") &
  print_mand(b)(A)(F) &
  _bprintf(";\n      PUT_STR(%)\n",dashes_string)
 =>
  print_3(b)(A)(?)(F);

  GBReadTok(F) &
  _bprintf("    BEGIN\n") &
  print_3(b)(A)(B)(F) &
  _bprintf("\n    END")
 =>
  print_2(b)(A)(B);

  GBPrintFncTok(b) &
  _bprintf(") =\n") &
  print_2(b)(A)(B)
 =>
  print_1(b)(A)(B);

  GBOpSC &
  _bprintf("  ") &
  _bprintf("print_BaseObj_%(",b) &
  print_1(b)(A)(B)
 =>
  print_0(b)(A)(B);




  ReadSystemName(a) &
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|nat(t)),T,U) &
  ReadSystemName(a) &
  setPrintGlobalNatFlag &
  _bprintf(";\n      PrintGlobalNat(%_VAL_FNC,%_idx,%)",a,n,bcatl("",n," "))
 =>
  print_1(GLOBAL ? END)(n);
 
  ReadSystemName(a) &
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|fstrobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR fstrobj,ss IN\n") &
  bprintf("        fstrobj<--%_VAL_FNC(%_idx); ss<--%_XTR_FFNC(fstrobj,%_len);\n",a,n,a,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(ss); PUT_EOT; NWL(1)\n",bcatl("",n," "),M+2) &
  bprintf("      END")
 =>
  print_1(GLOBAL ? END)(n);
 
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|strobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR strobj,ss IN\n") &
  bprintf("        strobj<--%_VAL_FNC(%_idx);\n",a,n) &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); ss<--%_XTR_STR_OBJ(strobj); PUT_STR(ss); PUT_EOT; NWL(1)\n",bcatl("",n," "),M+2,a) &
  bprintf("    END")
 =>
  print_1(GLOBAL ? END)(n);
 
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|seqobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR seqobj,elem,len,ith IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"[ \");\n",bcatl("",n," "),M+2) &
  bprintf("        seqobj<--%_VAL_FNC(%_idx); len<--%_LEN_SEQ_OBJ(seqobj); ith:=1;\n",a,n,a) &
  bprintf("        WHILE ith<=len DO\n") &
  bprintf("          elem<--%_VAL_SEQ_OBJ(seqobj,ith)",a) &
  print_type(0)(elem:t) &
  bprintf("; NWL(1); BLK(1); ith:=ith+1\n") &
  bprintf("        VARIANT len-ith\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"]\"); NWL(1)\n") &
  bprintf("      END")
 =>
  print_1(GLOBAL ? END)(n);
 
  brule(GBConstantsTypeStoX.N,(GLOBAL ? END)(T)) &
  bsearch((n|setobj(t)),T,U) &
  ReadSystemName(a) &
  ReadMaxFieldNameLength(M) &
  bprintf(";\n      VAR setobj,elem,crd,ord IN\n") &
  _bprintf("        BLK(2); PUT_STR_PAD(%,%); PUT_STR(\"{ \");\n",bcatl("",n," "),M+2) &
  bprintf("        setobj<--%_VAL_FNC(%_idx); crd<--%_CRD_SET_OBJ(setobj); ord:=1;\n",a,n,a) &
  bprintf("        WHILE ord<=crd DO\n") &
  bprintf("          elem<--%_VAL_SET_OBJ(setobj,ord)",a) &
  print_type(0)(elem:t) &
  bprintf("; NWL(1); BLK(1); ord:=ord+1\n") &
  bprintf("        VARIANT crd-ord\n") &
  bprintf("        INVARIANT true\n") &
  bprintf("        END;\n") &
  bprintf("        PUT_STR(\"}\"); NWL(1)\n") &
  bprintf("      END")
 =>
  print_1(GLOBAL ? END)(n);


  print_1(GLOBAL ? END)(?);

  print_1(GLOBAL ? END)(A) &
  print_1(GLOBAL ? END)(a)
 =>
  print_1(GLOBAL ? END)(A;a);

  GBOpSC &
  ReadSystemName(a) &
  _bprintf("  ") &
  _bprintf("print_Globals_% =\n    BEGIN",a) &
  _bprintf("\n      PUT_STR(\"\\n---------------- GLOBAL ----------------\\n\")",b,a,F) &
  print_1(GLOBAL ? END)(A) &
  _bprintf(";\n      PUT_STR(%)\n      END",dashes_string)
 =>
  print_0(GLOBAL ? END)(A)(B);

/***
  vld
***/


  GBReadTok(y) &
  _bprintf(" <-- any_% = BEGIN %<--%_ANY_FNC_OBJ END",b,y,b)
 =>
  any_1(b);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFncTok(b) &
  any_1(b)
 =>
  any_0(b);

/***
  nbr
***/

  _bprintf("% <-- nbr_% =\n    VAR % IN\n",s,b,v) &
  _bprintf("      %,%<--%_FIRST_FNC_OBJ\n    END",s,v,b)
  =>
  nbr_5(b)(s,t,u,v);

  GBReadTok(x) &
  nbr_5(b)(X,x)
 =>
  nbr_4(b)(X);

  GBReadFreshVar(x) &
  GBGetFncTok(b) &
  nbr_4(b)(X,x)
 =>
  nbr_3(b)(X);

  GBReadFreshVar(x) &
  GBGetFreshVar(loc) &
  nbr_3(b)(X,x)
 =>
  nbr_2(b)(X);

  GBReadFreshVar(x) &
  GBGetFreshVar(count) &
  nbr_2(b)(x)
 =>
  nbr_1(b);

  GBOpSC &
  _bprintf("  ") &
  GBGetFreshVar(tot) &
  nbr_1(b)
 =>
  nbr_0(b);

/***
  vld
***/


  GBReadTok(y) &
  _bprintf("%",y)
 =>
  vld_2;

  GBReadFreshVar(x) &
  _bprintf("% <-- vld_%(",x,b) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    %<--%_XST_FNC_OBJ(",x,b) &
  vld_2 &
  _bprintf(")")
 =>
  vld_1(b);

  GBOpSC &
  _bprintf("  ") &
  GBGetFreshVar(rep) &
  vld_1(b)
 =>
  vld_0(b);

/***
  next
***/


  GBReadTok(y) &
  _bprintf("%_0,%_0) = \n    %,%<--%_NEXT_FNC_OBJ(%_0,%_0)",x,y,x,y,b,x,y)
 =>
  next_2(b)(x);

  GBReadFreshVar(x) &
  _bprintf("%,",x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- next_%(",b,x) &
  next_2(b)(x)
 =>
  next_1(b);

  GBOpSC &
  _bprintf("  ") &
  GBGetFreshVar(loc) &
  next_1(b)
 =>
  next_0(b);

/***
  first
***/

  GBReadTok(y) &
  _bprintf("%<--%_FIRST_FNC_OBJ",y,b)
 =>
  first_2(b);

  GBReadFreshVar(x) &
  _bprintf("%,",x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- first_% =\n    %,",b,x) &
  first_2(b)
 =>
  first_1(b);

  GBOpSC &
  _bprintf("  ") &
  GBGetFreshVar(loc) &
  first_1(b)
 =>
  first_0(b);

/***
  kill
***/

  _bprintf(";\n")
 =>
  RemSC;

  brule(GBIPrintBaseOpsX.2,?) &
  bmodr(GBIPrintBaseOpsX.2,1)
 =>
  RemSC;


  RemSC &
  _bprintf("      %_KIL_FNC_OBJ(",b) &
  GBEmptyAccumulatedVariables &
  GBPrintFncTok(b) &
  _bprintf(")\n    END")
 =>
  kill_1(b);


  kill_opt_1(b,c)(f(t));



  ReadSystemName(a) &
  GBReadTok(F) &
  _bprintf("%,%_idx);\n",F,c) &
  _bprintf("          %_KIL_STR_OBJ(%)\n        END\n      END",a,S)
 =>
  kill_opt_4(b,c)(strobj(t))(S)(x);

  GBReadFreshVar(x) &
  _bprintf(" IN\n        %<--%_DEF_FNC_OBJ(",x,b) &
  GBPrintFncTok(b) &
  _bprintf(",%_idx);\n",c) &
  _bprintf("        IF %=TRUE THEN\n",x) &
  _bprintf("          %<--%_VAL_FNC_OBJ(",S,b) &
  kill_opt_4(b,c)(strobj(t))(S)(x)
 =>
  kill_opt_3(b,c)(strobj(t))(S);

  GBReadTok(S) &
  GBPrintFreshVar(bb) &
  kill_opt_3(b,c)(strobj(t))(S)
 =>
  kill_opt_2(b,c)(strobj(t));

  GBEmptyAccumulatedVariables &
  RemSC &
  _bprintf("      VAR ") &
  GBPrintStrTok(b) &
  _bprintf(",") &
  kill_opt_2(b,c)(strobj(t))
 =>
  kill_opt_1(b,c)(strobj(t));



  ReadSystemName(a) &
  GBReadTok(F) &
  _bprintf("%,%_idx);\n",F,c) &
  _bprintf("          %_KIL_SET_OBJ(%)\n        END\n      END",a,S)
 =>
  kill_opt_4(b,c)(setobj(t))(S)(x);

  GBReadFreshVar(x) &
  _bprintf(" IN\n        %<--%_DEF_FNC_OBJ(",x,b) &
  GBPrintFncTok(b) &
  _bprintf(",%_idx);\n",c) &
  _bprintf("        IF %=TRUE THEN\n",x) &
  _bprintf("          %<--%_VAL_FNC_OBJ(",S,b) &
  kill_opt_4(b,c)(setobj(t))(S)(x)
 =>
  kill_opt_3(b,c)(setobj(t))(S);

  GBReadTok(S) &
  GBPrintFreshVar(bb) &
  kill_opt_3(b,c)(setobj(t))(S)
 =>
  kill_opt_2(b,c)(setobj(t));

  GBEmptyAccumulatedVariables &
  RemSC &
  _bprintf("      VAR ") &
  GBPrintSetTok(b) &
  _bprintf(",") &
  kill_opt_2(b,c)(setobj(t))
 =>
  kill_opt_1(b,c)(setobj(t));



  ReadSystemName(a) &
  GBReadTok(F) &
  _bprintf("%,%_idx);\n",F,c) &
  _bprintf("          %_KIL_SEQ_OBJ(%)\n        END\n      END",a,S)
 =>
  kill_opt_4(b,c)(seqobj(t))(S)(x);

  GBReadFreshVar(x) &
  _bprintf(" IN\n        %<--%_DEF_FNC_OBJ(",x,b) &
  GBPrintFncTok(b) &
  _bprintf(",%_idx);\n",c) &
  _bprintf("        IF %=TRUE THEN\n",x) &
  _bprintf("          %<--%_VAL_FNC_OBJ(",S,b) &
  kill_opt_4(b,c)(seqobj(t))(S)(x)
 =>
  kill_opt_3(b,c)(seqobj(t))(S);

  GBReadTok(S) &
  GBPrintFreshVar(bb) &
  kill_opt_3(b,c)(seqobj(t))(S)
 =>
  kill_opt_2(b,c)(seqobj(t));

  GBEmptyAccumulatedVariables &
  RemSC &
  _bprintf("      VAR ") &
  GBPrintSeqTok(b) &
  _bprintf(",") &
  kill_opt_2(b,c)(seqobj(t))
 =>
  kill_opt_1(b,c)(seqobj(t));



  kill_mand_1(b,c)(f(t));


 kill_mand_1(b,c)(fstrobj(t));



  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n        %<--%_VAL_FNC_OBJ(",S,b) &
  GBPrintFncTok(b) &
  _bprintf(",%_idx);\n",c) &
  _bprintf("        %_KIL_STR_OBJ(%)\n      END",a,S)
 =>
  kill_mand_2(b,c)(strobj(t));

  GBEmptyAccumulatedVariables &
  RemSC &
  _bprintf("      VAR ") &
  GBPrintStrTok(b) &
  kill_mand_2(b,c)(strobj(t))
 =>
  kill_mand_1(b,c)(strobj(t));



  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n        %<--%_VAL_FNC_OBJ(",S,b) &
  GBPrintFncTok(b) &
  _bprintf(",%_idx);\n",c) &
  _bprintf("        %_KIL_SEQ_OBJ(%)\n      END",a,S)
 =>
  kill_mand_2(b,c)(seqobj(t));

  GBEmptyAccumulatedVariables &
  RemSC &
  _bprintf("      VAR ") &
  GBPrintSeqTok(b) &
  kill_mand_2(b,c)(seqobj(t))
 =>
  kill_mand_1(b,c)(seqobj(t));



  ReadSystemName(a) &
  GBReadTok(S) &
  _bprintf(" IN\n        %<--%_VAL_FNC_OBJ(",S,b) &
  GBPrintFncTok(b) &
  _bprintf(",%_idx);\n",c) &
  _bprintf("        %_KIL_SET_OBJ(%)\n      END",a,S)
 =>
  kill_mand_2(b,c)(setobj(t));

  GBEmptyAccumulatedVariables &
  RemSC &
  _bprintf("      VAR ") &
  GBPrintSetTok(b) &
  kill_mand_2(b,c)(setobj(t))
 =>
  kill_mand_1(b,c)(setobj(t));



  brule(GBConstantsTypeStoX.I,b(M)) &
  bsearch((c|t),M,N) &
  GBGetFncTok(b) &
  kill_opt_1(b,c)(t)
 =>
  kill_opt_0(b,c);

  kill_opt_0(b,?);

  brule(GBConstantsTypeStoX.I,b(M)) &
  bsearch((c|t),M,N) &
  GBGetFncTok(b) &
  kill_mand_1(b,c)(t)
 =>
  kill_mand_0(b,c);

  kill_mand_0(b,?);

  brule(GBConstantsStoX.I,(1|b(M))) &
  brule(GBConstantsStoX.J,(0|b(O))) &
  GBOpSC &
  _bprintf("  ") &
  _bprintf("kill_%(",b) &
  GBPrintFncTok(b) &
  _bprintf(") =\n    BEGIN\n") &
  bmodr(GBIPrintBaseOpsX.2,?) &
  kill_mand_0(b) bsmap (M) &
  kill_opt_0(b) bsmap (O) &
  kill_1(b)
 =>
  kill_0(b);


/***
  make
***/


  _bprintf("        %_STO_FNC_OBJ(%,%_idx,%);\n",b,G,I,i)
 =>
  make_prt_pre((b,G,(I:i:t)),m,n);

  _bprintf("        %_STO_FNC_OBJ(%,%_idx,%)\n",b,G,I,i)
 =>
  make_prt_pre((b,G,(I:i:t)),n,n);

  GBReadRenamedStructurePRE(P) &
  _bprintf("      IF %=TRUE THEN\n",y) &
  make_prt_pre(b,G) bnmap P &
  _bprintf("      END;\n      %:=%;\n      %:=%\n    END",F,G,x,y)
 =>
  make_8(b)(C)(x)(F)(G)(y);

  GBReadRenamedStructurePRE(?) &
  _bprintf("      %:=%;\n      %:=%\n    END",F,G,x,y)
 =>
  make_8(b)(C)(x)(F)(G)(y);

  _bprintf("      %:=%;\n      %:=%\n    END",F,G,x,y)
 =>
  make_8(b)(?)(x)(F)(G)(y);




  ReadSystemName(a) &
  _bprintf("      IF %=TRUE THEN\n        %_OVR_LIT_FFNC_OBJ(%,%_idx,%_len,\"\")\n      END;\n",y,b,G,I,I)
 =>
  make_prt_sto_0(b,G,y,(I:i:FSTRING));

  ReadSystemName(a) &
  _bprintf("      IF %=TRUE THEN\n        %,%<--%_CRE_STR_OBJ;\n",y,y,i,a) &
  _bprintf("        IF %=TRUE THEN\n          %_STO_FNC_OBJ(%,%_idx,%)\n        END\n      END;\n",y,b,G,I,i)
 =>
  make_prt_sto_0(b,G,y,(I:i:STRING));

  ReadSystemName(a) &
  _bprintf("      IF %=TRUE THEN\n        %,%<--%_CRE_SET_OBJ;\n",y,y,i,a) &
  _bprintf("        IF %=TRUE THEN\n          %_STO_FNC_OBJ(%,%_idx,%)\n        END\n      END;\n",y,b,G,I,i)
 =>
  make_prt_sto_0(b,G,y,(I:i:POW(t)));

  ReadSystemName(a) &
  _bprintf("      IF %=TRUE THEN\n        %,%<--%_CRE_SEQ_OBJ;\n",y,y,i,a) &
  _bprintf("        IF %=TRUE THEN\n          %_STO_FNC_OBJ(%,%_idx,%)\n        END\n      END;\n",y,b,G,I,i)
 =>
  make_prt_sto_0(b,G,y,(I:i:SEQ(t)));

  brule(GBIPrintBaseOpsX.5,X) &
  GBReadRenamedStructureANY(A) &
  _bprintf("      %,%<--%_CRE_FNC_OBJ;\n",y,G,b) &
  make_prt_sto_0(b,G,y) bsmap A &
  make_8(b)(C)(x)(F)(G)(y)
 =>
  make_7(b)(C)(x)(F)(G)(y);

  brule(GBIPrintBaseOpsX.5,X) &
  GBReadRenamedStructureANY(?) &
  _bprintf("      %,%<--%_CRE_FNC_OBJ;\n",y,G,b) &
  make_8(b)(C)(x)(F)(G)(y)
 =>
  make_7(b)(C)(x)(F)(G)(y);

  brule(GBIPrintBaseOpsX.5,X) &
  _bprintf("      %,%<--%_CRE_FNC_OBJ;\n",y,G,b) &
  make_8(b)(?)(x)(F)(G)(y)
 =>
  make_7(b)(?)(x)(F)(G)(y);

  _bprintf(",%",i)
 =>
  make_prt_var(I:i:t);

  make_prt_var(I:i:FSTRING);

  GBReadRenamedStructureANY(A) &
  GBReadTok(G) &
  GBReadFreshVar(y) &
  make_prt_var bsmap A &
  _bprintf(" IN\n") &
  make_7(b)(C)(x)(F)(G)(y)
 =>
  make_6(b)(C)(x)(F);

  GBReadRenamedStructureANY(?) &
  GBReadTok(G) &
  GBReadFreshVar(y) &
  _bprintf(" IN\n") &
  make_7(b)(C)(x)(F)(G)(y)
 =>
  make_6(b)(C)(x)(F);

  GBReadTok(G) &
  GBReadFreshVar(y) &
  _bprintf(" IN\n") &
  make_7(b)(?)(x)(F)(G)(y)
 =>
  make_6(b)(?)(x)(F);

  GBPrintFncTok(b) &
  _bprintf(",") &
  GBPrintFreshVar(bb) &
  make_6(b)(C)(x)(F)
 =>
  make_5(b)(C)(x)(F);

  _bprintf(",")
 =>
  pc;

  brule(GBIPrintBaseOpsX.4,?) &
  bmodr(GBIPrintBaseOpsX.4,1)
 =>
  pc;

  pc &
  _bprintf("%",i)
 =>
  make_prt_param(I:i:t);

  make_prt_param(I:i:FSTRING);

  GBReadRenamedStructurePRE(P) &
  _bprintf("(") &
  make_prt_param bsmap P &
  _bprintf(") =\n    VAR ") &
  make_5(b)(C)(x)(F)
 =>
  make_4(b)(C)(x)(F);

  GBReadRenamedStructurePRE(?) &
  _bprintf(" =\n    VAR ") &
  make_5(b)(C)(x)(F)
 =>
  make_4(b)(C)(x)(F);

  _bprintf(" =\n    VAR ") &
  make_5(b)(?)(x)(F)
 =>
  make_4(b)(?)(x)(F);

  GBReadTok(F) &
  GBGetStructurePREANY(b,C) &
  make_4(b)(C)(x)(F)
 =>
  make_3(b)(C)(x);

  GBReadTok(F) &
  make_4(b)(?)(x)(F)
 =>
  make_3(b)(?)(x);

  GBReadFreshVar(x) &
  GBPrintFncTok(b) &
  _bprintf(" <-- make_%",b) &
  make_3(b)(C)(x)
 =>
  make_2(b)(C);

  GBOpSC &
  _bprintf("  ") &
  GBPrintFreshVar(rep) &
  _bprintf(",") &
  make_2(b)(C)
 =>
  make_1(b)(C);

  bmodr(GBIPrintBaseOpsX.3,?) &
  bmodr(GBIPrintBaseOpsX.4,?) &
  make_1(b)(C)
 =>
  make_0(b)(C);


/***
  stats
***/

  GBOpSC &
  _bprintf("  used_obj,max_obj <-- stats_% = ",b) &
  _bprintf("BEGIN used_obj,max_obj <-- %_STS_FNC_OBJ END",b)
 =>
  stats_0(b);



  GBIsNotRequiredOp
 =>
  f(b)(C);

  GBIsNotRequiredOp
 =>
  f(b);


  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(stats_,b) &
  stats_0(b) &
  bmodr(GBIPrintBaseOpsX.5,B) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(make_,b) &
  make_0(b)(A) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(kill_,b) &
  kill_0(b) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(printID_BaseObj_,b) &
  printID_0(b)(A)(B) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(print_BaseObj_,b) &
  print_0(b)(A)(B) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(first_,b) &
  first_0(b) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(next_,b) &
  next_0(b) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(vld_,b) &
  vld_0(b) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(nbr_,b) &
  nbr_0(b) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(any_,b) &
  any_0(b)
 =>
  base_ops_0(b)(A)(B);

  ReadSystemName(a) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(print_Globals_,a) &
  print_0(GLOBAL ? END)(A)(B)
 =>
  base_ops_0(GLOBAL ? END)(A)(B);

  NAT==SCALAR;

  GenBaseErrorFlagged
 =>
  x

END

&

THEORY GBIPrintSavRstRelOpsX IS

#define GBIpsropTac ((MAP;MODR;WRITE;FLAT)~;GBIPrintSavRstRelOpsX)~

#define GBIPrintSavRstRelOps  bcall(GBIpsropTac: sav_rst_ops_0)

  ?; /* 0=> comma,sc not printed */

  bprintf(";\n")
 =>
  chk_sc;

  brule(GBIPrintSavRstRelOpsX.1,0) &
  bmodr(GBIPrintSavRstRelOpsX.1,1)
 =>
  chk_sc;

  bprintf(",\n")
 =>
  chk_comma;

  brule(GBIPrintSavRstRelOpsX.1,0) &
  bmodr(GBIPrintSavRstRelOpsX.1,1)
 =>
  chk_comma;

  bprintf(a)
 =>
  _bprintf(a);

/***
  system_stats
***/

  system_stats_str;

  ReadSystemName(a) &
  STRINGFlagset &
  chk_sc &
  _bprintf("      used_strmem,max_strmem,used_strobj,max_strobj <-- %_STS_STR_OBJ",a)
 =>
  system_stats_str;


  system_stats_set;

  ReadSystemName(a) &
  SETFlagset &
  chk_sc &
  _bprintf("      used_setmem,max_setmem,used_setobj,max_setobj <-- %_STS_SET_OBJ",a)
 =>
  system_stats_set;


  system_stats_seq;

  ReadSystemName(a) &
  SEQFlagset &
  chk_sc &
  _bprintf("      used_seqmem,max_seqmem,used_seqobj,max_seqobj <-- %_STS_SEQ_OBJ",a)
 =>
  system_stats_seq;



  system_stats_param_str;

  STRINGFlagset &
  chk_comma &
  _bprintf("  used_strmem,\n") &
  _bprintf("  max_strmem,\n") &
  _bprintf("  used_strobj,\n") &
  _bprintf("  max_strobj")
 =>
  system_stats_param_str;


  system_stats_param_set;

  SETFlagset &
  chk_comma &
  _bprintf("  used_setmem,\n") &
  _bprintf("  max_setmem,\n") &
  _bprintf("  used_setobj,\n") &
  _bprintf("  max_setobj")
 =>
  system_stats_param_set;


  system_stats_param_seq;

  SEQFlagset &
  chk_comma &
  _bprintf("  used_seqmem,\n") &
  _bprintf("  max_seqmem,\n") &
  _bprintf("  used_seqobj,\n") &
  _bprintf("  max_seqobj")
 =>
  system_stats_param_seq;


  ReadSystemName(a) &
  GBOpSC &
  bmodr(GBIPrintSavRstRelOpsX.1,0) &
  system_stats_param_str &
  system_stats_param_seq &
  system_stats_param_set &
  _bprintf("\n    <--\n  system_stats_% =\n    BEGIN\n",a) &
  bmodr(GBIPrintSavRstRelOpsX.1,0) &
  system_stats_str &
  system_stats_seq &
  system_stats_set &
  _bprintf("\n    END")
 =>
  system_stats_0;


/***
  save
***/

  save_set;

  SETFlagset &
  ReadSystemName(a) &
  _bprintf("        %_SAV_SET_OBJ;\n",a)
 =>
  save_set;

  save_string;

  save_seq;

  SEQFlagset &
  ReadSystemName(a) &
  _bprintf("        %_SAV_SEQ_OBJ;\n",a)
 =>
  save_seq;

  STRINGFlagset &
  ReadSystemName(a) &
  _bprintf("        %_SAV_STR_OBJ;\n",a)
 =>
  save_string;

  _bprintf("        %_SAV_FNC_OBJ;\n",b)
 =>
  save_bases_1(b);

  ReadSystemName(a) &
  _bprintf("        %_SAV_FNC;\n",a)
 =>
  save_bases_1(GLOBAL ? END);

  save_bases_1(?);

  ReadBaseNames(B) &
  save_bases_1 bsmap B
 =>
  save_bases_0;

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  _bprintf("% <-- save_% =\n    VAR % IN\n      % <-- %_open_write_dump;\n      IF %=TRUE THEN\n",rep,a,bb,bb,a,bb) &
  save_bases_0 &
  save_string &
  save_seq &
  save_set &
  _bprintf("        % <-- %_close_dump\n      END;\n      %:=%\n    END",bb,a,rep,bb)
 =>
  save_0;



/***
  save_n
***/

  save_n_set;

  SETFlagset &
  ReadSystemName(a) &
  _bprintf("        %_SAVN_SET_OBJ;\n",a)
 =>
  save_n_set;

  save_n_string;

  save_n_seq;

  SEQFlagset &
  ReadSystemName(a) &
  _bprintf("        %_SAVN_SEQ_OBJ;\n",a)
 =>
  save_n_seq;

  STRINGFlagset &
  ReadSystemName(a) &
  _bprintf("        %_SAVN_STR_OBJ;\n",a)
 =>
  save_n_string;

  _bprintf("        %_SAVN_FNC_OBJ;\n",b)
 =>
  save_n_bases_1(b);

  ReadSystemName(a) &
  _bprintf("        %_SAVN_FNC;\n",a)
 =>
  save_n_bases_1(GLOBAL ? END);

  save_n_bases_1(?);

  ReadBaseNames(B) &
  save_n_bases_1 bsmap B
 =>
  save_n_bases_0;

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  _bprintf("% <-- save_n_% =\n    VAR % IN\n      % <-- %_open_write_dump_network;\n      IF %=TRUE THEN\n",rep,a,bb,bb,a,bb) &
  save_n_bases_0 &
  save_n_string &
  save_n_seq &
  save_n_set &
  _bprintf("        % <-- %_close_dump\n      END;\n      %:=%\n    END",bb,a,rep,bb)
 =>
  save_n_0;



/***
  restore
***/

  restore_seq;

  SEQFlagset &
  ReadSystemName(a) &
  _bprintf("        %_RST_SEQ_OBJ;\n",a)
 =>
  restore_seq;

  restore_set;

  SETFlagset &
  ReadSystemName(a) &
  _bprintf("        %_RST_SET_OBJ;\n",a)
 =>
  restore_set;

  restore_string;

  STRINGFlagset &
  ReadSystemName(a) &
  _bprintf("        %_RST_STR_OBJ;\n",a)
 =>
  restore_string;

  _bprintf("        %_RST_FNC_OBJ;\n",b)
 =>
  restore_bases_1(b);

  ReadSystemName(a) &
  _bprintf("        %_RST_FNC;\n",a)
 =>
  restore_bases_1(GLOBAL ? END);

  restore_bases_1(?);

  ReadBaseNames(B) &
  restore_bases_1 bsmap B
 =>
  restore_bases_0;

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  _bprintf("% <-- restore_% =\n    VAR % IN\n      % <-- %_open_read_dump;\n      IF %=TRUE THEN\n",rep,a,bb,bb,a,bb) &
  restore_bases_0 &
  restore_string &
  restore_seq &
  restore_set &
  _bprintf("        % <-- %_close_dump\n      END;\n      %:=%\n    END",bb,a,rep,bb)
 =>
  restore_0;




/***
  restore_n
***/

  restore_n_seq;

  SEQFlagset &
  ReadSystemName(a) &
  _bprintf("        %_RSTN_SEQ_OBJ;\n",a)
 =>
  restore_n_seq;

  restore_n_set;

  SETFlagset &
  ReadSystemName(a) &
  _bprintf("        %_RSTN_SET_OBJ;\n",a)
 =>
  restore_n_set;

  restore_n_string;

  STRINGFlagset &
  ReadSystemName(a) &
  _bprintf("        %_RSTN_STR_OBJ;\n",a)
 =>
  restore_n_string;

  _bprintf("        %_RSTN_FNC_OBJ;\n",b)
 =>
  restore_n_bases_1(b);

  ReadSystemName(a) &
  _bprintf("        %_RSTN_FNC;\n",a)
 =>
  restore_n_bases_1(GLOBAL ? END);

  restore_n_bases_1(?);

  ReadBaseNames(B) &
  restore_n_bases_1 bsmap B
 =>
  restore_n_bases_0;

  ReadSystemName(a) &
  GBOpSC &
  _bprintf("  ") &
  _bprintf("% <-- restore_n_% =\n    VAR % IN\n      % <-- %_open_read_dump_network;\n      IF %=TRUE THEN\n",rep,a,bb,bb,a,bb) &
  restore_n_bases_0 &
  restore_n_string &
  restore_n_seq &
  restore_n_set &
  _bprintf("        % <-- %_close_dump\n      END;\n      %:=%\n    END",bb,a,rep,bb)
 =>
  restore_n_0;




  GBIsNotRequiredOp
 =>
  f;

  ReadSystemName(a) &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(save_,a) &
  save_0 &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(restore_,a) &
  restore_0 &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(save_n_,a) &
  save_n_0 &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(restore_n_,a) &
  restore_n_0 &
  GBEmptyAccumulatedVariables &
  GBCheckRequiredOp(system_stats_,a) &
  system_stats_0
 =>
  sav_rst_ops_0;

  NAT==SCALAR

END

&

THEORY GBIOpsX IS

#define GBIpopsTac ((ARI~;MODR~;WRITE;MAP)~;GBIOpsX)~

#define GBIPrintOps  bcall(GBIpopsTac: prt_ops_0)

  ?; /* 1. curr base name */

  ?; /* 2. mand att */

  ?; /* 3. opt att */

  ?; /* 4. mand fstr att of curr base */

  ?; /* 5. opt fstr att of curr base */

  ?; /* 6. mand fstr att of others */

  ?; /* 7. opt fstr att of others */


  GBIPrintSetOps(b,c,set(t))
 =>
  prt_fld_4(b)(1)(c)(set(t));

  GBIPrintOptSetOps(b,c,set(t)) &
  GBIPrintSetOps(b,c,set(t))
 =>
  prt_fld_4(b)(0)(c)(set(t));

  GBIPrintNatOps(b,c,nat(t))
 =>
  prt_fld_4(b)(1)(c)(nat(t));

  GBIPrintOptNatOps(b,c,nat(t)) &
  GBIPrintNatOps(b,c,nat(t))
 =>
  prt_fld_4(b)(0)(c)(nat(t));

  GBIPrintSetObjOps(b,c,setobj(t))
 =>
  prt_fld_4(b)(1)(c)(setobj(t));

  GBIPrintOptSetObjOps(b,c,setobj(t)) &
  GBIPrintSetObjOps(b,c,setobj(t))
 =>
  prt_fld_4(b)(0)(c)(setobj(t));

  GBIPrintSeqObjOps(b,c,seqobj(t))
 =>
  prt_fld_4(b)(1)(c)(seqobj(t));

  GBIPrintOptSeqObjOps(b,c,seqobj(t)) &
  GBIPrintSeqObjOps(b,c,seqobj(t))
 =>
  prt_fld_4(b)(0)(c)(seqobj(t));

  GBIPrintFStrObjOps(b,c,fstrobj(t))
 =>
  prt_fld_4(b)(1)(c)(fstrobj(t));

  GBIPrintStrObjOps(b,c,strobj(t))
 =>
  prt_fld_4(b)(1)(c)(strobj(t));

  GBIPrintOptStrObjOps(b,c,strobj(t)) &
  GBIPrintStrObjOps(b,c,strobj(t))
 =>
  prt_fld_4(b)(0)(c)(strobj(t));

  GBIPrintFncObjOps(b,c,fncobj(t))
 =>
  prt_fld_4(b)(1)(c)(fncobj(t));

  GBIPrintOptFncObjOps(b,c,fncobj(t)) &
  GBIPrintFncObjOps(b,c,fncobj(t))
 =>
  prt_fld_4(b)(0)(c)(fncobj(t));

  prt_fld_3(b)(N)(?);

  brule(GBConstantsTypeStoX.J,b(T)) &
  bsearch((c|t),T,U) &
  prt_fld_4(b)(N)(c)(t)
 =>
  prt_fld_3(b)(N)(c);

  prt_fld_3(b)(N)(c)
 =>
  prt_fld_2(b)(N)(c);

  prt_fld_2(b)(N)(C) &
  prt_fld_3(b)(N)(c)
 =>
  prt_fld_2(b)(N)(C;c);

  brule(GBIOpsX.2,(S|A)) &
  prt_fld_2(b)(S)(A) &
  brule(GBIOpsX.3,(T|B)) &
  prt_fld_2(b)(T)(B)
 =>
  prt_fld_1(b);




  brule(GBIOpsX.7,X) &
  bmodr(GBIOpsX.7,(X,b(i)))
 =>
  prt_ops_oth_fstr_3(0)(b(i));

  brule(GBIOpsX.6,X) &
  bmodr(GBIOpsX.6,(X,b(i)))
 =>
  prt_ops_oth_fstr_3(1)(b(i));

  prt_ops_oth_fstr_2(b,N,i);

  brule(GBConstantsTypeStoX.I,b(X)) &
  bsearch((i|fstrobj(x)),X,Y) &
  prt_ops_oth_fstr_3(N)(b(i))
 =>
  prt_ops_oth_fstr_2(b,N,i);

  prt_ops_oth_fstr_1(?);

  brule(GBConstantsStoX.M,(1|b(A))) &
  brule(GBConstantsStoX.N,(0|b(B))) &
  prt_ops_oth_fstr_2(b,1) bsmap (A) &
  prt_ops_oth_fstr_2(b,0) bsmap (B)
 =>
  prt_ops_oth_fstr_1(b);

  ReadBaseNames(B) &
  bsearch(b,B,C) &
  prt_ops_oth_fstr_1 bsmap C
 =>
  prt_ops_oth_fstr_0(b);



  brule(GBIOpsX.5,X) &
  bmodr(GBIOpsX.5,(X,i))
 =>
  prt_ops_fstr_2(0)(i);

  brule(GBIOpsX.4,X) &
  bmodr(GBIOpsX.4,(X,i))
 =>
  prt_ops_fstr_2(1)(i);

  prt_ops_fstr_1(b,N,i);

  brule(GBConstantsTypeStoX.I,b(X)) &
  bsearch((i|fstrobj(x)),X,Y) &
  prt_ops_fstr_2(N)(i)
 =>
  prt_ops_fstr_1(b,N,i);

  brule(GBConstantsStoX.M,(1|b(A))) &
  brule(GBConstantsStoX.N,(0|b(B))) &
  prt_ops_fstr_1(b,1) bsmap (A) &
  prt_ops_fstr_1(b,0) bsmap (B)
 =>
  prt_ops_fstr_0(b);



  brule(GBIOpsX.N,(1|A)) &
  brule(GBIOpsX.M,(0|B)) &
  GBIPrintBaseOps(b,A,B) &
  prt_fld_1(b)
 =>
  prt_ops_2(b);

  prt_ops_1(M)(N);

  brule(GBConstantsStoX.M,(S|b(A))) &
  brule(GBConstantsStoX.N,(T|b(B))) &
  bmodr(GBIOpsX.1,b) &
  bmodr(GBIOpsX.2,(S|A)) &
  bmodr(GBIOpsX.3,(T|B)) &
  bmodr(GBIOpsX.4,?) &
  bmodr(GBIOpsX.5,?) &
  bmodr(GBIOpsX.6,?) &
  bmodr(GBIOpsX.7,?) &
  prt_ops_fstr_0(b) &
  prt_ops_oth_fstr_0(b) &
  WriteDot &
  prt_ops_2(b) &
  prt_ops_1(M+2)(N+2)
 =>
  prt_ops_1(M)(N);

  bprintf("\n\nOPERATIONS") &
  ResetGBOpSC &
  GBIPrintSavRstRelOps &
  prt_ops_1(1)(2)
 =>
  prt_ops_0;

  NAT==SCALAR

END

&

THEORY GBIPrintCtxImpX IS

#define pciTac ((CATL;WRITE)~;GBIPrintCtxImpX)~

#define GBIPrintCtxImp bcall(pciTac: pci_0)


  bprintf("IMPLEMENTATION   %CtxI\n\nREFINES          %Ctx\n\nEND\n",b,b)
 =>
  pci_2(b);

  InformCantConnect(f) &
  PFZ
 =>
  pci_1(f)(b);

  bconnect(f) &
  pci_2(b)
 =>
  pci_1(f)(b);

  ReadSystemName(b) &
  pci_1(bcatl("CFG/",b,"CtxI.imp"))(b)
 =>
  pci_0;

  CtxMchNotRequired
 =>
  pci_0

END

&

THEORY GBIPrintDefsX IS

#define GBIPrintDefsTac   (((ARI;WRITE;MAP;MODR)~;GBIPrintDefsX)~)

#define GBIPrintDefs  bcall(GBIPrintDefsTac : pd )

  ?;  /* for sc */

  bmodr(GBIPrintDefsX.1,1) &
  bprintf("\n\n")
 =>
  sc;

  brule(GBIPrintDefsX.1,1) &
  bprintf(";\n\n")
 =>
  sc;

/***** defs for searching  ******/

  ps_ID(b)(v)(strobj(s));

  Read_invarReqd(I) &
  bsearch(b,I,J) &
  sc &
  ReadSystemName(a) &
  bprintf("  check_%(e,n,f) ==\n",b) &
  bprintf("    VAR %_str IN\n",b) &
  bprintf("      %_str<--%_VAL_FNC_OBJ(e,%_idx);\n      f <-- %_EQL_LIT_STR_OBJ(%_str,n)\n",b,b,v,a,b) &
  bprintf("    END")
 =>
  ps_ID(b)(v)(strobj(s));


  ps_ID(b)(v)(set(s));

  Read_invarReqd(I) &
  bsearch(b,I,J) &
  sc &
  bprintf("  check_%(e,n,f) ==\n",b) &
  bprintf("    VAR %_param IN\n",b) &
  bprintf("      %_param<--%_VAL_FNC_OBJ(e,%_idx);\n      IF %_param=n THEN f:=TRUE END\n",b,b,v,b) &
  bprintf("    END")
 =>
  ps_ID(b)(v)(set(s));
 

  ps_ID(b)(v)(nat(s));

  Read_invarReqd(I) &
  bsearch(b,I,J) &
  sc &
  bprintf("  check_%(e,n,f) ==\n",b) &
  bprintf("    VAR %_nat IN\n",b) &
  bprintf("      %_nat<--%_VAL_FNC_OBJ(e,%_idx);\n      IF %_nat=n THEN f:=TRUE END\n",b,b,v,b) &
  bprintf("    END")
 =>
  ps_ID(b)(v)(nat(s));



  pi_ID(b)(v)(t);
  
  Read_invarReqd(I) &
  bsearch(b,I,J) &
  sc &
  bprintf("  invar_%(f,l,b,c) ==\n",b) &
  bprintf("    ( f = TRUE => ( b : ( l <| %)~[{c}] ))",v)
 =>
  pi_ID(b)(v)(t);
  
  brule(GBConstantsTypeStoX.N,b(T)) &
  bsearch((v|t),T,U) &
  ps_ID(b)(v)(t) &                /* t = nat(syst) , strobj(syst), set(PAR) */
  pi_ID(b)(v)(t) 
 =>
  ps1(b(v));

  ps1(?);

  ReadIDs(K) &
  ps1 bsmap (K)              /* list of basname(IDfield) */
=>
  ps1;


  pd;

  DEFSFlagset &
  bmodr(GBIPrintDefsX.1,0) &
  bprintf("\n\n\n\nDEFINITIONS") &
  ps1
 =>
  pd

END

&

THEORY GenBaseImpX IS

  WriteDot &
  clearDEFSFlag &
  GBIPrintCtxImp &
  WriteDot &
  GBIPrintHeader &
  GBIPrintFncObj &
  GBIPrintSeqObj &
  GBIPrintStrObj &
  GBIPrintSetObj &
  GBIPrintToken_io &
  WriteDot &
  GBIPrintConstants &
  WriteDot &
  GBIPrintProperties &
  WriteDot &
  GBIPrintInvariant &
  WriteDot &
  GBIPrintInitialisation &
  WriteDot &
  GBIPrintOps &
  WriteDot &
  GBIPrintDefs &
  WriteDot &
  GBIPrintFooter
 =>
  gbi_0;

  GenBaseErrorFlagged
 =>
  gbi_0

END
